diff --git a/node_modules/@editablejs/plugin-image/.DS_Store b/node_modules/@editablejs/plugin-image/.DS_Store
new file mode 100644
index 0000000..ca617e8
Binary files /dev/null and b/node_modules/@editablejs/plugin-image/.DS_Store differ
diff --git a/node_modules/@editablejs/plugin-image/dist/deserializer/html.js b/node_modules/@editablejs/plugin-image/dist/deserializer/html.js
index eadf5f4..4d21f9b 100644
--- a/node_modules/@editablejs/plugin-image/dist/deserializer/html.js
+++ b/node_modules/@editablejs/plugin-image/dist/deserializer/html.js
@@ -65,10 +65,10 @@ var withImageHTMLDeserializerTransform = (next, _, { editor }) => {
         if (!customUrl)
           return next(node, options);
       }
-      const width = node.getAttribute("width") || node.getAttribute("data-width") || window.getComputedStyle(node, "width").width;
+      const width = node.getAttribute("width") || node.getAttribute("data-width") || window.getComputedStyle(node, "width").width || node.style.width;
       let w = parseInt(width, 10);
       w = isNaN(w) ? 0 : w;
-      const height = node.getAttribute("height") || node.getAttribute("data-height") || window.getComputedStyle(node, "height").height;
+      const height = node.getAttribute("height") || node.getAttribute("data-height") || window.getComputedStyle(node, "height").height || node.style.height;
       let h = parseInt(height, 10);
       h = isNaN(h) ? 0 : h;
       return [
diff --git a/node_modules/@editablejs/plugin-image/dist/deserializer/html.js.map b/node_modules/@editablejs/plugin-image/dist/deserializer/html.js.map
index 7c17049..023d31e 100644
--- a/node_modules/@editablejs/plugin-image/dist/deserializer/html.js.map
+++ b/node_modules/@editablejs/plugin-image/dist/deserializer/html.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/deserializer/html.ts","../../src/options.ts","../../src/interfaces/image.ts","../../src/constants.ts"],"sourcesContent":["import {\n  HTMLDeserializerOptions,\n  HTMLDeserializerWithTransform,\n} from '@editablejs/deserializer/html'\nimport { Editor, isDOMHTMLElement } from '@editablejs/models'\nimport { IMAGE_KEY } from '../constants'\nimport { getOptions } from '../options'\nimport { Image } from '../interfaces/image'\nexport interface ImageHTMLDeserializerOptions extends HTMLDeserializerOptions {\n  editor: Editor\n}\n\nexport const withImageHTMLDeserializerTransform: HTMLDeserializerWithTransform<\n  ImageHTMLDeserializerOptions\n> = (next, _, { editor }) => {\n  return (node, options = {}) => {\n    const { element } = options\n    if (isDOMHTMLElement(node) && node.nodeName === 'IMG') {\n      const url = node.getAttribute('src') || node.getAttribute('data-src')\n      if (!url) return next(node, options)\n\n      const { onUploadBefore } = getOptions(editor)\n      if (onUploadBefore) {\n        const customUrl = onUploadBefore([url])[0]\n        if (!customUrl) return next(node, options)\n      }\n      const width =\n        node.getAttribute('width') ||\n        node.getAttribute('data-width') ||\n        window.getComputedStyle(node, 'width').width\n      let w = parseInt(width, 10)\n      w = isNaN(w) ? 0 : w\n\n      const height =\n        node.getAttribute('height') ||\n        node.getAttribute('data-height') ||\n        window.getComputedStyle(node, 'height').height\n\n      let h = parseInt(height, 10)\n      h = isNaN(h) ? 0 : h\n\n      return [\n        {\n          ...element,\n          ...Image.create({\n            url,\n            state: 'waitingUpload',\n            width: w,\n            height: h,\n          }),\n        },\n      ]\n    }\n    return next(node, options)\n  }\n}\n","import { Editor } from '@editablejs/models'\nimport { ImageLocale } from './locale'\n\nexport type ImageHotkey = string | ((e: KeyboardEvent) => boolean)\n\nexport interface ImageOptions {\n  hotkey?: ImageHotkey\n  shortcuts?: boolean\n  locale?: Record<string, ImageLocale>\n  onBeforeRender?: (url: string) => Promise<string>\n  onUploadBefore?: (files: (File | string)[]) => (File | string)[]\n  onUpload?: (\n    file: File | string,\n    update: (options: Record<'percentage', number>) => void,\n  ) => Promise<string>\n  onRotate?: (file: File) => Promise<string | { url: string; rotate?: number }>\n  allowRotate?: boolean\n}\nconst IMAGE_OPTIONS = new WeakMap<Editor, ImageOptions>()\n\nexport const getOptions = (editor: Editor): ImageOptions => {\n  return IMAGE_OPTIONS.get(editor) ?? {}\n}\n\nexport const setOptions = (editor: Editor, options: ImageOptions) => {\n  IMAGE_OPTIONS.set(editor, options)\n}\n","import { Element } from '@editablejs/models'\nimport { IMAGE_KEY } from '../constants'\n\nexport type ImageState = 'uploading' | 'waitingUpload' | 'done' | 'error'\n\nexport type ImageStyle = 'none' | 'stroke' | 'shadow'\n\nexport interface Image extends Element {\n  type: typeof IMAGE_KEY\n  state?: ImageState\n  width?: number\n  height?: number\n  url?: string\n  percentage?: number\n  errorMessage?: string\n  rotate?: number\n  style?: ImageStyle\n  name?: string\n}\n\nexport const Image = {\n  isImage: (value: any): value is Image => {\n    return Element.isElement(value) && value.type === IMAGE_KEY\n  },\n\n  create: (image: Omit<Image, 'type' | 'children'> = {}): Image => {\n    return {\n      ...image,\n      type: IMAGE_KEY,\n      children: [{ text: '' }],\n    }\n  },\n}\n","export const IMAGE_KEY = 'image'\nexport const DATA_IMAGE_KEY = 'data-image-key'\n"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA,IAAAA,iBAAyC;;;ACczC,IAAM,gBAAgB,oBAAI,QAA8B;AAEjD,IAAM,aAAa,CAAC,WAAiC;AAC1D,SAAO,cAAc,IAAI,MAAM,KAAK,CAAC;AACvC;;;ACtBA,oBAAwB;;;ACAjB,IAAM,YAAY;;;ADoBlB,IAAM,QAAQ;AAAA,EACnB,SAAS,CAAC,UAA+B;AACvC,WAAO,sBAAQ,UAAU,KAAK,KAAK,MAAM,SAAS;AAAA,EACpD;AAAA,EAEA,QAAQ,CAAC,QAA0C,CAAC,MAAa;AAC/D,WAAO;AAAA,MACL,GAAG;AAAA,MACH,MAAM;AAAA,MACN,UAAU,CAAC,EAAE,MAAM,GAAG,CAAC;AAAA,IACzB;AAAA,EACF;AACF;;;AFpBO,IAAM,qCAET,CAAC,MAAM,GAAG,EAAE,OAAO,MAAM;AAC3B,SAAO,CAAC,MAAM,UAAU,CAAC,MAAM;AAC7B,UAAM,EAAE,QAAQ,IAAI;AACpB,YAAI,iCAAiB,IAAI,KAAK,KAAK,aAAa,OAAO;AACrD,YAAM,MAAM,KAAK,aAAa,KAAK,KAAK,KAAK,aAAa,UAAU;AACpE,UAAI,CAAC;AAAK,eAAO,KAAK,MAAM,OAAO;AAEnC,YAAM,EAAE,eAAe,IAAI,WAAW,MAAM;AAC5C,UAAI,gBAAgB;AAClB,cAAM,YAAY,eAAe,CAAC,GAAG,CAAC,EAAE;AACxC,YAAI,CAAC;AAAW,iBAAO,KAAK,MAAM,OAAO;AAAA,MAC3C;AACA,YAAM,QACJ,KAAK,aAAa,OAAO,KACzB,KAAK,aAAa,YAAY,KAC9B,OAAO,iBAAiB,MAAM,OAAO,EAAE;AACzC,UAAI,IAAI,SAAS,OAAO,EAAE;AAC1B,UAAI,MAAM,CAAC,IAAI,IAAI;AAEnB,YAAM,SACJ,KAAK,aAAa,QAAQ,KAC1B,KAAK,aAAa,aAAa,KAC/B,OAAO,iBAAiB,MAAM,QAAQ,EAAE;AAE1C,UAAI,IAAI,SAAS,QAAQ,EAAE;AAC3B,UAAI,MAAM,CAAC,IAAI,IAAI;AAEnB,aAAO;AAAA,QACL;AAAA,UACE,GAAG;AAAA,UACH,GAAG,MAAM,OAAO;AAAA,YACd;AAAA,YACA,OAAO;AAAA,YACP,OAAO;AAAA,YACP,QAAQ;AAAA,UACV,CAAC;AAAA,QACH;AAAA,MACF;AAAA,IACF;AACA,WAAO,KAAK,MAAM,OAAO;AAAA,EAC3B;AACF;","names":["import_models"]}
\ No newline at end of file
+{"version":3,"sources":["../../src/deserializer/html.ts","../../src/options.ts","../../src/interfaces/image.ts","../../src/constants.ts"],"sourcesContent":["import {\n  HTMLDeserializerOptions,\n  HTMLDeserializerWithTransform,\n} from '@editablejs/deserializer/html'\nimport { Editor, isDOMHTMLElement } from '@editablejs/models'\nimport { IMAGE_KEY } from '../constants'\nimport { getOptions } from '../options'\nimport { Image } from '../interfaces/image'\nexport interface ImageHTMLDeserializerOptions extends HTMLDeserializerOptions {\n  editor: Editor\n}\n\nexport const withImageHTMLDeserializerTransform: HTMLDeserializerWithTransform<\n  ImageHTMLDeserializerOptions\n> = (next, _, { editor }) => {\n  return (node, options = {}) => {\n    const { element } = options\n    if (isDOMHTMLElement(node) && node.nodeName === 'IMG') {\n      const url = node.getAttribute('src') || node.getAttribute('data-src')\n      if (!url) return next(node, options)\n\n      const { onUploadBefore } = getOptions(editor)\n      if (onUploadBefore) {\n        const customUrl = onUploadBefore([url])[0]\n        if (!customUrl) return next(node, options)\n      }\n      const width =\n        node.getAttribute('width') ||\n        node.getAttribute('data-width') ||\n        window.getComputedStyle(node, 'width').width || node.style.width\n      let w = parseInt(width, 10)\n      w = isNaN(w) ? 0 : w\n      \n      const height =\n        node.getAttribute('height') ||\n        node.getAttribute('data-height') ||\n        window.getComputedStyle(node, 'height').height || node.style.height\n\n      let h = parseInt(height, 10)\n      h = isNaN(h) ? 0 : h\n      return [\n        {\n          ...element,\n          ...Image.create({\n            url,\n            state: 'waitingUpload',\n            width: w,\n            height: h,\n          }),\n        },\n      ]\n    }\n    return next(node, options)\n  }\n}\n","import { Editor } from '@editablejs/models'\nimport { ImageLocale } from './locale'\n\nexport type ImageHotkey = string | ((e: KeyboardEvent) => boolean)\n\nexport interface ImageOptions {\n  hotkey?: ImageHotkey\n  shortcuts?: boolean\n  locale?: Record<string, ImageLocale>\n  onBeforeRender?: (url: string) => Promise<string>\n  onUploadBefore?: (files: (File | string)[]) => (File | string)[]\n  onUpload?: (\n    file: File | string,\n    update: (options: Record<'percentage', number>) => void,\n  ) => Promise<string>\n  onRotate?: (file: File) => Promise<string | { url: string; rotate?: number }>\n  allowRotate?: boolean\n}\nconst IMAGE_OPTIONS = new WeakMap<Editor, ImageOptions>()\n\nexport const getOptions = (editor: Editor): ImageOptions => {\n  return IMAGE_OPTIONS.get(editor) ?? {}\n}\n\nexport const setOptions = (editor: Editor, options: ImageOptions) => {\n  IMAGE_OPTIONS.set(editor, options)\n}\n","import { Element } from '@editablejs/models'\nimport { IMAGE_KEY } from '../constants'\n\nexport type ImageState = 'uploading' | 'waitingUpload' | 'done' | 'error'\n\nexport type ImageStyle = 'none' | 'stroke' | 'shadow'\n\nexport interface Image extends Element {\n  type: typeof IMAGE_KEY\n  state?: ImageState\n  width?: number\n  height?: number\n  url?: string\n  percentage?: number\n  errorMessage?: string\n  rotate?: number\n  style?: ImageStyle\n  name?: string\n}\n\nexport const Image = {\n  isImage: (value: any): value is Image => {\n    return Element.isElement(value) && value.type === IMAGE_KEY\n  },\n\n  create: (image: Omit<Image, 'type' | 'children'> = {}): Image => {\n    return {\n      ...image,\n      type: IMAGE_KEY,\n      children: [{ text: '' }],\n    }\n  },\n}\n","export const IMAGE_KEY = 'image'\nexport const DATA_IMAGE_KEY = 'data-image-key'\n"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA,IAAAA,iBAAyC;;;ACczC,IAAM,gBAAgB,oBAAI,QAA8B;AAEjD,IAAM,aAAa,CAAC,WAAiC;AAC1D,SAAO,cAAc,IAAI,MAAM,KAAK,CAAC;AACvC;;;ACtBA,oBAAwB;;;ACAjB,IAAM,YAAY;;;ADoBlB,IAAM,QAAQ;AAAA,EACnB,SAAS,CAAC,UAA+B;AACvC,WAAO,sBAAQ,UAAU,KAAK,KAAK,MAAM,SAAS;AAAA,EACpD;AAAA,EAEA,QAAQ,CAAC,QAA0C,CAAC,MAAa;AAC/D,WAAO;AAAA,MACL,GAAG;AAAA,MACH,MAAM;AAAA,MACN,UAAU,CAAC,EAAE,MAAM,GAAG,CAAC;AAAA,IACzB;AAAA,EACF;AACF;;;AFpBO,IAAM,qCAET,CAAC,MAAM,GAAG,EAAE,OAAO,MAAM;AAC3B,SAAO,CAAC,MAAM,UAAU,CAAC,MAAM;AAC7B,UAAM,EAAE,QAAQ,IAAI;AACpB,YAAI,iCAAiB,IAAI,KAAK,KAAK,aAAa,OAAO;AACrD,YAAM,MAAM,KAAK,aAAa,KAAK,KAAK,KAAK,aAAa,UAAU;AACpE,UAAI,CAAC;AAAK,eAAO,KAAK,MAAM,OAAO;AAEnC,YAAM,EAAE,eAAe,IAAI,WAAW,MAAM;AAC5C,UAAI,gBAAgB;AAClB,cAAM,YAAY,eAAe,CAAC,GAAG,CAAC,EAAE;AACxC,YAAI,CAAC;AAAW,iBAAO,KAAK,MAAM,OAAO;AAAA,MAC3C;AACA,YAAM,QACJ,KAAK,aAAa,OAAO,KACzB,KAAK,aAAa,YAAY,KAC9B,OAAO,iBAAiB,MAAM,OAAO,EAAE,SAAS,KAAK,MAAM;AAC7D,UAAI,IAAI,SAAS,OAAO,EAAE;AAC1B,UAAI,MAAM,CAAC,IAAI,IAAI;AAEnB,YAAM,SACJ,KAAK,aAAa,QAAQ,KAC1B,KAAK,aAAa,aAAa,KAC/B,OAAO,iBAAiB,MAAM,QAAQ,EAAE,UAAU,KAAK,MAAM;AAE/D,UAAI,IAAI,SAAS,QAAQ,EAAE;AAC3B,UAAI,MAAM,CAAC,IAAI,IAAI;AACnB,aAAO;AAAA,QACL;AAAA,UACE,GAAG;AAAA,UACH,GAAG,MAAM,OAAO;AAAA,YACd;AAAA,YACA,OAAO;AAAA,YACP,OAAO;AAAA,YACP,QAAQ;AAAA,UACV,CAAC;AAAA,QACH;AAAA,MACF;AAAA,IACF;AACA,WAAO,KAAK,MAAM,OAAO;AAAA,EAC3B;AACF;","names":["import_models"]}
\ No newline at end of file
diff --git a/node_modules/@editablejs/plugin-image/dist/deserializer/html.mjs b/node_modules/@editablejs/plugin-image/dist/deserializer/html.mjs
index 374d0e3..b975aab 100644
--- a/node_modules/@editablejs/plugin-image/dist/deserializer/html.mjs
+++ b/node_modules/@editablejs/plugin-image/dist/deserializer/html.mjs
@@ -20,10 +20,10 @@ var withImageHTMLDeserializerTransform = (next, _, { editor }) => {
         if (!customUrl)
           return next(node, options);
       }
-      const width = node.getAttribute("width") || node.getAttribute("data-width") || window.getComputedStyle(node, "width").width;
+      const width = node.getAttribute("width") || node.getAttribute("data-width") || window.getComputedStyle(node, "width").width || node.style.width;
       let w = parseInt(width, 10);
       w = isNaN(w) ? 0 : w;
-      const height = node.getAttribute("height") || node.getAttribute("data-height") || window.getComputedStyle(node, "height").height;
+      const height = node.getAttribute("height") || node.getAttribute("data-height") || window.getComputedStyle(node, "height").height || node.style.height;
       let h = parseInt(height, 10);
       h = isNaN(h) ? 0 : h;
       return [
diff --git a/node_modules/@editablejs/plugin-image/dist/deserializer/html.mjs.map b/node_modules/@editablejs/plugin-image/dist/deserializer/html.mjs.map
index 8ad995c..1c1f53a 100644
--- a/node_modules/@editablejs/plugin-image/dist/deserializer/html.mjs.map
+++ b/node_modules/@editablejs/plugin-image/dist/deserializer/html.mjs.map
@@ -1 +1 @@
-{"version":3,"sources":["../../src/deserializer/html.ts"],"sourcesContent":["import {\n  HTMLDeserializerOptions,\n  HTMLDeserializerWithTransform,\n} from '@editablejs/deserializer/html'\nimport { Editor, isDOMHTMLElement } from '@editablejs/models'\nimport { IMAGE_KEY } from '../constants'\nimport { getOptions } from '../options'\nimport { Image } from '../interfaces/image'\nexport interface ImageHTMLDeserializerOptions extends HTMLDeserializerOptions {\n  editor: Editor\n}\n\nexport const withImageHTMLDeserializerTransform: HTMLDeserializerWithTransform<\n  ImageHTMLDeserializerOptions\n> = (next, _, { editor }) => {\n  return (node, options = {}) => {\n    const { element } = options\n    if (isDOMHTMLElement(node) && node.nodeName === 'IMG') {\n      const url = node.getAttribute('src') || node.getAttribute('data-src')\n      if (!url) return next(node, options)\n\n      const { onUploadBefore } = getOptions(editor)\n      if (onUploadBefore) {\n        const customUrl = onUploadBefore([url])[0]\n        if (!customUrl) return next(node, options)\n      }\n      const width =\n        node.getAttribute('width') ||\n        node.getAttribute('data-width') ||\n        window.getComputedStyle(node, 'width').width\n      let w = parseInt(width, 10)\n      w = isNaN(w) ? 0 : w\n\n      const height =\n        node.getAttribute('height') ||\n        node.getAttribute('data-height') ||\n        window.getComputedStyle(node, 'height').height\n\n      let h = parseInt(height, 10)\n      h = isNaN(h) ? 0 : h\n\n      return [\n        {\n          ...element,\n          ...Image.create({\n            url,\n            state: 'waitingUpload',\n            width: w,\n            height: h,\n          }),\n        },\n      ]\n    }\n    return next(node, options)\n  }\n}\n"],"mappings":";;;;;;;;AAIA,SAAiB,wBAAwB;AAQlC,IAAM,qCAET,CAAC,MAAM,GAAG,EAAE,OAAO,MAAM;AAC3B,SAAO,CAAC,MAAM,UAAU,CAAC,MAAM;AAC7B,UAAM,EAAE,QAAQ,IAAI;AACpB,QAAI,iBAAiB,IAAI,KAAK,KAAK,aAAa,OAAO;AACrD,YAAM,MAAM,KAAK,aAAa,KAAK,KAAK,KAAK,aAAa,UAAU;AACpE,UAAI,CAAC;AAAK,eAAO,KAAK,MAAM,OAAO;AAEnC,YAAM,EAAE,eAAe,IAAI,WAAW,MAAM;AAC5C,UAAI,gBAAgB;AAClB,cAAM,YAAY,eAAe,CAAC,GAAG,CAAC,EAAE;AACxC,YAAI,CAAC;AAAW,iBAAO,KAAK,MAAM,OAAO;AAAA,MAC3C;AACA,YAAM,QACJ,KAAK,aAAa,OAAO,KACzB,KAAK,aAAa,YAAY,KAC9B,OAAO,iBAAiB,MAAM,OAAO,EAAE;AACzC,UAAI,IAAI,SAAS,OAAO,EAAE;AAC1B,UAAI,MAAM,CAAC,IAAI,IAAI;AAEnB,YAAM,SACJ,KAAK,aAAa,QAAQ,KAC1B,KAAK,aAAa,aAAa,KAC/B,OAAO,iBAAiB,MAAM,QAAQ,EAAE;AAE1C,UAAI,IAAI,SAAS,QAAQ,EAAE;AAC3B,UAAI,MAAM,CAAC,IAAI,IAAI;AAEnB,aAAO;AAAA,QACL;AAAA,UACE,GAAG;AAAA,UACH,GAAG,MAAM,OAAO;AAAA,YACd;AAAA,YACA,OAAO;AAAA,YACP,OAAO;AAAA,YACP,QAAQ;AAAA,UACV,CAAC;AAAA,QACH;AAAA,MACF;AAAA,IACF;AACA,WAAO,KAAK,MAAM,OAAO;AAAA,EAC3B;AACF;","names":[]}
\ No newline at end of file
+{"version":3,"sources":["../../src/deserializer/html.ts"],"sourcesContent":["import {\n  HTMLDeserializerOptions,\n  HTMLDeserializerWithTransform,\n} from '@editablejs/deserializer/html'\nimport { Editor, isDOMHTMLElement } from '@editablejs/models'\nimport { IMAGE_KEY } from '../constants'\nimport { getOptions } from '../options'\nimport { Image } from '../interfaces/image'\nexport interface ImageHTMLDeserializerOptions extends HTMLDeserializerOptions {\n  editor: Editor\n}\n\nexport const withImageHTMLDeserializerTransform: HTMLDeserializerWithTransform<\n  ImageHTMLDeserializerOptions\n> = (next, _, { editor }) => {\n  return (node, options = {}) => {\n    const { element } = options\n    if (isDOMHTMLElement(node) && node.nodeName === 'IMG') {\n      const url = node.getAttribute('src') || node.getAttribute('data-src')\n      if (!url) return next(node, options)\n\n      const { onUploadBefore } = getOptions(editor)\n      if (onUploadBefore) {\n        const customUrl = onUploadBefore([url])[0]\n        if (!customUrl) return next(node, options)\n      }\n      const width =\n        node.getAttribute('width') ||\n        node.getAttribute('data-width') ||\n        window.getComputedStyle(node, 'width').width || node.style.width\n      let w = parseInt(width, 10)\n      w = isNaN(w) ? 0 : w\n      \n      const height =\n        node.getAttribute('height') ||\n        node.getAttribute('data-height') ||\n        window.getComputedStyle(node, 'height').height || node.style.height\n\n      let h = parseInt(height, 10)\n      h = isNaN(h) ? 0 : h\n      return [\n        {\n          ...element,\n          ...Image.create({\n            url,\n            state: 'waitingUpload',\n            width: w,\n            height: h,\n          }),\n        },\n      ]\n    }\n    return next(node, options)\n  }\n}\n"],"mappings":";;;;;;;;AAIA,SAAiB,wBAAwB;AAQlC,IAAM,qCAET,CAAC,MAAM,GAAG,EAAE,OAAO,MAAM;AAC3B,SAAO,CAAC,MAAM,UAAU,CAAC,MAAM;AAC7B,UAAM,EAAE,QAAQ,IAAI;AACpB,QAAI,iBAAiB,IAAI,KAAK,KAAK,aAAa,OAAO;AACrD,YAAM,MAAM,KAAK,aAAa,KAAK,KAAK,KAAK,aAAa,UAAU;AACpE,UAAI,CAAC;AAAK,eAAO,KAAK,MAAM,OAAO;AAEnC,YAAM,EAAE,eAAe,IAAI,WAAW,MAAM;AAC5C,UAAI,gBAAgB;AAClB,cAAM,YAAY,eAAe,CAAC,GAAG,CAAC,EAAE;AACxC,YAAI,CAAC;AAAW,iBAAO,KAAK,MAAM,OAAO;AAAA,MAC3C;AACA,YAAM,QACJ,KAAK,aAAa,OAAO,KACzB,KAAK,aAAa,YAAY,KAC9B,OAAO,iBAAiB,MAAM,OAAO,EAAE,SAAS,KAAK,MAAM;AAC7D,UAAI,IAAI,SAAS,OAAO,EAAE;AAC1B,UAAI,MAAM,CAAC,IAAI,IAAI;AAEnB,YAAM,SACJ,KAAK,aAAa,QAAQ,KAC1B,KAAK,aAAa,aAAa,KAC/B,OAAO,iBAAiB,MAAM,QAAQ,EAAE,UAAU,KAAK,MAAM;AAE/D,UAAI,IAAI,SAAS,QAAQ,EAAE;AAC3B,UAAI,MAAM,CAAC,IAAI,IAAI;AACnB,aAAO;AAAA,QACL;AAAA,UACE,GAAG;AAAA,UACH,GAAG,MAAM,OAAO;AAAA,YACd;AAAA,YACA,OAAO;AAAA,YACP,OAAO;AAAA,YACP,QAAQ;AAAA,UACV,CAAC;AAAA,QACH;AAAA,MACF;AAAA,IACF;AACA,WAAO,KAAK,MAAM,OAAO;AAAA,EAC3B;AACF;","names":[]}
\ No newline at end of file
diff --git a/node_modules/@editablejs/plugin-image/dist/index.js b/node_modules/@editablejs/plugin-image/dist/index.js
index 42f80cb..cd6e16e 100644
--- a/node_modules/@editablejs/plugin-image/dist/index.js
+++ b/node_modules/@editablejs/plugin-image/dist/index.js
@@ -609,7 +609,9 @@ var ImageComponent = (0, import_react2.forwardRef)(({
       width: isError ? void 0 : size[0] || "auto",
       height: loaded || isError ? void 0 : size[1] || "auto"
     }, children: [
-      /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(_StyledDiv8, { onMouseDown: handleImageDown, onClick: handleImageClick, children: [
+      /* @__PURE__ */ (0, import_jsx_runtime.jsxs)(_StyledDiv8, { style: {
+        width: "100%"
+      }, onMouseDown: handleImageDown, onClick: handleImageClick, children: [
         renderImage(),
         renderStyleStroke(),
         /* @__PURE__ */ (0, import_jsx_runtime.jsx)(_StyledDiv9, { children }),
@@ -732,7 +734,8 @@ var _StyledDiv7 = _styled("div").withConfig({
 var _StyledDiv8 = _styled("div").withConfig({
   componentId: "sc-1385wrh-9"
 })({
-  "display": "inline-block"
+  "display": "inline-block",
+  "maxWidth": "100%"
 });
 var _StyledDiv9 = _styled("div").withConfig({
   componentId: "sc-1385wrh-10"
@@ -868,6 +871,7 @@ var ViewerToolbar = (props) => {
     /* @__PURE__ */ (0, import_jsx_runtime2.jsx)(
       import_ui3.DragToolbar,
       {
+        className: "drag-toolbar",
         ...props,
         items: [
           {
@@ -924,7 +928,7 @@ var ImageViewer = import_react6.default.memo(() => {
   const images = (0, import_react6.useMemo)(() => {
     return visible ? viewer.images() : [];
   }, [visible, viewer]);
-  return /* @__PURE__ */ (0, import_jsx_runtime3.jsx)(import_react_image_previewer.PhotoSlider, { mode: "drag", images, visible, index, onIndexChange: setIndex, onClose: () => setVisible(false), loop: true, pullClosable: false, maskOpacity: import_editor6.isTouchDevice ? 1 : 0.9, loadingElement: /* @__PURE__ */ (0, import_jsx_runtime3.jsx)(_StyledIcon, { name: "loading" }), overlayRender: (props) => {
+  return /* @__PURE__ */ (0, import_jsx_runtime3.jsx)(import_react_image_previewer.PhotoSlider, { mode: "drag", className: "image-dialog", images, visible, index, onIndexChange: setIndex, onClose: () => setVisible(false), loop: true, pullClosable: false, maskOpacity: import_editor6.isTouchDevice ? 1 : 0.9, loadingElement: /* @__PURE__ */ (0, import_jsx_runtime3.jsx)(_StyledIcon, { name: "loading" }), overlayRender: (props) => {
     return /* @__PURE__ */ (0, import_jsx_runtime3.jsx)(ViewerToolbar, { ...props });
   } });
 });
diff --git a/node_modules/@editablejs/plugin-image/dist/index.js.map b/node_modules/@editablejs/plugin-image/dist/index.js.map
index 5d969b7..6f0fa42 100644
--- a/node_modules/@editablejs/plugin-image/dist/index.js.map
+++ b/node_modules/@editablejs/plugin-image/dist/index.js.map
@@ -1 +1 @@
-{"version":3,"sources":["../src/index.ts","../src/interfaces/image.ts","../src/constants.ts","../src/plugin/image-editor.ts","../src/options.ts","../src/plugin/with-image.tsx","../src/components/image.tsx","../src/hooks/use-viewer.ts","../src/create-viewer.tsx","../src/store/viewer.ts","../src/utils.ts","../src/locale/zh_CN.ts","../src/locale/en_US.ts","../src/locale/index.ts","../src/components/viewer.tsx","../src/hooks/use-viewer-index.ts","../src/hooks/use-viewer-store.ts","../src/hooks/use-viewer-visible.ts","../src/components/viewer-toolbar.tsx","../src/plugin/with-shortcuts.ts"],"sourcesContent":["export type { ImageOptions, ImageHotkey } from './options'\n\nexport type { ImageLocale } from './locale'\n\nexport * from './interfaces/image'\n\nexport * from './plugin/image-editor'\n\nexport * from './plugin/with-image'\n","import { Element } from '@editablejs/models'\nimport { IMAGE_KEY } from '../constants'\n\nexport type ImageState = 'uploading' | 'waitingUpload' | 'done' | 'error'\n\nexport type ImageStyle = 'none' | 'stroke' | 'shadow'\n\nexport interface Image extends Element {\n  type: typeof IMAGE_KEY\n  state?: ImageState\n  width?: number\n  height?: number\n  url?: string\n  percentage?: number\n  errorMessage?: string\n  rotate?: number\n  style?: ImageStyle\n  name?: string\n}\n\nexport const Image = {\n  isImage: (value: any): value is Image => {\n    return Element.isElement(value) && value.type === IMAGE_KEY\n  },\n\n  create: (image: Omit<Image, 'type' | 'children'> = {}): Image => {\n    return {\n      ...image,\n      type: IMAGE_KEY,\n      children: [{ text: '' }],\n    }\n  },\n}\n","export const IMAGE_KEY = 'image'\nexport const DATA_IMAGE_KEY = 'data-image-key'\n","import { Editor } from '@editablejs/models'\nimport { IMAGE_KEY } from '../constants'\nimport { Image, ImageStyle } from '../interfaces/image'\nimport { getOptions } from '../options'\n\nexport interface InsertImageOptions {\n  file: File | string\n}\nexport interface OpenImageOptions extends Omit<InsertImageOptions, 'file'> {\n  accept?: string\n  multiple?: boolean\n}\n\nexport interface ImageEditor extends Editor {\n  openImage: (options?: OpenImageOptions) => void\n\n  insertImage: (options: InsertImageOptions) => Promise<void>\n\n  rotateImage: (rotate: number, image: Image) => void\n\n  setStyleImage: (style: ImageStyle, image: Image) => void\n}\n\nexport const ImageEditor = {\n  isImageEditor: (editor: Editor): editor is ImageEditor => {\n    return !!(editor as ImageEditor).openImage\n  },\n\n  isImage: (editor: Editor, n: any): n is Image => {\n    return Image.isImage(n)\n  },\n\n  isActive: (editor: Editor) => {\n    const elements = Editor.elements(editor)\n    return !!elements[IMAGE_KEY]\n  },\n\n  getOptions,\n\n  open: (editor: Editor, options?: OpenImageOptions) => {\n    if (ImageEditor.isImageEditor(editor)) editor.openImage(options)\n  },\n\n  insert: (editor: Editor, options: InsertImageOptions) => {\n    if (ImageEditor.isImageEditor(editor)) editor.insertImage(options)\n  },\n\n  rotate: (editor: Editor, rotate: number, image: Image) => {\n    if (ImageEditor.isImageEditor(editor)) editor.rotateImage(rotate, image)\n  },\n\n  setStyle: (editor: Editor, style: ImageStyle, image: Image) => {\n    if (ImageEditor.isImageEditor(editor)) editor.setStyleImage(style, image)\n  },\n}\n","import { Editor } from '@editablejs/models'\nimport { ImageLocale } from './locale'\n\nexport type ImageHotkey = string | ((e: KeyboardEvent) => boolean)\n\nexport interface ImageOptions {\n  hotkey?: ImageHotkey\n  shortcuts?: boolean\n  locale?: Record<string, ImageLocale>\n  onBeforeRender?: (url: string) => Promise<string>\n  onUploadBefore?: (files: (File | string)[]) => (File | string)[]\n  onUpload?: (\n    file: File | string,\n    update: (options: Record<'percentage', number>) => void,\n  ) => Promise<string>\n  onRotate?: (file: File) => Promise<string | { url: string; rotate?: number }>\n  allowRotate?: boolean\n}\nconst IMAGE_OPTIONS = new WeakMap<Editor, ImageOptions>()\n\nexport const getOptions = (editor: Editor): ImageOptions => {\n  return IMAGE_OPTIONS.get(editor) ?? {}\n}\n\nexport const setOptions = (editor: Editor, options: ImageOptions) => {\n  IMAGE_OPTIONS.set(editor, options)\n}\n","import { Editable, Hotkey, Locale, Slot } from '@editablejs/editor'\nimport { Editor, Operation, Transforms } from '@editablejs/models'\nimport { withHistoryProtocol } from '@editablejs/protocols/history'\nimport { openFileDialog } from '@editablejs/ui'\nimport { setOptions, ImageHotkey, ImageOptions } from '../options'\nimport { Image } from '../interfaces/image'\nimport { ImageComponent } from '../components/image'\nimport { ImageEditor } from './image-editor'\nimport locale from '../locale'\nimport {\n  insertImage,\n  readImageFileInfo,\n  uploadImage,\n  rotateImgWithCanvas,\n  readImageElement,\n} from '../utils'\nimport { ImageViewer } from '../components/viewer'\nimport { withShortcuts } from './with-shortcuts'\n\nconst defaultHotkey: ImageHotkey = ''\n\nconst defaultBeforeUpload = (files: File[]) => {\n  return files.filter(file => file.type.startsWith('image/'))\n}\n\nexport const withImage = <T extends Editable>(editor: T, options: ImageOptions = {}) => {\n  const newEditor = editor as T & ImageEditor\n\n  setOptions(newEditor, options)\n\n  const { isInline, isVoid } = newEditor\n  const historyProtocol = withHistoryProtocol(newEditor)\n  const { capture } = historyProtocol\n\n  historyProtocol.capture = (op: Operation) => {\n    if (op.type === 'set_node') {\n      const { path, newProperties } = op\n      if (Editor.hasPath(editor, path)) {\n        const image = Editor.node(editor, path)\n        if (Image.isImage(image[0])) {\n          const prop = newProperties as Partial<Image>\n          if (prop.url || prop.state || prop.percentage) {\n            return false\n          }\n        }\n      }\n    }\n    return capture(op)\n  }\n\n  const { locale: localeOptions = {} } = options\n  Locale.setLocale(newEditor, locale, localeOptions)\n\n  Slot.mount(newEditor, ImageViewer)\n\n  newEditor.isInline = element => {\n    return ImageEditor.isImage(newEditor, element) || isInline(element)\n  }\n\n  newEditor.isVoid = element => {\n    return ImageEditor.isImage(newEditor, element) || isVoid(element)\n  }\n\n  const insertImages = (files: (File | string)[]) => {\n    Promise.all(\n      files.map(file =>\n        typeof file === 'string' ? Promise.resolve(file) : readImageFileInfo(file),\n      ),\n    ).then(items => {\n      items.forEach(item => {\n        if (!item) return\n        if (typeof item === 'string') return newEditor.insertImage({ file: item })\n        const { url, file, width, height } = item\n        const path = insertImage(newEditor, {\n          url,\n          width,\n          height,\n          name: file.name,\n          state: 'uploading',\n        })\n        uploadImage(editor, path, file).then(() => {\n          URL.revokeObjectURL(url)\n        })\n      })\n    })\n  }\n  const { onUploadBefore = defaultBeforeUpload } = options\n\n  newEditor.openImage = ({ accept = 'image/*', multiple = false } = {}) => {\n    if (!newEditor.selection) {\n      newEditor.focus(false)\n    }\n\n    openFileDialog({\n      accept,\n      multiple,\n      onChange: files => {\n        const customFiles = onUploadBefore(files)\n        if (customFiles.length > 0) insertImages(files)\n      },\n    })\n  }\n\n  newEditor.insertImage = async ({ file }) => {\n    if (!newEditor.selection) {\n      newEditor.focus(false)\n    }\n\n    const url = file instanceof File ? URL.createObjectURL(file) : file\n    editor.normalizeSelection(selection => {\n      if (editor.selection !== selection) editor.selection = selection\n      const path = insertImage(editor, {\n        url,\n        state: 'uploading',\n      })\n\n      return uploadImage(editor, path, file)\n    })\n  }\n\n  newEditor.rotateImage = (rotate, image) => {\n    const { onRotate, allowRotate } = options\n    const { url, state } = image\n    if (state !== 'done') return\n    const degrees = rotate % -360\n    if (onRotate && url && allowRotate !== false) {\n      readImageElement(url, true).then(img => {\n        rotateImgWithCanvas(img, degrees).then(blob => {\n          const file = new File([blob], image.name ?? 'rotate.png', { type: 'image/png' })\n          onRotate(file).then(res => {\n            if (res) {\n              const info = typeof res === 'string' ? { url: res, rotate: 0 } : res\n              Transforms.setNodes<Image>(\n                editor,\n                {\n                  rotate: info.rotate,\n                  url: info.url,\n                },\n                {\n                  at: Editable.findPath(editor, image),\n                },\n              )\n            }\n          })\n        })\n      })\n    }\n    Transforms.setNodes<Image>(\n      editor,\n      {\n        rotate,\n      },\n      {\n        at: Editable.findPath(editor, image),\n      },\n    )\n  }\n\n  newEditor.setStyleImage = (style, image) => {\n    Transforms.setNodes<Image>(\n      editor,\n      {\n        style,\n      },\n      {\n        at: Editable.findPath(editor, image),\n      },\n    )\n  }\n\n  const { renderElement } = newEditor\n  newEditor.renderElement = ({ element, attributes, children }) => {\n    if (ImageEditor.isImage(editor, element)) {\n      return (\n        <ImageComponent {...attributes} element={element} editor={newEditor}>\n          {children}\n        </ImageComponent>\n      )\n    }\n    return renderElement({ attributes, children, element })\n  }\n\n  const hotkey = options.hotkey ?? defaultHotkey\n  const { onKeydown, insertFile } = newEditor\n  newEditor.onKeydown = (e: KeyboardEvent) => {\n    if (Hotkey.match(hotkey, e)) {\n      e.preventDefault()\n      newEditor.openImage()\n      return\n    }\n\n    onKeydown(e)\n  }\n\n  newEditor.insertFile = (file, at) => {\n    const customFiles = onUploadBefore([file])\n    if (customFiles.length > 0) {\n      if (at) {\n        Transforms.select(newEditor, at)\n      }\n      insertImages(customFiles)\n      return\n    }\n    insertFile(file, at)\n  }\n\n  const { shortcuts } = options\n  if (shortcuts !== false) {\n    withShortcuts(newEditor)\n  }\n  return newEditor\n}\n","import _styled12styled_components from 'styled-components';\n            const _styled12 = typeof _styled12styled_components.default === 'undefined' ? _styled12styled_components : _styled12styled_components.default;;\nimport _styled11styled_components from 'styled-components';\n            const _styled11 = typeof _styled11styled_components.default === 'undefined' ? _styled11styled_components : _styled11styled_components.default;;\nimport _styled10styled_components from 'styled-components';\n            const _styled10 = typeof _styled10styled_components.default === 'undefined' ? _styled10styled_components : _styled10styled_components.default;;\nimport _styled9styled_components from 'styled-components';\n            const _styled9 = typeof _styled9styled_components.default === 'undefined' ? _styled9styled_components : _styled9styled_components.default;;\nimport _styled8styled_components from 'styled-components';\n            const _styled8 = typeof _styled8styled_components.default === 'undefined' ? _styled8styled_components : _styled8styled_components.default;;\nimport _styled7styled_components from 'styled-components';\n            const _styled7 = typeof _styled7styled_components.default === 'undefined' ? _styled7styled_components : _styled7styled_components.default;;\nimport _styled6styled_components from 'styled-components';\n            const _styled6 = typeof _styled6styled_components.default === 'undefined' ? _styled6styled_components : _styled6styled_components.default;;\nimport _styled5styled_components from 'styled-components';\n            const _styled5 = typeof _styled5styled_components.default === 'undefined' ? _styled5styled_components : _styled5styled_components.default;;\nimport _styled4styled_components from 'styled-components';\n            const _styled4 = typeof _styled4styled_components.default === 'undefined' ? _styled4styled_components : _styled4styled_components.default;;\nimport _styled3styled_components from 'styled-components';\n            const _styled3 = typeof _styled3styled_components.default === 'undefined' ? _styled3styled_components : _styled3styled_components.default;;\nimport _styled2styled_components from 'styled-components';\n            const _styled2 = typeof _styled2styled_components.default === 'undefined' ? _styled2styled_components : _styled2styled_components.default;;\nimport _styledstyled_components from 'styled-components';\n            const _styled = typeof _styledstyled_components.default === 'undefined' ? _styledstyled_components : _styledstyled_components.default;;\nimport { css as _css } from \"styled-components\";\nimport { Editable, useLocale, useNodeFocused, useReadOnly } from '@editablejs/editor';\nimport { Editor, Transforms } from '@editablejs/models';\nimport { Icon, Popover, PopoverContent, PopoverTrigger, Resizer, Toolbar, ToolbarButton, ToolbarDropdown, Tooltip, useIsomorphicLayoutEffect } from '@editablejs/ui';\nimport React, { forwardRef, useEffect, useMemo, useRef, useState } from 'react';\nimport { DATA_IMAGE_KEY } from '../constants';\nimport { useViewer } from '../hooks/use-viewer';\nimport { getOptions } from '../options';\nimport { readImageElement, rotateImgWithCanvas, uploadImage } from '../utils';\nexport const ImageComponent = forwardRef(({\n  children,\n  element,\n  editor,\n  ...props\n}, ref) => {\n  const {\n    url,\n    state,\n    rotate,\n    errorMessage,\n    percentage,\n    width,\n    height\n  } = element;\n  const [errorMsg, setErrorMsg] = useState(errorMessage);\n  const [loading, setLoading] = useState(true);\n  const [loaded, setLoaded] = useState(false);\n  const [src, setSrc] = useState('');\n  const [rotatedUrl, setRotatedUrl] = useState('');\n  const [imageDOMElement, setImageDOMElement] = useState(null);\n  const [readOnly] = useReadOnly();\n  const options = useMemo(() => {\n    return getOptions(editor);\n  }, [editor]);\n  const viewer = useViewer();\n  useIsomorphicLayoutEffect(() => {\n    if (options.onBeforeRender && url && state === 'done') {\n      options.onBeforeRender(url).then(url => {\n        setSrc(url);\n      }).catch(err => {\n        setErrorMsg(err.message);\n      }).finally(() => {\n        setLoading(false);\n      });\n    } else if (url && state === 'waitingUpload') {\n      uploadImage(editor, Editable.findPath(editor, element), url);\n    } else if (url) {\n      setSrc(url);\n      setLoading(false);\n    }\n  }, [url, state]);\n  useIsomorphicLayoutEffect(() => {\n    if (src) {\n      readImageElement(src).then(image => {\n        setLoaded(true);\n        setImageDOMElement(image);\n      }).catch(err => {\n        if (state === 'done') setErrorMsg(typeof err === 'object' ? err.message : err);\n      });\n    }\n  }, [src, state]);\n  useEffect(() => {\n    if (!imageDOMElement) {\n      return setRotatedUrl('');\n    }\n\n    if (rotate !== undefined && loaded && state === 'done' && options.allowRotate !== false) {\n      readImageElement(imageDOMElement.src, true).then(img => {\n        rotateImgWithCanvas(img, rotate).then(blob => {\n          setRotatedUrl(URL.createObjectURL(blob));\n        });\n      });\n    }\n  }, [imageDOMElement, rotate, state, loaded, options.allowRotate]);\n  useEffect(() => {\n    return () => {\n      if (rotatedUrl) {\n        URL.revokeObjectURL(rotatedUrl);\n      }\n    };\n  }, [rotatedUrl]);\n  const [maxWidth, setMaxWidth] = useState(0);\n  useEffect(() => {\n    const path = Editable.findPath(editor, element);\n    const parentEntry = Editor.above(editor, {\n      at: path,\n      match: n => Editor.isBlock(editor, n),\n      mode: 'lowest'\n    });\n\n    if (parentEntry) {\n      const parentEl = Editable.toDOMNode(editor, parentEntry[0]);\n      setMaxWidth(parentEl.clientWidth);\n    }\n  }, [editor, element]);\n  const focused = useNodeFocused();\n  const isUploading = state === 'uploading' || state === 'waitingUpload';\n\n  const renderUploading = () => {\n    if (!isUploading) return null;\n    return <_StyledDiv>\n          {percentage !== undefined && <_StyledDiv2 $_css2={[{\n        \"position\": \"relative\",\n        \"height\": \"0.5rem\",\n        \"width\": \"33.333333%\",\n        \"overflow\": \"hidden\",\n        \"borderRadius\": \"0.25rem\",\n        \"backgroundColor\": \"rgb(156 163 175 / 0.3)\"\n      }, _css([\"min-width:8px;\"])]}>\n              <_StyledDiv3 style={{\n          width: `${percentage}%`\n        }}></_StyledDiv3>\n            </_StyledDiv2>}\n          {percentage === undefined && <Icon name=\"loading\" />}\n        </_StyledDiv>;\n  };\n\n  const renderLoading = () => {\n    if (!loading || loaded) return null;\n    return <_StyledDiv4>\n          <Icon name=\"loading\" />\n        </_StyledDiv4>;\n  };\n\n  const isError = state === 'error' || !!errorMsg;\n\n  const renderError = () => {\n    if (!isError) return null;\n    return <_StyledSpan>\n          <span>{errorMsg || 'Image error.'}</span>\n        </_StyledSpan>;\n  };\n\n  const renderImage = () => {\n    if (isError || !src || !loaded) return null;\n    const atts = {\n      [DATA_IMAGE_KEY]: Editable.findKey(editor, element).id\n    };\n    return <_StyledImg {...atts} alt=\"\" draggable={false} src={rotatedUrl || src} $_css3={[{\n      \"display\": \"inline-block\",\n      \"height\": \"100%\",\n      \"width\": \"100%\",\n      \"borderRadius\": \"0.25rem\",\n      \"verticalAlign\": \"baseline\"\n    }, isUploading && {\n      \"opacity\": \"0.3\"\n    }]} />;\n  };\n\n  const handleResizeChange = (width, height) => {\n    Transforms.setNodes(editor, {\n      width,\n      height\n    }, {\n      at: Editable.findPath(editor, element)\n    });\n  };\n\n  const isFocusedMouseDownBefore = useRef(false);\n\n  const handleImageDown = () => {\n    isFocusedMouseDownBefore.current = focused;\n  };\n\n  const handleImageClick = event => {\n    if (isFocusedMouseDownBefore.current && !event.defaultPrevented && isDone && loaded) {\n      viewer.open(element);\n    }\n  };\n\n  const renderStyleStroke = () => {\n    if (element.style !== 'stroke') return null;\n    return <_StyledDiv5 />;\n  };\n\n  const changeStyle = style => {\n    editor.setStyleImage(style, element);\n  };\n\n  const changeRotate = rotate => {\n    if (Math.abs(rotate) === 360) {\n      rotate = 0;\n    }\n\n    editor.rotateImage(rotate, element);\n  };\n\n  const isDone = state === 'done';\n  const autoSize = useMemo(() => {\n    if (height === undefined || width === undefined) return undefined;\n    const ratio = height / width;\n\n    if (width > maxWidth && maxWidth > 0) {\n      return [maxWidth, maxWidth * ratio];\n    }\n\n    return [width, height];\n  }, [width, height, loaded, maxWidth]);\n  const size = autoSize || [width, height];\n  const [popoverOpen, setPopoverOpen] = useState(false);\n\n  const handlePopoverOpenChange = open => {\n    if (focused) {\n      setPopoverOpen(true);\n    } else {\n      setPopoverOpen(open);\n    }\n  };\n\n  useIsomorphicLayoutEffect(() => {\n    setPopoverOpen(focused);\n  }, [focused]);\n  const {\n    style: styleLocale,\n    viewer: viewerLocale\n  } = useLocale('image');\n  return <Popover open={isDone && !readOnly ? popoverOpen : false} onOpenChange={handlePopoverOpenChange} trigger=\"hover\">\n        <PopoverTrigger asChild>\n          <_StyledDiv6 {...props} ref={ref} $_css4={[{\n        \"position\": \"relative\",\n        \"display\": \"inline-block\",\n        \"maxWidth\": \"100%\",\n        \"cursor\": \"default\",\n        \"borderRadius\": \"0.25rem\",\n        \"borderWidth\": \"1px\",\n        \"borderColor\": \"transparent\",\n        \"lineHeight\": \"0\"\n      }, element.style === 'shadow' && {\n        \"--tw-shadow\": \"0 2px 6px 2px rgb(60 64 67 / 15%)\",\n        \"--tw-shadow-colored\": \"0 2px 6px 2px var(--tw-shadow-color)\",\n        \"boxShadow\": \"var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)\"\n      }, focused && isDone && {\n        \"cursor\": \"zoom-in\"\n      }, !loaded && {\n        \"--tw-bg-opacity\": \"1\",\n        \"backgroundColor\": \"rgb(243 244 246 / var(--tw-bg-opacity))\"\n      }, !focused && isDone && popoverOpen && {\n        \"--tw-border-opacity\": \"1\",\n        \"borderColor\": \"rgb(64 150 255 / var(--tw-border-opacity))\"\n      }, (loading || isUploading || isError) && {\n        \"lineHeight\": \"inherit\"\n      }]}>\n            <_StyledDiv7 style={{\n          width: isError ? undefined : size[0] || 'auto',\n          height: loaded || isError ? undefined : size[1] || 'auto'\n        }}>\n              <_StyledDiv8 onMouseDown={handleImageDown} onClick={handleImageClick}>\n                {renderImage()}\n                {renderStyleStroke()}\n                <_StyledDiv9>{children}</_StyledDiv9>\n                {renderUploading()}\n                {renderError()}\n                {renderLoading()}\n              </_StyledDiv8>\n              {focused && !readOnly && !isError && <_StyledResizer onChange={handleResizeChange} previewImage={isDone && loaded ? rotatedUrl || src : undefined} holders={isDone ? undefined : []} />}\n            </_StyledDiv7>\n          </_StyledDiv6>\n        </PopoverTrigger>\n        <PopoverContent autoUpdate={true} side=\"top\" sideOffset={5}>\n          <Toolbar mode=\"inline\">\n            {options.allowRotate !== false && <Tooltip content={viewerLocale.rotateLeft} side=\"top\" sideOffset={5} arrow={false}>\n                <ToolbarButton icon={<Icon name=\"rotateLeft\" />} onToggle={() => changeRotate((rotate ?? 0) - 90)} />\n              </Tooltip>}\n            <Tooltip content={styleLocale.tooltip} side=\"top\" sideOffset={5} arrow={false}>\n              <ToolbarDropdown onSelect={value => changeStyle(value)} value={element.style || 'none'} items={[{\n            value: 'none',\n            content: styleLocale.none\n          }, {\n            value: 'stroke',\n            content: styleLocale.stroke\n          }, {\n            value: 'shadow',\n            content: styleLocale.shadow\n          }]}>\n                {styleLocale.title}\n              </ToolbarDropdown>\n            </Tooltip>\n          </Toolbar>\n        </PopoverContent>\n      </Popover>;\n});\nImageComponent.displayName = 'ImageComponent';\n\nvar _StyledDiv = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-0\"\n})({\n  \"position\": \"absolute\",\n  \"left\": \"0px\",\n  \"top\": \"0px\",\n  \"display\": \"flex\",\n  \"height\": \"100%\",\n  \"width\": \"100%\",\n  \"alignItems\": \"center\",\n  \"justifyContent\": \"center\",\n  \"--tw-text-opacity\": \"1\",\n  \"color\": \"rgb(64 150 255 / var(--tw-text-opacity))\"\n});\n\nvar _StyledDiv2 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-1\"\n})([\"\", \"\"], p => p.$_css2);\n\nvar _StyledDiv3 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-2\"\n})({\n  \"position\": \"absolute\",\n  \"left\": \"0px\",\n  \"top\": \"0px\",\n  \"height\": \"100%\",\n  \"@keyframes pulse\": {\n    \"50%\": {\n      \"opacity\": \".5\"\n    }\n  },\n  \"animation\": \"pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite\",\n  \"--tw-bg-opacity\": \"1\",\n  \"backgroundColor\": \"rgb(64 150 255 / var(--tw-bg-opacity))\"\n});\n\nvar _StyledDiv4 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-3\"\n})({\n  \"position\": \"absolute\",\n  \"left\": \"0px\",\n  \"top\": \"0px\",\n  \"display\": \"flex\",\n  \"height\": \"100%\",\n  \"width\": \"100%\",\n  \"alignItems\": \"center\",\n  \"justifyContent\": \"center\",\n  \"--tw-text-opacity\": \"1\",\n  \"color\": \"rgb(64 150 255 / var(--tw-text-opacity))\"\n});\n\nvar _StyledSpan = _styled(\"span\").withConfig({\n  componentId: \"sc-1385wrh-4\"\n})({\n  \"borderRadius\": \"0.25rem\",\n  \"borderWidth\": \"1px\",\n  \"--tw-border-opacity\": \"1\",\n  \"borderColor\": \"rgb(209 213 219 / var(--tw-border-opacity))\",\n  \"paddingLeft\": \"0.5rem\",\n  \"paddingRight\": \"0.5rem\",\n  \"paddingTop\": \"0.125rem\",\n  \"paddingBottom\": \"0.125rem\",\n  \"verticalAlign\": \"baseline\",\n  \"fontSize\": \"12px\",\n  \"--tw-text-opacity\": \"1\",\n  \"color\": \"rgb(239 68 68 / var(--tw-text-opacity))\"\n});\n\nvar _StyledImg = _styled(\"img\").withConfig({\n  componentId: \"sc-1385wrh-5\"\n})([\"\", \"\"], p => p.$_css3);\n\nvar _StyledDiv5 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-6\"\n})({\n  \"pointerEvents\": \"none\",\n  \"position\": \"absolute\",\n  \"top\": \"0px\",\n  \"right\": \"0px\",\n  \"bottom\": \"0px\",\n  \"left\": \"0px\",\n  \"height\": \"100%\",\n  \"width\": \"100%\",\n  \"borderRadius\": \"0.25rem\",\n  \"borderWidth\": \"1px\",\n  \"--tw-border-opacity\": \"1\",\n  \"borderColor\": \"rgb(209 213 219 / var(--tw-border-opacity))\"\n});\n\nvar _StyledDiv6 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-7\"\n})([\"\", \"\"], p => p.$_css4);\n\nvar _StyledDiv7 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-8\"\n})({\n  \"display\": \"inline-block\",\n  \"height\": \"auto\",\n  \"minHeight\": \"24px\",\n  \"minWidth\": \"24px\",\n  \"maxWidth\": \"100%\"\n});\n\nvar _StyledDiv8 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-9\"\n})({\n  \"display\": \"inline-block\"\n});\n\nvar _StyledDiv9 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-10\"\n})({\n  \"position\": \"absolute\",\n  \"display\": \"none\"\n});\n\nvar _StyledResizer = _styled(Resizer).withConfig({\n  componentId: \"sc-1385wrh-11\"\n})({\n  \"borderRadius\": \"0.25rem\"\n});","import { useEditableStatic } from '@editablejs/editor'\nimport { useMemo } from 'react'\nimport { getViewer } from '../create-viewer'\n\nexport const useViewer = () => {\n  const editor = useEditableStatic()\n\n  return useMemo(() => getViewer(editor), [editor])\n}\n","import { Editable } from '@editablejs/editor'\nimport { Editor } from '@editablejs/models'\nimport { DataType } from 'react-image-previewer'\nimport { DATA_IMAGE_KEY } from './constants'\nimport { Image } from './interfaces/image'\nimport { getViewerStore } from './store'\n\nconst IMAGES_CACHE_WEAKMAP = new WeakMap<Editor, DataType[]>()\n\nconst findImages = (editor: Editable, force = false) => {\n  const caches = IMAGES_CACHE_WEAKMAP.get(editor)\n  if (caches && !force) return caches\n  const images: DataType[] = []\n  const nodes = Editor.nodes(editor, {\n    at: [],\n    match: node => Image.isImage(node) && !!node.url,\n  })\n\n  for (const [node] of nodes) {\n    const key = Editable.findKey(editor, node).id\n    const el = Editable.toDOMNode(editor, node)\n    const image = el.querySelector(`img[${DATA_IMAGE_KEY}=\"${key}\"]`)\n    if (!image) continue\n    const src = image.getAttribute('src')\n    if (!src) continue\n    images.push({\n      key,\n      src,\n    })\n  }\n  IMAGES_CACHE_WEAKMAP.set(editor, images)\n  return images\n}\n\nexport const VIEWER_CACHE_WEAKMAP = new WeakMap<Editor, ReturnType<typeof createViewer>>()\n\nconst createViewer = (editor: Editable) => {\n  const viewer = {\n    images: (force = false) => findImages(editor, force),\n\n    count: () => {\n      return viewer.images().length\n    },\n\n    open: (image: Image) => {\n      const store = getViewerStore(editor)\n      const images = viewer.images(true)\n      const key = Editable.findKey(editor, image).id\n      return store.setState({\n        visible: true,\n        index: images.findIndex(image => image.key === key),\n      })\n    },\n\n    close: () => {\n      const store = getViewerStore(editor)\n      store.setState({\n        visible: false,\n        index: -1,\n      })\n    },\n\n    prev: () => {\n      const store = getViewerStore(editor)\n      const count = viewer.count()\n      const index = store.getState().index\n      let val = index - 1\n      if (val < 0) val = count - 1\n      store.setState({\n        index: val,\n      })\n    },\n\n    next: () => {\n      const store = getViewerStore(editor)\n      const count = viewer.count()\n      const index = store.getState().index\n      let val = index + 1\n      if (val === count) val = 0\n      store.setState({\n        index: val,\n      })\n    },\n  }\n  return viewer\n}\n\nexport const getViewer = (editor: Editable) => {\n  let viewer = VIEWER_CACHE_WEAKMAP.get(editor)\n  if (viewer) {\n    return viewer\n  }\n  viewer = createViewer(editor)\n  VIEWER_CACHE_WEAKMAP.set(editor, viewer)\n  return viewer\n}\n","import { Editor } from '@editablejs/models'\nimport create, { StoreApi, UseBoundStore } from 'zustand'\nexport interface ImageViewerStore {\n  visible: boolean\n  index: number\n}\n\nconst EDITOR_TO_IMAGE_STORE = new WeakMap<Editor, UseBoundStore<StoreApi<ImageViewerStore>>>()\n\nexport const getViewerStore = (editor: Editor) => {\n  let store = EDITOR_TO_IMAGE_STORE.get(editor)\n  if (!store) {\n    store = create<ImageViewerStore>(() => ({\n      visible: false,\n      index: 0,\n    }))\n    EDITOR_TO_IMAGE_STORE.set(editor, store)\n  }\n  return store\n}\n","import { Editor, Path, Transforms } from '@editablejs/models'\nimport { IMAGE_KEY } from './constants'\nimport { Image } from './interfaces/image'\nimport { getOptions } from './options'\n\nconst readBase64WithFileReader = (file: File) => {\n  return new Promise<string>((resolve, reject) => {\n    const reader = new FileReader()\n    reader.readAsDataURL(file)\n    reader.onload = () => {\n      resolve(reader.result as string)\n    }\n    reader.onerror = error => {\n      reject(error)\n    }\n  })\n}\n\nconst readBase64WithFetch = (url: string) => {\n  return new Promise<string>((resolve, reject) => {\n    const xhr = new XMLHttpRequest()\n    xhr.onload = () => {\n      const reader = new FileReader()\n      reader.onloadend = () => {\n        resolve(reader.result as string)\n      }\n      reader.onerror = error => {\n        reject(error)\n      }\n      reader.readAsDataURL(xhr.response)\n    }\n    xhr.open('GET', url)\n    xhr.responseType = 'blob'\n    xhr.send()\n  })\n}\n\nexport const readBase64 = (file: File | string) => {\n  return typeof file === 'string' ? readBase64WithFetch(file) : readBase64WithFileReader(file)\n}\n\nexport const readImageElement = (url: string, base64 = false) => {\n  return new Promise<HTMLImageElement>(async (resolve, reject) => {\n    if (base64) url = await readBase64(url)\n    const image = new window.Image()\n    image.onload = () => {\n      resolve(image)\n    }\n    image.onerror = () => {\n      reject('image load error')\n    }\n    image.src = url\n  })\n}\n\ninterface ReadImageFileInfo {\n  url: string\n  file: File\n  width: number\n  height: number\n}\n\nexport const readImageFileInfo = (file: File) => {\n  return new Promise<ReadImageFileInfo | null>(resolve => {\n    const url = URL.createObjectURL(file)\n    readImageElement(url)\n      .then(image => {\n        resolve({\n          width: image.naturalWidth,\n          height: image.naturalHeight,\n          url,\n          file,\n        })\n      })\n      .catch(() => {\n        resolve(null)\n      })\n  })\n}\n\nexport const defaultUpload = (file: File | string) => {\n  return new Promise<string>((resolve, reject) => {\n    if (file instanceof File) {\n      readBase64(file).then(resolve).catch(reject)\n    } else {\n      resolve(file)\n    }\n  })\n}\n\nexport const setPercentage = (editor: Editor, path: Path, percentage: number) => {\n  Transforms.setNodes<Image>(editor, { percentage }, { at: path })\n}\n\nexport const insertImage = (editor: Editor, options: Partial<Image>) => {\n  const image: Image = {\n    type: IMAGE_KEY,\n    ...options,\n    children: [{ text: '' }],\n  }\n\n  Transforms.insertNodes(editor, image)\n  const entry = Editor.above(editor, {\n    match: n => Image.isImage(n),\n  })\n  if (!entry) throw new Error('image not found')\n  return entry[1]\n}\n\nexport const uploadImage = (editor: Editor, path: Path, file: File | string) => {\n  const options = getOptions(editor)\n  const promise = new Promise<void>(resolve => {\n    const pathRef = Editor.pathRef(editor, path)\n\n    const { onUpload = defaultUpload } = options\n    onUpload(file, ({ percentage }) => {\n      const path = pathRef.current\n      if (path) setPercentage(editor, path, percentage)\n    })\n      .then(url => {\n        const path = pathRef.current\n        if (path) Transforms.setNodes<Image>(editor, { url, state: 'done' }, { at: path })\n      })\n      .catch(err => {\n        const path = pathRef.current\n        if (path)\n          Transforms.setNodes<Image>(\n            editor,\n            { state: 'error', errorMessage: typeof err === 'string' ? err : err.message },\n            { at: path },\n          )\n      })\n      .finally(() => {\n        const path = pathRef.unref()\n\n        if (path) setPercentage(editor, path, 100)\n\n        resolve()\n      })\n  })\n  return promise\n}\n\nexport function rotateImgWithCanvas(image: HTMLImageElement, degrees: number): Promise<Blob> {\n  return new Promise((resolve, reject) => {\n    const canvas = document.createElement('canvas')\n    const ctx = canvas.getContext('2d')\n\n    if (!ctx || !image.height || !image.width) return\n    const horizontal = [-270, -90, 90, 270]\n    if (horizontal.includes(degrees)) {\n      canvas.width = image.naturalHeight || 0\n      canvas.height = image.naturalWidth || 0\n    } else {\n      canvas.width = image.naturalWidth || 0\n      canvas.height = image.naturalHeight || 0\n    }\n    ctx.translate(canvas.width / 2, canvas.height / 2)\n    ctx.rotate((degrees * Math.PI) / 180)\n    ctx.drawImage(image, -image.naturalWidth / 2, -image.naturalHeight / 2)\n    canvas.toBlob(blob => {\n      blob ? resolve(blob) : reject('blob is null')\n    }, 'image/jpeg')\n  })\n}\n","import { ImageLocale } from './types'\n\nconst locale: ImageLocale = {\n  locale: 'zh-CN',\n  image: {\n    viewer: {\n      arrowLeft: '',\n      arrowRight: '',\n      arrowLeftDisabled: '',\n      arrowRightDisabled: '',\n      close: '',\n      zoomIn: '',\n      zoomOut: '',\n      oneToOne: '',\n      rotateLeft: '',\n      rotateRight: '',\n      download: '',\n    },\n    style: {\n      title: '',\n      tooltip: '',\n      none: '',\n      stroke: '',\n      shadow: '',\n    },\n  },\n}\n\nexport default locale\n","import { ImageLocale } from './types'\n\nconst locale: ImageLocale = {\n  locale: 'en-US',\n  image: {\n    viewer: {\n      arrowLeft: 'Previous',\n      arrowRight: 'Next',\n      arrowLeftDisabled: 'Already the first one',\n      arrowRightDisabled: 'Already the last one',\n      close: 'Close',\n      zoomIn: 'Zoom in',\n      zoomOut: 'Zoom out',\n      oneToOne: 'Original size',\n      rotateLeft: 'Rotate left',\n      rotateRight: 'Rotate right',\n      download: 'Download',\n    },\n    style: {\n      title: 'Style',\n      tooltip: 'Image style',\n      none: 'None',\n      stroke: 'Stroke',\n      shadow: 'Shadow',\n    },\n  },\n}\n\nexport default locale\n","import zhCN from './zh_CN'\nimport enUS from './en_US'\nimport { ImageLocale } from './types'\n\nconst locales: Record<string, ImageLocale> = {\n  'en-US': enUS,\n  'zh-CN': zhCN,\n}\n\nexport type { ImageLocale }\n\nexport default locales\n","import _styledstyled_components from 'styled-components';\n            const _styled = typeof _styledstyled_components.default === 'undefined' ? _styledstyled_components : _styledstyled_components.default;;\nimport { isTouchDevice } from '@editablejs/editor';\nimport { Icon } from '@editablejs/ui';\nimport React, { useMemo } from 'react';\nimport { PhotoSlider } from 'react-image-previewer';\nimport { useViewer } from '../hooks/use-viewer';\nimport { useViewerIndex } from '../hooks/use-viewer-index';\nimport { useViewerVisible } from '../hooks/use-viewer-visible';\nimport { ViewerToolbar } from './viewer-toolbar';\nexport const ImageViewer = React.memo(() => {\n  const viewer = useViewer();\n  const [visible, setVisible] = useViewerVisible();\n  const [index, setIndex] = useViewerIndex();\n  const images = useMemo(() => {\n    return visible ? viewer.images() : [];\n  }, [visible, viewer]);\n  return <PhotoSlider mode=\"drag\" images={images} visible={visible} index={index} onIndexChange={setIndex} onClose={() => setVisible(false)} loop={true} pullClosable={false} maskOpacity={isTouchDevice ? 1 : 0.9} loadingElement={<_StyledIcon name=\"loading\" />} overlayRender={props => {\n    return <ViewerToolbar {...props} />;\n  }} />;\n});\nImageViewer.displayName = 'ImageViewer';\n\nvar _StyledIcon = _styled(Icon).withConfig({\n  componentId: \"sc-yrs7ly-0\"\n})({\n  \"fontSize\": \"24px\",\n  \"--tw-text-opacity\": \"1\",\n  \"color\": \"rgb(255 255 255 / var(--tw-text-opacity))\"\n});","import { useMemo } from 'react'\nimport { useStore } from 'zustand'\nimport { useViewerStore } from './use-viewer-store'\n\nexport const useViewerIndex = (): [number, (index: number) => void] => {\n  const store = useViewerStore()\n  const index = useStore(store, state => state.index)\n  return useMemo(() => [index, (index: number) => store.setState({ index })], [store, index])\n}\n","import { useEditableStatic } from '@editablejs/editor'\nimport { useMemo } from 'react'\nimport { getViewerStore } from '../store'\n\nexport const useViewerStore = () => {\n  const editor = useEditableStatic()\n  const store = useMemo(() => getViewerStore(editor), [editor])\n  return store\n}\n","import { useMemo } from 'react'\nimport { useStore } from 'zustand'\nimport { useViewerStore } from './use-viewer-store'\n\nexport const useViewerVisible = (): [boolean, (visible: boolean) => void] => {\n  const store = useViewerStore()\n  const visible = useStore(store, state => state.visible)\n  return useMemo(() => {\n    return [visible, (visible: boolean) => store.setState({ visible })]\n  }, [store, visible])\n}\n","import { useLocale } from '@editablejs/editor'\nimport { CloseIcon, Tooltip } from '@editablejs/ui'\nimport { FC } from 'react'\nimport { OverlayRenderProps } from 'react-image-previewer'\nimport {\n  CloseButton,\n  SlideToolbar,\n  DragToolbar,\n  DragArrowLeft,\n  DragArrowRight,\n  DragZoomOut,\n  DragZoomIn,\n  DragOneToOne,\n  DragDownload,\n  DragRotateLeft,\n  DragRotateRight,\n} from 'react-image-previewer/ui'\nimport { IMAGE_KEY } from '../constants'\nimport { ImageLocale } from '../locale'\n\nexport const ViewerToolbar: FC<OverlayRenderProps> = props => {\n  const { mode, index, images, onClose } = props\n  const count = images.length\n  const isFirst = index === 0\n  const isLast = index === count - 1\n\n  const { viewer: viewerLocale } = useLocale<ImageLocale>(IMAGE_KEY)\n\n  if (mode === 'slide') {\n    return (\n      <>\n        <SlideToolbar {...props} />\n        <CloseButton onClick={onClose} />\n      </>\n    )\n  }\n\n  return (\n    <>\n      <DragToolbar\n        {...props}\n        items={[\n          {\n            key: 'arrowLeft',\n            component: props => (\n              <Tooltip content={isFirst ? viewerLocale.arrowLeftDisabled : viewerLocale.arrowLeft}>\n                <a>\n                  <DragArrowLeft {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          'countText',\n          {\n            key: 'arrowRight',\n            component: props => (\n              <Tooltip content={isLast ? viewerLocale.arrowRightDisabled : viewerLocale.arrowRight}>\n                <a>\n                  <DragArrowRight {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          'split',\n          {\n            key: 'zoomOut',\n            component: props => (\n              <Tooltip content={viewerLocale.zoomOut}>\n                <a>\n                  <DragZoomOut {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          'scaleCount',\n          {\n            key: 'zoomIn',\n            component: props => (\n              <Tooltip content={viewerLocale.zoomIn}>\n                <a>\n                  <DragZoomIn {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          {\n            key: 'oneToOne',\n            component: props => (\n              <Tooltip content={viewerLocale.oneToOne}>\n                <a>\n                  <DragOneToOne {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          'split',\n          {\n            key: 'download',\n            component: props => (\n              <Tooltip content={viewerLocale.download}>\n                <a>\n                  <DragDownload {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          'split',\n          {\n            key: 'rotateLeft',\n            component: props => (\n              <Tooltip content={viewerLocale.rotateLeft}>\n                <a>\n                  <DragRotateLeft {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          {\n            key: 'rotateRight',\n            component: props => (\n              <Tooltip content={viewerLocale.rotateRight}>\n                <a>\n                  <DragRotateRight {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n        ]}\n      />\n      <CloseButton onClick={onClose}>\n        <Tooltip content={viewerLocale.close}>\n          <a>\n            <CloseIcon />\n          </a>\n        </Tooltip>\n      </CloseButton>\n    </>\n  )\n}\n","import { Editable, Hotkey } from '@editablejs/editor'\nimport { Editor, Element, Range, Point, Transforms, Text, Path } from '@editablejs/models'\nimport { ImageEditor } from './image-editor'\n\nconst findMatchedRange = (editor: Editor, at: Point) => {\n  const [startText] = Editor.nodes<Text>(editor, {\n    at,\n    match: n => Text.isText(n),\n  })\n  if (!startText) return\n\n  const block = Editor.above(editor, {\n    at,\n    match: n => Element.isElement(n) && Editor.isBlock(editor, n),\n  })\n\n  const path = block ? block[1] : []\n\n  const start = Editor.start(editor, path)\n  const range = { anchor: at, focus: start }\n  const beforeText = Editor.string(editor, range)\n  const reg = /!\\[(.*)\\]\\((.*)\\)$/\n  let match = beforeText.match(reg)\n  if (match && match.length > 1) {\n    const title = match[1]\n    const url = match[2]\n    const matchedTexts = Editor.nodes<Text>(editor, {\n      at: range,\n      match: (n, p) => Text.isText(n) && (n === startText[0] || Path.isBefore(p, startText[1])),\n      reverse: true,\n    })\n    let content = ''\n    for (const [text, path] of matchedTexts) {\n      if (text === startText[0]) {\n        content = text.text.slice(0, at.offset)\n      } else {\n        content = text.text + content\n      }\n      match = content.match(reg)\n      if (match && match.length > 1) {\n        const offset = match.index ?? 0\n        return {\n          title,\n          url,\n          range: { anchor: { path, offset }, focus: at },\n        }\n      }\n    }\n  }\n}\nexport const withShortcuts = (editor: Editable) => {\n  const { onKeydown } = editor\n\n  editor.onKeydown = event => {\n    const { selection } = editor\n    if (\n      selection &&\n      Range.isCollapsed(selection) &&\n      !Editable.isComposing(editor) &&\n      Hotkey.match('space', event)\n    ) {\n      const anchor = Range.start(selection)\n      const match = findMatchedRange(editor, anchor)\n      if (match) {\n        event.preventDefault()\n        const { range, url } = match\n        Transforms.delete(editor, {\n          at: range,\n        })\n        Transforms.collapse(editor)\n        ImageEditor.insert(editor, {\n          file: url,\n        })\n        return\n      }\n    }\n    onKeydown(event)\n  }\n}\n"],"mappings":"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","names":["import_models","import_editor","import_models","import_ui","import_styled_components","import_editor","import_models","import_react","import_editor","import_models","create","image","import_models","path","_styled12styled_components","_styled11styled_components","_styled10styled_components","_styled9styled_components","_styled8styled_components","_styled7styled_components","_styled6styled_components","_styled5styled_components","_styled4styled_components","_styled3styled_components","_styled2styled_components","_styledstyled_components","url","_css","width","height","rotate","locale","import_styled_components","import_editor","import_ui","import_react","import_react","import_zustand","import_editor","import_react","index","import_react","import_zustand","visible","import_editor","import_ui","import_jsx_runtime","props","import_jsx_runtime","_styled","_styledstyled_components","React","_styled","import_editor","import_models","path","import_jsx_runtime"]}
\ No newline at end of file
+{"version":3,"sources":["../src/index.ts","../src/interfaces/image.ts","../src/constants.ts","../src/plugin/image-editor.ts","../src/options.ts","../src/plugin/with-image.tsx","../src/components/image.tsx","../src/hooks/use-viewer.ts","../src/create-viewer.tsx","../src/store/viewer.ts","../src/utils.ts","../src/locale/zh_CN.ts","../src/locale/en_US.ts","../src/locale/index.ts","../src/components/viewer.tsx","../src/hooks/use-viewer-index.ts","../src/hooks/use-viewer-store.ts","../src/hooks/use-viewer-visible.ts","../src/components/viewer-toolbar.tsx","../src/plugin/with-shortcuts.ts"],"sourcesContent":["export type { ImageOptions, ImageHotkey } from './options'\n\nexport type { ImageLocale } from './locale'\n\nexport * from './interfaces/image'\n\nexport * from './plugin/image-editor'\n\nexport * from './plugin/with-image'\n","import { Element } from '@editablejs/models'\nimport { IMAGE_KEY } from '../constants'\n\nexport type ImageState = 'uploading' | 'waitingUpload' | 'done' | 'error'\n\nexport type ImageStyle = 'none' | 'stroke' | 'shadow'\n\nexport interface Image extends Element {\n  type: typeof IMAGE_KEY\n  state?: ImageState\n  width?: number\n  height?: number\n  url?: string\n  percentage?: number\n  errorMessage?: string\n  rotate?: number\n  style?: ImageStyle\n  name?: string\n}\n\nexport const Image = {\n  isImage: (value: any): value is Image => {\n    return Element.isElement(value) && value.type === IMAGE_KEY\n  },\n\n  create: (image: Omit<Image, 'type' | 'children'> = {}): Image => {\n    return {\n      ...image,\n      type: IMAGE_KEY,\n      children: [{ text: '' }],\n    }\n  },\n}\n","export const IMAGE_KEY = 'image'\nexport const DATA_IMAGE_KEY = 'data-image-key'\n","import { Editor } from '@editablejs/models'\nimport { IMAGE_KEY } from '../constants'\nimport { Image, ImageStyle } from '../interfaces/image'\nimport { getOptions } from '../options'\n\nexport interface InsertImageOptions {\n  file: File | string\n}\nexport interface OpenImageOptions extends Omit<InsertImageOptions, 'file'> {\n  accept?: string\n  multiple?: boolean\n}\n\nexport interface ImageEditor extends Editor {\n  openImage: (options?: OpenImageOptions) => void\n\n  insertImage: (options: InsertImageOptions) => Promise<void>\n\n  rotateImage: (rotate: number, image: Image) => void\n\n  setStyleImage: (style: ImageStyle, image: Image) => void\n}\n\nexport const ImageEditor = {\n  isImageEditor: (editor: Editor): editor is ImageEditor => {\n    return !!(editor as ImageEditor).openImage\n  },\n\n  isImage: (editor: Editor, n: any): n is Image => {\n    return Image.isImage(n)\n  },\n\n  isActive: (editor: Editor) => {\n    const elements = Editor.elements(editor)\n    return !!elements[IMAGE_KEY]\n  },\n\n  getOptions,\n\n  open: (editor: Editor, options?: OpenImageOptions) => {\n    if (ImageEditor.isImageEditor(editor)) editor.openImage(options)\n  },\n\n  insert: (editor: Editor, options: InsertImageOptions) => {\n    if (ImageEditor.isImageEditor(editor)) editor.insertImage(options)\n  },\n\n  rotate: (editor: Editor, rotate: number, image: Image) => {\n    if (ImageEditor.isImageEditor(editor)) editor.rotateImage(rotate, image)\n  },\n\n  setStyle: (editor: Editor, style: ImageStyle, image: Image) => {\n    if (ImageEditor.isImageEditor(editor)) editor.setStyleImage(style, image)\n  },\n}\n","import { Editor } from '@editablejs/models'\nimport { ImageLocale } from './locale'\n\nexport type ImageHotkey = string | ((e: KeyboardEvent) => boolean)\n\nexport interface ImageOptions {\n  hotkey?: ImageHotkey\n  shortcuts?: boolean\n  locale?: Record<string, ImageLocale>\n  onBeforeRender?: (url: string) => Promise<string>\n  onUploadBefore?: (files: (File | string)[]) => (File | string)[]\n  onUpload?: (\n    file: File | string,\n    update: (options: Record<'percentage', number>) => void,\n  ) => Promise<string>\n  onRotate?: (file: File) => Promise<string | { url: string; rotate?: number }>\n  allowRotate?: boolean\n}\nconst IMAGE_OPTIONS = new WeakMap<Editor, ImageOptions>()\n\nexport const getOptions = (editor: Editor): ImageOptions => {\n  return IMAGE_OPTIONS.get(editor) ?? {}\n}\n\nexport const setOptions = (editor: Editor, options: ImageOptions) => {\n  IMAGE_OPTIONS.set(editor, options)\n}\n","import { Editable, Hotkey, Locale, Slot } from '@editablejs/editor'\nimport { Editor, Operation, Transforms } from '@editablejs/models'\nimport { withHistoryProtocol } from '@editablejs/protocols/history'\nimport { openFileDialog } from '@editablejs/ui'\nimport { setOptions, ImageHotkey, ImageOptions } from '../options'\nimport { Image } from '../interfaces/image'\nimport { ImageComponent } from '../components/image'\nimport { ImageEditor } from './image-editor'\nimport locale from '../locale'\nimport {\n  insertImage,\n  readImageFileInfo,\n  uploadImage,\n  rotateImgWithCanvas,\n  readImageElement,\n} from '../utils'\nimport { ImageViewer } from '../components/viewer'\nimport { withShortcuts } from './with-shortcuts'\n\nconst defaultHotkey: ImageHotkey = ''\n\nconst defaultBeforeUpload = (files: File[]) => {\n  return files.filter(file => file.type.startsWith('image/'))\n}\n\nexport const withImage = <T extends Editable>(editor: T, options: ImageOptions = {}) => {\n  const newEditor = editor as T & ImageEditor\n\n  setOptions(newEditor, options)\n\n  const { isInline, isVoid } = newEditor\n  const historyProtocol = withHistoryProtocol(newEditor)\n  const { capture } = historyProtocol\n\n  historyProtocol.capture = (op: Operation) => {\n    if (op.type === 'set_node') {\n      const { path, newProperties } = op\n      if (Editor.hasPath(editor, path)) {\n        const image = Editor.node(editor, path)\n        if (Image.isImage(image[0])) {\n          const prop = newProperties as Partial<Image>\n          if (prop.url || prop.state || prop.percentage) {\n            return false\n          }\n        }\n      }\n    }\n    return capture(op)\n  }\n\n  const { locale: localeOptions = {} } = options\n  Locale.setLocale(newEditor, locale, localeOptions)\n\n  Slot.mount(newEditor, ImageViewer)\n\n  newEditor.isInline = element => {\n    return ImageEditor.isImage(newEditor, element) || isInline(element)\n  }\n\n  newEditor.isVoid = element => {\n    return ImageEditor.isImage(newEditor, element) || isVoid(element)\n  }\n\n  const insertImages = (files: (File | string)[]) => {\n    Promise.all(\n      files.map(file =>\n        typeof file === 'string' ? Promise.resolve(file) : readImageFileInfo(file),\n      ),\n    ).then(items => {\n      items.forEach(item => {\n        if (!item) return\n        if (typeof item === 'string') return newEditor.insertImage({ file: item })\n        const { url, file, width, height } = item\n        const path = insertImage(newEditor, {\n          url,\n          width,\n          height,\n          name: file.name,\n          state: 'uploading',\n        })\n        uploadImage(editor, path, file).then(() => {\n          URL.revokeObjectURL(url)\n        })\n      })\n    })\n  }\n  const { onUploadBefore = defaultBeforeUpload } = options\n\n  newEditor.openImage = ({ accept = 'image/*', multiple = false } = {}) => {\n    if (!newEditor.selection) {\n      newEditor.focus(false)\n    }\n\n    openFileDialog({\n      accept,\n      multiple,\n      onChange: files => {\n        const customFiles = onUploadBefore(files)\n        if (customFiles.length > 0) insertImages(files)\n      },\n    })\n  }\n\n  newEditor.insertImage = async ({ file }) => {\n    if (!newEditor.selection) {\n      newEditor.focus(false)\n    }\n\n    const url = file instanceof File ? URL.createObjectURL(file) : file\n    editor.normalizeSelection(selection => {\n      if (editor.selection !== selection) editor.selection = selection\n      const path = insertImage(editor, {\n        url,\n        state: 'uploading',\n      })\n\n      return uploadImage(editor, path, file)\n    })\n  }\n\n  newEditor.rotateImage = (rotate, image) => {\n    const { onRotate, allowRotate } = options\n    const { url, state } = image\n    if (state !== 'done') return\n    const degrees = rotate % -360\n    if (onRotate && url && allowRotate !== false) {\n      readImageElement(url, true).then(img => {\n        rotateImgWithCanvas(img, degrees).then(blob => {\n          const file = new File([blob], image.name ?? 'rotate.png', { type: 'image/png' })\n          onRotate(file).then(res => {\n            if (res) {\n              const info = typeof res === 'string' ? { url: res, rotate: 0 } : res\n              Transforms.setNodes<Image>(\n                editor,\n                {\n                  rotate: info.rotate,\n                  url: info.url,\n                },\n                {\n                  at: Editable.findPath(editor, image),\n                },\n              )\n            }\n          })\n        })\n      })\n    }\n    Transforms.setNodes<Image>(\n      editor,\n      {\n        rotate,\n      },\n      {\n        at: Editable.findPath(editor, image),\n      },\n    )\n  }\n\n  newEditor.setStyleImage = (style, image) => {\n    Transforms.setNodes<Image>(\n      editor,\n      {\n        style,\n      },\n      {\n        at: Editable.findPath(editor, image),\n      },\n    )\n  }\n\n  const { renderElement } = newEditor\n  newEditor.renderElement = ({ element, attributes, children }) => {\n    if (ImageEditor.isImage(editor, element)) {\n      return (\n        <ImageComponent {...attributes} element={element} editor={newEditor}>\n          {children}\n        </ImageComponent>\n      )\n    }\n    return renderElement({ attributes, children, element })\n  }\n\n  const hotkey = options.hotkey ?? defaultHotkey\n  const { onKeydown, insertFile } = newEditor\n  newEditor.onKeydown = (e: KeyboardEvent) => {\n    if (Hotkey.match(hotkey, e)) {\n      e.preventDefault()\n      newEditor.openImage()\n      return\n    }\n\n    onKeydown(e)\n  }\n\n  newEditor.insertFile = (file, at) => {\n    const customFiles = onUploadBefore([file])\n    if (customFiles.length > 0) {\n      if (at) {\n        Transforms.select(newEditor, at)\n      }\n      insertImages(customFiles)\n      return\n    }\n    insertFile(file, at)\n  }\n\n  const { shortcuts } = options\n  if (shortcuts !== false) {\n    withShortcuts(newEditor)\n  }\n  return newEditor\n}\n","import _styled12styled_components from 'styled-components';\n            const _styled12 = typeof _styled12styled_components.default === 'undefined' ? _styled12styled_components : _styled12styled_components.default;;\nimport _styled11styled_components from 'styled-components';\n            const _styled11 = typeof _styled11styled_components.default === 'undefined' ? _styled11styled_components : _styled11styled_components.default;;\nimport _styled10styled_components from 'styled-components';\n            const _styled10 = typeof _styled10styled_components.default === 'undefined' ? _styled10styled_components : _styled10styled_components.default;;\nimport _styled9styled_components from 'styled-components';\n            const _styled9 = typeof _styled9styled_components.default === 'undefined' ? _styled9styled_components : _styled9styled_components.default;;\nimport _styled8styled_components from 'styled-components';\n            const _styled8 = typeof _styled8styled_components.default === 'undefined' ? _styled8styled_components : _styled8styled_components.default;;\nimport _styled7styled_components from 'styled-components';\n            const _styled7 = typeof _styled7styled_components.default === 'undefined' ? _styled7styled_components : _styled7styled_components.default;;\nimport _styled6styled_components from 'styled-components';\n            const _styled6 = typeof _styled6styled_components.default === 'undefined' ? _styled6styled_components : _styled6styled_components.default;;\nimport _styled5styled_components from 'styled-components';\n            const _styled5 = typeof _styled5styled_components.default === 'undefined' ? _styled5styled_components : _styled5styled_components.default;;\nimport _styled4styled_components from 'styled-components';\n            const _styled4 = typeof _styled4styled_components.default === 'undefined' ? _styled4styled_components : _styled4styled_components.default;;\nimport _styled3styled_components from 'styled-components';\n            const _styled3 = typeof _styled3styled_components.default === 'undefined' ? _styled3styled_components : _styled3styled_components.default;;\nimport _styled2styled_components from 'styled-components';\n            const _styled2 = typeof _styled2styled_components.default === 'undefined' ? _styled2styled_components : _styled2styled_components.default;;\nimport _styledstyled_components from 'styled-components';\n            const _styled = typeof _styledstyled_components.default === 'undefined' ? _styledstyled_components : _styledstyled_components.default;;\nimport { css as _css } from \"styled-components\";\nimport { Editable, useLocale, useNodeFocused, useReadOnly } from '@editablejs/editor';\nimport { Editor, Transforms } from '@editablejs/models';\nimport { Icon, Popover, PopoverContent, PopoverTrigger, Resizer, Toolbar, ToolbarButton, ToolbarDropdown, Tooltip, useIsomorphicLayoutEffect } from '@editablejs/ui';\nimport React, { forwardRef, useEffect, useMemo, useRef, useState } from 'react';\nimport { DATA_IMAGE_KEY } from '../constants';\nimport { useViewer } from '../hooks/use-viewer';\nimport { getOptions } from '../options';\nimport { readImageElement, rotateImgWithCanvas, uploadImage } from '../utils';\nexport const ImageComponent = forwardRef(({\n  children,\n  element,\n  editor,\n  ...props\n}, ref) => {\n  const {\n    url,\n    state,\n    rotate,\n    errorMessage,\n    percentage,\n    width,\n    height\n  } = element;\n  const [errorMsg, setErrorMsg] = useState(errorMessage);\n  const [loading, setLoading] = useState(true);\n  const [loaded, setLoaded] = useState(false);\n  const [src, setSrc] = useState('');\n  const [rotatedUrl, setRotatedUrl] = useState('');\n  const [imageDOMElement, setImageDOMElement] = useState(null);\n  const [readOnly] = useReadOnly();\n  const options = useMemo(() => {\n    return getOptions(editor);\n  }, [editor]);\n  const viewer = useViewer();\n  useIsomorphicLayoutEffect(() => {\n    if (options.onBeforeRender && url && state === 'done') {\n      options.onBeforeRender(url).then(url => {\n        setSrc(url);\n      }).catch(err => {\n        setErrorMsg(err.message);\n      }).finally(() => {\n        setLoading(false);\n      });\n    } else if (url && state === 'waitingUpload') {\n      uploadImage(editor, Editable.findPath(editor, element), url);\n    } else if (url) {\n      setSrc(url);\n      setLoading(false);\n    }\n  }, [url, state]);\n  useIsomorphicLayoutEffect(() => {\n    if (src) {\n      readImageElement(src).then(image => {\n        setLoaded(true);\n        setImageDOMElement(image);\n      }).catch(err => {\n        if (state === 'done') setErrorMsg(typeof err === 'object' ? err.message : err);\n      });\n    }\n  }, [src, state]);\n  useEffect(() => {\n    if (!imageDOMElement) {\n      return setRotatedUrl('');\n    }\n\n    if (rotate !== undefined && loaded && state === 'done' && options.allowRotate !== false) {\n      readImageElement(imageDOMElement.src, true).then(img => {\n        rotateImgWithCanvas(img, rotate).then(blob => {\n          setRotatedUrl(URL.createObjectURL(blob));\n        });\n      });\n    }\n  }, [imageDOMElement, rotate, state, loaded, options.allowRotate]);\n  useEffect(() => {\n    return () => {\n      if (rotatedUrl) {\n        URL.revokeObjectURL(rotatedUrl);\n      }\n    };\n  }, [rotatedUrl]);\n  const [maxWidth, setMaxWidth] = useState(0);\n  useEffect(() => {\n    const path = Editable.findPath(editor, element);\n    const parentEntry = Editor.above(editor, {\n      at: path,\n      match: n => Editor.isBlock(editor, n),\n      mode: 'lowest'\n    });\n\n    if (parentEntry) {\n      const parentEl = Editable.toDOMNode(editor, parentEntry[0]);\n      setMaxWidth(parentEl.clientWidth);\n    }\n  }, [editor, element]);\n  const focused = useNodeFocused();\n  const isUploading = state === 'uploading' || state === 'waitingUpload';\n\n  const renderUploading = () => {\n    if (!isUploading) return null;\n    return <_StyledDiv>\n          {percentage !== undefined && <_StyledDiv2 $_css2={[{\n        \"position\": \"relative\",\n        \"height\": \"0.5rem\",\n        \"width\": \"33.333333%\",\n        \"overflow\": \"hidden\",\n        \"borderRadius\": \"0.25rem\",\n        \"backgroundColor\": \"rgb(156 163 175 / 0.3)\"\n      }, _css([\"min-width:8px;\"])]}>\n              <_StyledDiv3 style={{\n          width: `${percentage}%`\n        }}></_StyledDiv3>\n            </_StyledDiv2>}\n          {percentage === undefined && <Icon name=\"loading\" />}\n        </_StyledDiv>;\n  };\n\n  const renderLoading = () => {\n    if (!loading || loaded) return null;\n    return <_StyledDiv4>\n          <Icon name=\"loading\" />\n        </_StyledDiv4>;\n  };\n\n  const isError = state === 'error' || !!errorMsg;\n\n  const renderError = () => {\n    if (!isError) return null;\n    return <_StyledSpan>\n          <span>{errorMsg || 'Image error.'}</span>\n        </_StyledSpan>;\n  };\n\n  const renderImage = () => {\n    if (isError || !src || !loaded) return null;\n    const atts = {\n      [DATA_IMAGE_KEY]: Editable.findKey(editor, element).id\n    };\n    return <_StyledImg {...atts} alt=\"\" draggable={false} src={rotatedUrl || src} $_css3={[{\n      \"display\": \"inline-block\",\n      \"height\": \"100%\",\n      \"width\": \"100%\",\n      \"borderRadius\": \"0.25rem\",\n      \"verticalAlign\": \"baseline\"\n    }, isUploading && {\n      \"opacity\": \"0.3\"\n    }]} />;\n  };\n\n  const handleResizeChange = (width, height) => {\n    Transforms.setNodes(editor, {\n      width,\n      height\n    }, {\n      at: Editable.findPath(editor, element)\n    });\n  };\n\n  const isFocusedMouseDownBefore = useRef(false);\n\n  const handleImageDown = () => {\n    isFocusedMouseDownBefore.current = focused;\n  };\n\n  const handleImageClick = event => {\n    if (isFocusedMouseDownBefore.current && !event.defaultPrevented && isDone && loaded) {\n      viewer.open(element);\n    }\n  };\n\n  const renderStyleStroke = () => {\n    if (element.style !== 'stroke') return null;\n    return <_StyledDiv5 />;\n  };\n\n  const changeStyle = style => {\n    editor.setStyleImage(style, element);\n  };\n\n  const changeRotate = rotate => {\n    if (Math.abs(rotate) === 360) {\n      rotate = 0;\n    }\n\n    editor.rotateImage(rotate, element);\n  };\n\n  const isDone = state === 'done';\n  const autoSize = useMemo(() => {\n    if (height === undefined || width === undefined) return undefined;\n    const ratio = height / width;\n\n    if (width > maxWidth && maxWidth > 0) {\n      return [maxWidth, maxWidth * ratio];\n    }\n\n    return [width, height];\n  }, [width, height, loaded, maxWidth]);\n  const size = autoSize || [width, height];\n  const [popoverOpen, setPopoverOpen] = useState(false);\n\n  const handlePopoverOpenChange = open => {\n    if (focused) {\n      setPopoverOpen(true);\n    } else {\n      setPopoverOpen(open);\n    }\n  };\n\n  useIsomorphicLayoutEffect(() => {\n    setPopoverOpen(focused);\n  }, [focused]);\n  const {\n    style: styleLocale,\n    viewer: viewerLocale\n  } = useLocale('image');\n  return <Popover open={isDone && !readOnly ? popoverOpen : false} onOpenChange={handlePopoverOpenChange} trigger=\"hover\">\n        <PopoverTrigger asChild>\n          <_StyledDiv6 {...props} ref={ref} $_css4={[{\n        \"position\": \"relative\",\n        \"display\": \"inline-block\",\n        \"maxWidth\": \"100%\",\n        \"cursor\": \"default\",\n        \"borderRadius\": \"0.25rem\",\n        \"borderWidth\": \"1px\",\n        \"borderColor\": \"transparent\",\n        \"lineHeight\": \"0\"\n      }, element.style === 'shadow' && {\n        \"--tw-shadow\": \"0 2px 6px 2px rgb(60 64 67 / 15%)\",\n        \"--tw-shadow-colored\": \"0 2px 6px 2px var(--tw-shadow-color)\",\n        \"boxShadow\": \"var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)\"\n      }, focused && isDone && {\n        \"cursor\": \"zoom-in\"\n      }, !loaded && {\n        \"--tw-bg-opacity\": \"1\",\n        \"backgroundColor\": \"rgb(243 244 246 / var(--tw-bg-opacity))\"\n      }, !focused && isDone && popoverOpen && {\n        \"--tw-border-opacity\": \"1\",\n        \"borderColor\": \"rgb(64 150 255 / var(--tw-border-opacity))\"\n      }, (loading || isUploading || isError) && {\n        \"lineHeight\": \"inherit\"\n      }]}>\n            <_StyledDiv7 style={{\n          width: isError ? undefined : size[0] || 'auto',\n          height: loaded || isError ? undefined : size[1] || 'auto'\n        }}>\n              <_StyledDiv8 style={{\n            width: '100%'\n          }} onMouseDown={handleImageDown} onClick={handleImageClick}>\n                {renderImage()}\n                {renderStyleStroke()}\n                <_StyledDiv9>{children}</_StyledDiv9>\n                {renderUploading()}\n                {renderError()}\n                {renderLoading()}\n              </_StyledDiv8>\n              {focused && !readOnly && !isError && <_StyledResizer onChange={handleResizeChange} previewImage={isDone && loaded ? rotatedUrl || src : undefined} holders={isDone ? undefined : []} />}\n            </_StyledDiv7>\n          </_StyledDiv6>\n        </PopoverTrigger>\n        <PopoverContent autoUpdate={true} side=\"top\" sideOffset={5}>\n          <Toolbar mode=\"inline\">\n            {options.allowRotate !== false && <Tooltip content={viewerLocale.rotateLeft} side=\"top\" sideOffset={5} arrow={false}>\n                <ToolbarButton icon={<Icon name=\"rotateLeft\" />} onToggle={() => changeRotate((rotate ?? 0) - 90)} />\n              </Tooltip>}\n            <Tooltip content={styleLocale.tooltip} side=\"top\" sideOffset={5} arrow={false}>\n              <ToolbarDropdown onSelect={value => changeStyle(value)} value={element.style || 'none'} items={[{\n            value: 'none',\n            content: styleLocale.none\n          }, {\n            value: 'stroke',\n            content: styleLocale.stroke\n          }, {\n            value: 'shadow',\n            content: styleLocale.shadow\n          }]}>\n                {styleLocale.title}\n              </ToolbarDropdown>\n            </Tooltip>\n          </Toolbar>\n        </PopoverContent>\n      </Popover>;\n});\nImageComponent.displayName = 'ImageComponent';\n\nvar _StyledDiv = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-0\"\n})({\n  \"position\": \"absolute\",\n  \"left\": \"0px\",\n  \"top\": \"0px\",\n  \"display\": \"flex\",\n  \"height\": \"100%\",\n  \"width\": \"100%\",\n  \"alignItems\": \"center\",\n  \"justifyContent\": \"center\",\n  \"--tw-text-opacity\": \"1\",\n  \"color\": \"rgb(64 150 255 / var(--tw-text-opacity))\"\n});\n\nvar _StyledDiv2 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-1\"\n})([\"\", \"\"], p => p.$_css2);\n\nvar _StyledDiv3 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-2\"\n})({\n  \"position\": \"absolute\",\n  \"left\": \"0px\",\n  \"top\": \"0px\",\n  \"height\": \"100%\",\n  \"@keyframes pulse\": {\n    \"50%\": {\n      \"opacity\": \".5\"\n    }\n  },\n  \"animation\": \"pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite\",\n  \"--tw-bg-opacity\": \"1\",\n  \"backgroundColor\": \"rgb(64 150 255 / var(--tw-bg-opacity))\"\n});\n\nvar _StyledDiv4 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-3\"\n})({\n  \"position\": \"absolute\",\n  \"left\": \"0px\",\n  \"top\": \"0px\",\n  \"display\": \"flex\",\n  \"height\": \"100%\",\n  \"width\": \"100%\",\n  \"alignItems\": \"center\",\n  \"justifyContent\": \"center\",\n  \"--tw-text-opacity\": \"1\",\n  \"color\": \"rgb(64 150 255 / var(--tw-text-opacity))\"\n});\n\nvar _StyledSpan = _styled(\"span\").withConfig({\n  componentId: \"sc-1385wrh-4\"\n})({\n  \"borderRadius\": \"0.25rem\",\n  \"borderWidth\": \"1px\",\n  \"--tw-border-opacity\": \"1\",\n  \"borderColor\": \"rgb(209 213 219 / var(--tw-border-opacity))\",\n  \"paddingLeft\": \"0.5rem\",\n  \"paddingRight\": \"0.5rem\",\n  \"paddingTop\": \"0.125rem\",\n  \"paddingBottom\": \"0.125rem\",\n  \"verticalAlign\": \"baseline\",\n  \"fontSize\": \"12px\",\n  \"--tw-text-opacity\": \"1\",\n  \"color\": \"rgb(239 68 68 / var(--tw-text-opacity))\"\n});\n\nvar _StyledImg = _styled(\"img\").withConfig({\n  componentId: \"sc-1385wrh-5\"\n})([\"\", \"\"], p => p.$_css3);\n\nvar _StyledDiv5 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-6\"\n})({\n  \"pointerEvents\": \"none\",\n  \"position\": \"absolute\",\n  \"top\": \"0px\",\n  \"right\": \"0px\",\n  \"bottom\": \"0px\",\n  \"left\": \"0px\",\n  \"height\": \"100%\",\n  \"width\": \"100%\",\n  \"borderRadius\": \"0.25rem\",\n  \"borderWidth\": \"1px\",\n  \"--tw-border-opacity\": \"1\",\n  \"borderColor\": \"rgb(209 213 219 / var(--tw-border-opacity))\"\n});\n\nvar _StyledDiv6 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-7\"\n})([\"\", \"\"], p => p.$_css4);\n\nvar _StyledDiv7 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-8\"\n})({\n  \"display\": \"inline-block\",\n  \"height\": \"auto\",\n  \"minHeight\": \"24px\",\n  \"minWidth\": \"24px\",\n  \"maxWidth\": \"100%\"\n});\n\nvar _StyledDiv8 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-9\"\n})({\n  \"display\": \"inline-block\",\n  \"maxWidth\": \"100%\"\n});\n\nvar _StyledDiv9 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-10\"\n})({\n  \"position\": \"absolute\",\n  \"display\": \"none\"\n});\n\nvar _StyledResizer = _styled(Resizer).withConfig({\n  componentId: \"sc-1385wrh-11\"\n})({\n  \"borderRadius\": \"0.25rem\"\n});","import { useEditableStatic } from '@editablejs/editor'\nimport { useMemo } from 'react'\nimport { getViewer } from '../create-viewer'\n\nexport const useViewer = () => {\n  const editor = useEditableStatic()\n\n  return useMemo(() => getViewer(editor), [editor])\n}\n","import { Editable } from '@editablejs/editor'\nimport { Editor } from '@editablejs/models'\nimport { DataType } from 'react-image-previewer'\nimport { DATA_IMAGE_KEY } from './constants'\nimport { Image } from './interfaces/image'\nimport { getViewerStore } from './store'\n\nconst IMAGES_CACHE_WEAKMAP = new WeakMap<Editor, DataType[]>()\n\nconst findImages = (editor: Editable, force = false) => {\n  const caches = IMAGES_CACHE_WEAKMAP.get(editor)\n  if (caches && !force) return caches\n  const images: DataType[] = []\n  const nodes = Editor.nodes(editor, {\n    at: [],\n    match: node => Image.isImage(node) && !!node.url,\n  })\n\n  for (const [node] of nodes) {\n    const key = Editable.findKey(editor, node).id\n    const el = Editable.toDOMNode(editor, node)\n    const image = el.querySelector(`img[${DATA_IMAGE_KEY}=\"${key}\"]`)\n    if (!image) continue\n    const src = image.getAttribute('src')\n    if (!src) continue\n    images.push({\n      key,\n      src,\n    })\n  }\n  IMAGES_CACHE_WEAKMAP.set(editor, images)\n  return images\n}\n\nexport const VIEWER_CACHE_WEAKMAP = new WeakMap<Editor, ReturnType<typeof createViewer>>()\n\nconst createViewer = (editor: Editable) => {\n  const viewer = {\n    images: (force = false) => findImages(editor, force),\n\n    count: () => {\n      return viewer.images().length\n    },\n\n    open: (image: Image) => {\n      const store = getViewerStore(editor)\n      const images = viewer.images(true)\n      const key = Editable.findKey(editor, image).id\n      return store.setState({\n        visible: true,\n        index: images.findIndex(image => image.key === key),\n      })\n    },\n\n    close: () => {\n      const store = getViewerStore(editor)\n      store.setState({\n        visible: false,\n        index: -1,\n      })\n    },\n\n    prev: () => {\n      const store = getViewerStore(editor)\n      const count = viewer.count()\n      const index = store.getState().index\n      let val = index - 1\n      if (val < 0) val = count - 1\n      store.setState({\n        index: val,\n      })\n    },\n\n    next: () => {\n      const store = getViewerStore(editor)\n      const count = viewer.count()\n      const index = store.getState().index\n      let val = index + 1\n      if (val === count) val = 0\n      store.setState({\n        index: val,\n      })\n    },\n  }\n  return viewer\n}\n\nexport const getViewer = (editor: Editable) => {\n  let viewer = VIEWER_CACHE_WEAKMAP.get(editor)\n  if (viewer) {\n    return viewer\n  }\n  viewer = createViewer(editor)\n  VIEWER_CACHE_WEAKMAP.set(editor, viewer)\n  return viewer\n}\n","import { Editor } from '@editablejs/models'\nimport create, { StoreApi, UseBoundStore } from 'zustand'\nexport interface ImageViewerStore {\n  visible: boolean\n  index: number\n}\n\nconst EDITOR_TO_IMAGE_STORE = new WeakMap<Editor, UseBoundStore<StoreApi<ImageViewerStore>>>()\n\nexport const getViewerStore = (editor: Editor) => {\n  let store = EDITOR_TO_IMAGE_STORE.get(editor)\n  if (!store) {\n    store = create<ImageViewerStore>(() => ({\n      visible: false,\n      index: 0,\n    }))\n    EDITOR_TO_IMAGE_STORE.set(editor, store)\n  }\n  return store\n}\n","import { Editor, Path, Transforms } from '@editablejs/models'\nimport { IMAGE_KEY } from './constants'\nimport { Image } from './interfaces/image'\nimport { getOptions } from './options'\n\nconst readBase64WithFileReader = (file: File) => {\n  return new Promise<string>((resolve, reject) => {\n    const reader = new FileReader()\n    reader.readAsDataURL(file)\n    reader.onload = () => {\n      resolve(reader.result as string)\n    }\n    reader.onerror = error => {\n      reject(error)\n    }\n  })\n}\n\nconst readBase64WithFetch = (url: string) => {\n  return new Promise<string>((resolve, reject) => {\n    const xhr = new XMLHttpRequest()\n    xhr.onload = () => {\n      const reader = new FileReader()\n      reader.onloadend = () => {\n        resolve(reader.result as string)\n      }\n      reader.onerror = error => {\n        reject(error)\n      }\n      reader.readAsDataURL(xhr.response)\n    }\n    xhr.open('GET', url)\n    xhr.responseType = 'blob'\n    xhr.send()\n  })\n}\n\nexport const readBase64 = (file: File | string) => {\n  return typeof file === 'string' ? readBase64WithFetch(file) : readBase64WithFileReader(file)\n}\n\nexport const readImageElement = (url: string, base64 = false) => {\n  return new Promise<HTMLImageElement>(async (resolve, reject) => {\n    if (base64) url = await readBase64(url)\n    const image = new window.Image()\n    image.onload = () => {\n      resolve(image)\n    }\n    image.onerror = () => {\n      reject('image load error')\n    }\n    image.src = url\n  })\n}\n\ninterface ReadImageFileInfo {\n  url: string\n  file: File\n  width: number\n  height: number\n}\n\nexport const readImageFileInfo = (file: File) => {\n  return new Promise<ReadImageFileInfo | null>(resolve => {\n    const url = URL.createObjectURL(file)\n    readImageElement(url)\n      .then(image => {\n        resolve({\n          width: image.naturalWidth,\n          height: image.naturalHeight,\n          url,\n          file,\n        })\n      })\n      .catch(() => {\n        resolve(null)\n      })\n  })\n}\n\nexport const defaultUpload = (file: File | string) => {\n  return new Promise<string>((resolve, reject) => {\n    if (file instanceof File) {\n      readBase64(file).then(resolve).catch(reject)\n    } else {\n      resolve(file)\n    }\n  })\n}\n\nexport const setPercentage = (editor: Editor, path: Path, percentage: number) => {\n  Transforms.setNodes<Image>(editor, { percentage }, { at: path })\n}\n\nexport const insertImage = (editor: Editor, options: Partial<Image>) => {\n  const image: Image = {\n    type: IMAGE_KEY,\n    ...options,\n    children: [{ text: '' }],\n  }\n\n  Transforms.insertNodes(editor, image)\n  const entry = Editor.above(editor, {\n    match: n => Image.isImage(n),\n  })\n  if (!entry) throw new Error('image not found')\n  return entry[1]\n}\n\nexport const uploadImage = (editor: Editor, path: Path, file: File | string) => {\n  const options = getOptions(editor)\n  const promise = new Promise<void>(resolve => {\n    const pathRef = Editor.pathRef(editor, path)\n\n    const { onUpload = defaultUpload } = options\n    onUpload(file, ({ percentage }) => {\n      const path = pathRef.current\n      if (path) setPercentage(editor, path, percentage)\n    })\n      .then(url => {\n        const path = pathRef.current\n        if (path) Transforms.setNodes<Image>(editor, { url, state: 'done' }, { at: path })\n      })\n      .catch(err => {\n        const path = pathRef.current\n        if (path)\n          Transforms.setNodes<Image>(\n            editor,\n            { state: 'error', errorMessage: typeof err === 'string' ? err : err.message },\n            { at: path },\n          )\n      })\n      .finally(() => {\n        const path = pathRef.unref()\n\n        if (path) setPercentage(editor, path, 100)\n\n        resolve()\n      })\n  })\n  return promise\n}\n\nexport function rotateImgWithCanvas(image: HTMLImageElement, degrees: number): Promise<Blob> {\n  return new Promise((resolve, reject) => {\n    const canvas = document.createElement('canvas')\n    const ctx = canvas.getContext('2d')\n\n    if (!ctx || !image.height || !image.width) return\n    const horizontal = [-270, -90, 90, 270]\n    if (horizontal.includes(degrees)) {\n      canvas.width = image.naturalHeight || 0\n      canvas.height = image.naturalWidth || 0\n    } else {\n      canvas.width = image.naturalWidth || 0\n      canvas.height = image.naturalHeight || 0\n    }\n    ctx.translate(canvas.width / 2, canvas.height / 2)\n    ctx.rotate((degrees * Math.PI) / 180)\n    ctx.drawImage(image, -image.naturalWidth / 2, -image.naturalHeight / 2)\n    canvas.toBlob(blob => {\n      blob ? resolve(blob) : reject('blob is null')\n    }, 'image/jpeg')\n  })\n}\n","import { ImageLocale } from './types'\n\nconst locale: ImageLocale = {\n  locale: 'zh-CN',\n  image: {\n    viewer: {\n      arrowLeft: '',\n      arrowRight: '',\n      arrowLeftDisabled: '',\n      arrowRightDisabled: '',\n      close: '',\n      zoomIn: '',\n      zoomOut: '',\n      oneToOne: '',\n      rotateLeft: '',\n      rotateRight: '',\n      download: '',\n    },\n    style: {\n      title: '',\n      tooltip: '',\n      none: '',\n      stroke: '',\n      shadow: '',\n    },\n  },\n}\n\nexport default locale\n","import { ImageLocale } from './types'\n\nconst locale: ImageLocale = {\n  locale: 'en-US',\n  image: {\n    viewer: {\n      arrowLeft: 'Previous',\n      arrowRight: 'Next',\n      arrowLeftDisabled: 'Already the first one',\n      arrowRightDisabled: 'Already the last one',\n      close: 'Close',\n      zoomIn: 'Zoom in',\n      zoomOut: 'Zoom out',\n      oneToOne: 'Original size',\n      rotateLeft: 'Rotate left',\n      rotateRight: 'Rotate right',\n      download: 'Download',\n    },\n    style: {\n      title: 'Style',\n      tooltip: 'Image style',\n      none: 'None',\n      stroke: 'Stroke',\n      shadow: 'Shadow',\n    },\n  },\n}\n\nexport default locale\n","import zhCN from './zh_CN'\nimport enUS from './en_US'\nimport { ImageLocale } from './types'\n\nconst locales: Record<string, ImageLocale> = {\n  'en-US': enUS,\n  'zh-CN': zhCN,\n}\n\nexport type { ImageLocale }\n\nexport default locales\n","import _styledstyled_components from 'styled-components';\n            const _styled = typeof _styledstyled_components.default === 'undefined' ? _styledstyled_components : _styledstyled_components.default;;\nimport { isTouchDevice } from '@editablejs/editor';\nimport { Icon } from '@editablejs/ui';\nimport React, { useMemo } from 'react';\nimport { PhotoSlider } from 'react-image-previewer';\nimport { useViewer } from '../hooks/use-viewer';\nimport { useViewerIndex } from '../hooks/use-viewer-index';\nimport { useViewerVisible } from '../hooks/use-viewer-visible';\nimport { ViewerToolbar } from './viewer-toolbar';\nexport const ImageViewer = React.memo(() => {\n  const viewer = useViewer();\n  const [visible, setVisible] = useViewerVisible();\n  const [index, setIndex] = useViewerIndex();\n  const images = useMemo(() => {\n    return visible ? viewer.images() : [];\n  }, [visible, viewer]);\n  return <PhotoSlider mode=\"drag\" className='image-dialog' images={images} visible={visible} index={index} onIndexChange={setIndex} onClose={() => setVisible(false)} loop={true} pullClosable={false} maskOpacity={isTouchDevice ? 1 : 0.9} loadingElement={<_StyledIcon name=\"loading\" />} overlayRender={props => {\n    return <ViewerToolbar {...props} />;\n  }} />;\n});\nImageViewer.displayName = 'ImageViewer';\n\nvar _StyledIcon = _styled(Icon).withConfig({\n  componentId: \"sc-yrs7ly-0\"\n})({\n  \"fontSize\": \"24px\",\n  \"--tw-text-opacity\": \"1\",\n  \"color\": \"rgb(255 255 255 / var(--tw-text-opacity))\"\n});","import { useMemo } from 'react'\nimport { useStore } from 'zustand'\nimport { useViewerStore } from './use-viewer-store'\n\nexport const useViewerIndex = (): [number, (index: number) => void] => {\n  const store = useViewerStore()\n  const index = useStore(store, state => state.index)\n  return useMemo(() => [index, (index: number) => store.setState({ index })], [store, index])\n}\n","import { useEditableStatic } from '@editablejs/editor'\nimport { useMemo } from 'react'\nimport { getViewerStore } from '../store'\n\nexport const useViewerStore = () => {\n  const editor = useEditableStatic()\n  const store = useMemo(() => getViewerStore(editor), [editor])\n  return store\n}\n","import { useMemo } from 'react'\nimport { useStore } from 'zustand'\nimport { useViewerStore } from './use-viewer-store'\n\nexport const useViewerVisible = (): [boolean, (visible: boolean) => void] => {\n  const store = useViewerStore()\n  const visible = useStore(store, state => state.visible)\n  return useMemo(() => {\n    return [visible, (visible: boolean) => store.setState({ visible })]\n  }, [store, visible])\n}\n","import { useLocale } from '@editablejs/editor'\nimport { CloseIcon, Tooltip } from '@editablejs/ui'\nimport { FC } from 'react'\nimport { OverlayRenderProps } from 'react-image-previewer'\nimport {\n  CloseButton,\n  SlideToolbar,\n  DragToolbar,\n  DragArrowLeft,\n  DragArrowRight,\n  DragZoomOut,\n  DragZoomIn,\n  DragOneToOne,\n  DragDownload,\n  DragRotateLeft,\n  DragRotateRight,\n} from 'react-image-previewer/ui'\nimport { IMAGE_KEY } from '../constants'\nimport { ImageLocale } from '../locale'\n\nexport const ViewerToolbar: FC<OverlayRenderProps> = props => {\n  const { mode, index, images, onClose } = props\n  const count = images.length\n  const isFirst = index === 0\n  const isLast = index === count - 1\n\n  const { viewer: viewerLocale } = useLocale<ImageLocale>(IMAGE_KEY)\n\n  if (mode === 'slide') {\n    return (\n      <>\n        <SlideToolbar {...props} />\n        <CloseButton onClick={onClose} />\n      </>\n    )\n  }\n\n  return (\n    <>\n      <DragToolbar\n        className='drag-toolbar'\n        {...props}\n        items={[\n          {\n            key: 'arrowLeft',\n            component: props => (\n              <Tooltip content={isFirst ? viewerLocale.arrowLeftDisabled : viewerLocale.arrowLeft}>\n                <a>\n                  <DragArrowLeft {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          'countText',\n          {\n            key: 'arrowRight',\n            component: props => (\n              <Tooltip content={isLast ? viewerLocale.arrowRightDisabled : viewerLocale.arrowRight}>\n                <a>\n                  <DragArrowRight {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          'split',\n          {\n            key: 'zoomOut',\n            component: props => (\n              <Tooltip content={viewerLocale.zoomOut}>\n                <a>\n                  <DragZoomOut {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          'scaleCount',\n          {\n            key: 'zoomIn',\n            component: props => (\n              <Tooltip content={viewerLocale.zoomIn}>\n                <a>\n                  <DragZoomIn {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          {\n            key: 'oneToOne',\n            component: props => (\n              <Tooltip content={viewerLocale.oneToOne}>\n                <a>\n                  <DragOneToOne {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          'split',\n          {\n            key: 'download',\n            component: props => (\n              <Tooltip content={viewerLocale.download}>\n                <a>\n                  <DragDownload {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          'split',\n          {\n            key: 'rotateLeft',\n            component: props => (\n              <Tooltip content={viewerLocale.rotateLeft}>\n                <a>\n                  <DragRotateLeft {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          {\n            key: 'rotateRight',\n            component: props => (\n              <Tooltip content={viewerLocale.rotateRight}>\n                <a>\n                  <DragRotateRight {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n        ]}\n      />\n      <CloseButton onClick={onClose}>\n        <Tooltip content={viewerLocale.close}>\n          <a>\n            <CloseIcon />\n          </a>\n        </Tooltip>\n      </CloseButton>\n    </>\n  )\n}\n","import { Editable, Hotkey } from '@editablejs/editor'\nimport { Editor, Element, Range, Point, Transforms, Text, Path } from '@editablejs/models'\nimport { ImageEditor } from './image-editor'\n\nconst findMatchedRange = (editor: Editor, at: Point) => {\n  const [startText] = Editor.nodes<Text>(editor, {\n    at,\n    match: n => Text.isText(n),\n  })\n  if (!startText) return\n\n  const block = Editor.above(editor, {\n    at,\n    match: n => Element.isElement(n) && Editor.isBlock(editor, n),\n  })\n\n  const path = block ? block[1] : []\n\n  const start = Editor.start(editor, path)\n  const range = { anchor: at, focus: start }\n  const beforeText = Editor.string(editor, range)\n  const reg = /!\\[(.*)\\]\\((.*)\\)$/\n  let match = beforeText.match(reg)\n  if (match && match.length > 1) {\n    const title = match[1]\n    const url = match[2]\n    const matchedTexts = Editor.nodes<Text>(editor, {\n      at: range,\n      match: (n, p) => Text.isText(n) && (n === startText[0] || Path.isBefore(p, startText[1])),\n      reverse: true,\n    })\n    let content = ''\n    for (const [text, path] of matchedTexts) {\n      if (text === startText[0]) {\n        content = text.text.slice(0, at.offset)\n      } else {\n        content = text.text + content\n      }\n      match = content.match(reg)\n      if (match && match.length > 1) {\n        const offset = match.index ?? 0\n        return {\n          title,\n          url,\n          range: { anchor: { path, offset }, focus: at },\n        }\n      }\n    }\n  }\n}\nexport const withShortcuts = (editor: Editable) => {\n  const { onKeydown } = editor\n\n  editor.onKeydown = event => {\n    const { selection } = editor\n    if (\n      selection &&\n      Range.isCollapsed(selection) &&\n      !Editable.isComposing(editor) &&\n      Hotkey.match('space', event)\n    ) {\n      const anchor = Range.start(selection)\n      const match = findMatchedRange(editor, anchor)\n      if (match) {\n        event.preventDefault()\n        const { range, url } = match\n        Transforms.delete(editor, {\n          at: range,\n        })\n        Transforms.collapse(editor)\n        ImageEditor.insert(editor, {\n          file: url,\n        })\n        return\n      }\n    }\n    onKeydown(event)\n  }\n}\n"],"mappings":"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","names":["import_models","import_editor","import_models","import_ui","import_styled_components","import_editor","import_models","import_react","import_editor","import_models","create","image","import_models","path","_styled12styled_components","_styled11styled_components","_styled10styled_components","_styled9styled_components","_styled8styled_components","_styled7styled_components","_styled6styled_components","_styled5styled_components","_styled4styled_components","_styled3styled_components","_styled2styled_components","_styledstyled_components","url","_css","width","height","rotate","locale","import_styled_components","import_editor","import_ui","import_react","import_react","import_zustand","import_editor","import_react","index","import_react","import_zustand","visible","import_editor","import_ui","import_jsx_runtime","props","import_jsx_runtime","_styled","_styledstyled_components","React","_styled","import_editor","import_models","path","import_jsx_runtime"]}
\ No newline at end of file
diff --git a/node_modules/@editablejs/plugin-image/dist/index.mjs b/node_modules/@editablejs/plugin-image/dist/index.mjs
index 727b886..24b4eec 100644
--- a/node_modules/@editablejs/plugin-image/dist/index.mjs
+++ b/node_modules/@editablejs/plugin-image/dist/index.mjs
@@ -553,7 +553,9 @@ var ImageComponent = forwardRef(({
       width: isError ? void 0 : size[0] || "auto",
       height: loaded || isError ? void 0 : size[1] || "auto"
     }, children: [
-      /* @__PURE__ */ jsxs(_StyledDiv8, { onMouseDown: handleImageDown, onClick: handleImageClick, children: [
+      /* @__PURE__ */ jsxs(_StyledDiv8, { style: {
+        width: "100%"
+      }, onMouseDown: handleImageDown, onClick: handleImageClick, children: [
         renderImage(),
         renderStyleStroke(),
         /* @__PURE__ */ jsx(_StyledDiv9, { children }),
@@ -676,7 +678,8 @@ var _StyledDiv7 = _styled("div").withConfig({
 var _StyledDiv8 = _styled("div").withConfig({
   componentId: "sc-1385wrh-9"
 })({
-  "display": "inline-block"
+  "display": "inline-block",
+  "maxWidth": "100%"
 });
 var _StyledDiv9 = _styled("div").withConfig({
   componentId: "sc-1385wrh-10"
@@ -824,6 +827,7 @@ var ViewerToolbar = (props) => {
     /* @__PURE__ */ jsx2(
       DragToolbar,
       {
+        className: "drag-toolbar",
         ...props,
         items: [
           {
@@ -880,7 +884,7 @@ var ImageViewer = React2.memo(() => {
   const images = useMemo6(() => {
     return visible ? viewer.images() : [];
   }, [visible, viewer]);
-  return /* @__PURE__ */ jsx3(PhotoSlider, { mode: "drag", images, visible, index, onIndexChange: setIndex, onClose: () => setVisible(false), loop: true, pullClosable: false, maskOpacity: isTouchDevice ? 1 : 0.9, loadingElement: /* @__PURE__ */ jsx3(_StyledIcon, { name: "loading" }), overlayRender: (props) => {
+  return /* @__PURE__ */ jsx3(PhotoSlider, { mode: "drag", className: "image-dialog", images, visible, index, onIndexChange: setIndex, onClose: () => setVisible(false), loop: true, pullClosable: false, maskOpacity: isTouchDevice ? 1 : 0.9, loadingElement: /* @__PURE__ */ jsx3(_StyledIcon, { name: "loading" }), overlayRender: (props) => {
     return /* @__PURE__ */ jsx3(ViewerToolbar, { ...props });
   } });
 });
diff --git a/node_modules/@editablejs/plugin-image/dist/index.mjs.map b/node_modules/@editablejs/plugin-image/dist/index.mjs.map
index eda25d9..87e9ccc 100644
--- a/node_modules/@editablejs/plugin-image/dist/index.mjs.map
+++ b/node_modules/@editablejs/plugin-image/dist/index.mjs.map
@@ -1 +1 @@
-{"version":3,"sources":["../src/plugin/image-editor.ts","../src/plugin/with-image.tsx","../src/components/image.tsx","../src/hooks/use-viewer.ts","../src/create-viewer.tsx","../src/store/viewer.ts","../src/utils.ts","../src/locale/zh_CN.ts","../src/locale/en_US.ts","../src/locale/index.ts","../src/components/viewer.tsx","../src/hooks/use-viewer-index.ts","../src/hooks/use-viewer-store.ts","../src/hooks/use-viewer-visible.ts","../src/components/viewer-toolbar.tsx","../src/plugin/with-shortcuts.ts"],"sourcesContent":["import { Editor } from '@editablejs/models'\nimport { IMAGE_KEY } from '../constants'\nimport { Image, ImageStyle } from '../interfaces/image'\nimport { getOptions } from '../options'\n\nexport interface InsertImageOptions {\n  file: File | string\n}\nexport interface OpenImageOptions extends Omit<InsertImageOptions, 'file'> {\n  accept?: string\n  multiple?: boolean\n}\n\nexport interface ImageEditor extends Editor {\n  openImage: (options?: OpenImageOptions) => void\n\n  insertImage: (options: InsertImageOptions) => Promise<void>\n\n  rotateImage: (rotate: number, image: Image) => void\n\n  setStyleImage: (style: ImageStyle, image: Image) => void\n}\n\nexport const ImageEditor = {\n  isImageEditor: (editor: Editor): editor is ImageEditor => {\n    return !!(editor as ImageEditor).openImage\n  },\n\n  isImage: (editor: Editor, n: any): n is Image => {\n    return Image.isImage(n)\n  },\n\n  isActive: (editor: Editor) => {\n    const elements = Editor.elements(editor)\n    return !!elements[IMAGE_KEY]\n  },\n\n  getOptions,\n\n  open: (editor: Editor, options?: OpenImageOptions) => {\n    if (ImageEditor.isImageEditor(editor)) editor.openImage(options)\n  },\n\n  insert: (editor: Editor, options: InsertImageOptions) => {\n    if (ImageEditor.isImageEditor(editor)) editor.insertImage(options)\n  },\n\n  rotate: (editor: Editor, rotate: number, image: Image) => {\n    if (ImageEditor.isImageEditor(editor)) editor.rotateImage(rotate, image)\n  },\n\n  setStyle: (editor: Editor, style: ImageStyle, image: Image) => {\n    if (ImageEditor.isImageEditor(editor)) editor.setStyleImage(style, image)\n  },\n}\n","import { Editable, Hotkey, Locale, Slot } from '@editablejs/editor'\nimport { Editor, Operation, Transforms } from '@editablejs/models'\nimport { withHistoryProtocol } from '@editablejs/protocols/history'\nimport { openFileDialog } from '@editablejs/ui'\nimport { setOptions, ImageHotkey, ImageOptions } from '../options'\nimport { Image } from '../interfaces/image'\nimport { ImageComponent } from '../components/image'\nimport { ImageEditor } from './image-editor'\nimport locale from '../locale'\nimport {\n  insertImage,\n  readImageFileInfo,\n  uploadImage,\n  rotateImgWithCanvas,\n  readImageElement,\n} from '../utils'\nimport { ImageViewer } from '../components/viewer'\nimport { withShortcuts } from './with-shortcuts'\n\nconst defaultHotkey: ImageHotkey = ''\n\nconst defaultBeforeUpload = (files: File[]) => {\n  return files.filter(file => file.type.startsWith('image/'))\n}\n\nexport const withImage = <T extends Editable>(editor: T, options: ImageOptions = {}) => {\n  const newEditor = editor as T & ImageEditor\n\n  setOptions(newEditor, options)\n\n  const { isInline, isVoid } = newEditor\n  const historyProtocol = withHistoryProtocol(newEditor)\n  const { capture } = historyProtocol\n\n  historyProtocol.capture = (op: Operation) => {\n    if (op.type === 'set_node') {\n      const { path, newProperties } = op\n      if (Editor.hasPath(editor, path)) {\n        const image = Editor.node(editor, path)\n        if (Image.isImage(image[0])) {\n          const prop = newProperties as Partial<Image>\n          if (prop.url || prop.state || prop.percentage) {\n            return false\n          }\n        }\n      }\n    }\n    return capture(op)\n  }\n\n  const { locale: localeOptions = {} } = options\n  Locale.setLocale(newEditor, locale, localeOptions)\n\n  Slot.mount(newEditor, ImageViewer)\n\n  newEditor.isInline = element => {\n    return ImageEditor.isImage(newEditor, element) || isInline(element)\n  }\n\n  newEditor.isVoid = element => {\n    return ImageEditor.isImage(newEditor, element) || isVoid(element)\n  }\n\n  const insertImages = (files: (File | string)[]) => {\n    Promise.all(\n      files.map(file =>\n        typeof file === 'string' ? Promise.resolve(file) : readImageFileInfo(file),\n      ),\n    ).then(items => {\n      items.forEach(item => {\n        if (!item) return\n        if (typeof item === 'string') return newEditor.insertImage({ file: item })\n        const { url, file, width, height } = item\n        const path = insertImage(newEditor, {\n          url,\n          width,\n          height,\n          name: file.name,\n          state: 'uploading',\n        })\n        uploadImage(editor, path, file).then(() => {\n          URL.revokeObjectURL(url)\n        })\n      })\n    })\n  }\n  const { onUploadBefore = defaultBeforeUpload } = options\n\n  newEditor.openImage = ({ accept = 'image/*', multiple = false } = {}) => {\n    if (!newEditor.selection) {\n      newEditor.focus(false)\n    }\n\n    openFileDialog({\n      accept,\n      multiple,\n      onChange: files => {\n        const customFiles = onUploadBefore(files)\n        if (customFiles.length > 0) insertImages(files)\n      },\n    })\n  }\n\n  newEditor.insertImage = async ({ file }) => {\n    if (!newEditor.selection) {\n      newEditor.focus(false)\n    }\n\n    const url = file instanceof File ? URL.createObjectURL(file) : file\n    editor.normalizeSelection(selection => {\n      if (editor.selection !== selection) editor.selection = selection\n      const path = insertImage(editor, {\n        url,\n        state: 'uploading',\n      })\n\n      return uploadImage(editor, path, file)\n    })\n  }\n\n  newEditor.rotateImage = (rotate, image) => {\n    const { onRotate, allowRotate } = options\n    const { url, state } = image\n    if (state !== 'done') return\n    const degrees = rotate % -360\n    if (onRotate && url && allowRotate !== false) {\n      readImageElement(url, true).then(img => {\n        rotateImgWithCanvas(img, degrees).then(blob => {\n          const file = new File([blob], image.name ?? 'rotate.png', { type: 'image/png' })\n          onRotate(file).then(res => {\n            if (res) {\n              const info = typeof res === 'string' ? { url: res, rotate: 0 } : res\n              Transforms.setNodes<Image>(\n                editor,\n                {\n                  rotate: info.rotate,\n                  url: info.url,\n                },\n                {\n                  at: Editable.findPath(editor, image),\n                },\n              )\n            }\n          })\n        })\n      })\n    }\n    Transforms.setNodes<Image>(\n      editor,\n      {\n        rotate,\n      },\n      {\n        at: Editable.findPath(editor, image),\n      },\n    )\n  }\n\n  newEditor.setStyleImage = (style, image) => {\n    Transforms.setNodes<Image>(\n      editor,\n      {\n        style,\n      },\n      {\n        at: Editable.findPath(editor, image),\n      },\n    )\n  }\n\n  const { renderElement } = newEditor\n  newEditor.renderElement = ({ element, attributes, children }) => {\n    if (ImageEditor.isImage(editor, element)) {\n      return (\n        <ImageComponent {...attributes} element={element} editor={newEditor}>\n          {children}\n        </ImageComponent>\n      )\n    }\n    return renderElement({ attributes, children, element })\n  }\n\n  const hotkey = options.hotkey ?? defaultHotkey\n  const { onKeydown, insertFile } = newEditor\n  newEditor.onKeydown = (e: KeyboardEvent) => {\n    if (Hotkey.match(hotkey, e)) {\n      e.preventDefault()\n      newEditor.openImage()\n      return\n    }\n\n    onKeydown(e)\n  }\n\n  newEditor.insertFile = (file, at) => {\n    const customFiles = onUploadBefore([file])\n    if (customFiles.length > 0) {\n      if (at) {\n        Transforms.select(newEditor, at)\n      }\n      insertImages(customFiles)\n      return\n    }\n    insertFile(file, at)\n  }\n\n  const { shortcuts } = options\n  if (shortcuts !== false) {\n    withShortcuts(newEditor)\n  }\n  return newEditor\n}\n","import _styled12styled_components from 'styled-components';\n            const _styled12 = typeof _styled12styled_components.default === 'undefined' ? _styled12styled_components : _styled12styled_components.default;;\nimport _styled11styled_components from 'styled-components';\n            const _styled11 = typeof _styled11styled_components.default === 'undefined' ? _styled11styled_components : _styled11styled_components.default;;\nimport _styled10styled_components from 'styled-components';\n            const _styled10 = typeof _styled10styled_components.default === 'undefined' ? _styled10styled_components : _styled10styled_components.default;;\nimport _styled9styled_components from 'styled-components';\n            const _styled9 = typeof _styled9styled_components.default === 'undefined' ? _styled9styled_components : _styled9styled_components.default;;\nimport _styled8styled_components from 'styled-components';\n            const _styled8 = typeof _styled8styled_components.default === 'undefined' ? _styled8styled_components : _styled8styled_components.default;;\nimport _styled7styled_components from 'styled-components';\n            const _styled7 = typeof _styled7styled_components.default === 'undefined' ? _styled7styled_components : _styled7styled_components.default;;\nimport _styled6styled_components from 'styled-components';\n            const _styled6 = typeof _styled6styled_components.default === 'undefined' ? _styled6styled_components : _styled6styled_components.default;;\nimport _styled5styled_components from 'styled-components';\n            const _styled5 = typeof _styled5styled_components.default === 'undefined' ? _styled5styled_components : _styled5styled_components.default;;\nimport _styled4styled_components from 'styled-components';\n            const _styled4 = typeof _styled4styled_components.default === 'undefined' ? _styled4styled_components : _styled4styled_components.default;;\nimport _styled3styled_components from 'styled-components';\n            const _styled3 = typeof _styled3styled_components.default === 'undefined' ? _styled3styled_components : _styled3styled_components.default;;\nimport _styled2styled_components from 'styled-components';\n            const _styled2 = typeof _styled2styled_components.default === 'undefined' ? _styled2styled_components : _styled2styled_components.default;;\nimport _styledstyled_components from 'styled-components';\n            const _styled = typeof _styledstyled_components.default === 'undefined' ? _styledstyled_components : _styledstyled_components.default;;\nimport { css as _css } from \"styled-components\";\nimport { Editable, useLocale, useNodeFocused, useReadOnly } from '@editablejs/editor';\nimport { Editor, Transforms } from '@editablejs/models';\nimport { Icon, Popover, PopoverContent, PopoverTrigger, Resizer, Toolbar, ToolbarButton, ToolbarDropdown, Tooltip, useIsomorphicLayoutEffect } from '@editablejs/ui';\nimport React, { forwardRef, useEffect, useMemo, useRef, useState } from 'react';\nimport { DATA_IMAGE_KEY } from '../constants';\nimport { useViewer } from '../hooks/use-viewer';\nimport { getOptions } from '../options';\nimport { readImageElement, rotateImgWithCanvas, uploadImage } from '../utils';\nexport const ImageComponent = forwardRef(({\n  children,\n  element,\n  editor,\n  ...props\n}, ref) => {\n  const {\n    url,\n    state,\n    rotate,\n    errorMessage,\n    percentage,\n    width,\n    height\n  } = element;\n  const [errorMsg, setErrorMsg] = useState(errorMessage);\n  const [loading, setLoading] = useState(true);\n  const [loaded, setLoaded] = useState(false);\n  const [src, setSrc] = useState('');\n  const [rotatedUrl, setRotatedUrl] = useState('');\n  const [imageDOMElement, setImageDOMElement] = useState(null);\n  const [readOnly] = useReadOnly();\n  const options = useMemo(() => {\n    return getOptions(editor);\n  }, [editor]);\n  const viewer = useViewer();\n  useIsomorphicLayoutEffect(() => {\n    if (options.onBeforeRender && url && state === 'done') {\n      options.onBeforeRender(url).then(url => {\n        setSrc(url);\n      }).catch(err => {\n        setErrorMsg(err.message);\n      }).finally(() => {\n        setLoading(false);\n      });\n    } else if (url && state === 'waitingUpload') {\n      uploadImage(editor, Editable.findPath(editor, element), url);\n    } else if (url) {\n      setSrc(url);\n      setLoading(false);\n    }\n  }, [url, state]);\n  useIsomorphicLayoutEffect(() => {\n    if (src) {\n      readImageElement(src).then(image => {\n        setLoaded(true);\n        setImageDOMElement(image);\n      }).catch(err => {\n        if (state === 'done') setErrorMsg(typeof err === 'object' ? err.message : err);\n      });\n    }\n  }, [src, state]);\n  useEffect(() => {\n    if (!imageDOMElement) {\n      return setRotatedUrl('');\n    }\n\n    if (rotate !== undefined && loaded && state === 'done' && options.allowRotate !== false) {\n      readImageElement(imageDOMElement.src, true).then(img => {\n        rotateImgWithCanvas(img, rotate).then(blob => {\n          setRotatedUrl(URL.createObjectURL(blob));\n        });\n      });\n    }\n  }, [imageDOMElement, rotate, state, loaded, options.allowRotate]);\n  useEffect(() => {\n    return () => {\n      if (rotatedUrl) {\n        URL.revokeObjectURL(rotatedUrl);\n      }\n    };\n  }, [rotatedUrl]);\n  const [maxWidth, setMaxWidth] = useState(0);\n  useEffect(() => {\n    const path = Editable.findPath(editor, element);\n    const parentEntry = Editor.above(editor, {\n      at: path,\n      match: n => Editor.isBlock(editor, n),\n      mode: 'lowest'\n    });\n\n    if (parentEntry) {\n      const parentEl = Editable.toDOMNode(editor, parentEntry[0]);\n      setMaxWidth(parentEl.clientWidth);\n    }\n  }, [editor, element]);\n  const focused = useNodeFocused();\n  const isUploading = state === 'uploading' || state === 'waitingUpload';\n\n  const renderUploading = () => {\n    if (!isUploading) return null;\n    return <_StyledDiv>\n          {percentage !== undefined && <_StyledDiv2 $_css2={[{\n        \"position\": \"relative\",\n        \"height\": \"0.5rem\",\n        \"width\": \"33.333333%\",\n        \"overflow\": \"hidden\",\n        \"borderRadius\": \"0.25rem\",\n        \"backgroundColor\": \"rgb(156 163 175 / 0.3)\"\n      }, _css([\"min-width:8px;\"])]}>\n              <_StyledDiv3 style={{\n          width: `${percentage}%`\n        }}></_StyledDiv3>\n            </_StyledDiv2>}\n          {percentage === undefined && <Icon name=\"loading\" />}\n        </_StyledDiv>;\n  };\n\n  const renderLoading = () => {\n    if (!loading || loaded) return null;\n    return <_StyledDiv4>\n          <Icon name=\"loading\" />\n        </_StyledDiv4>;\n  };\n\n  const isError = state === 'error' || !!errorMsg;\n\n  const renderError = () => {\n    if (!isError) return null;\n    return <_StyledSpan>\n          <span>{errorMsg || 'Image error.'}</span>\n        </_StyledSpan>;\n  };\n\n  const renderImage = () => {\n    if (isError || !src || !loaded) return null;\n    const atts = {\n      [DATA_IMAGE_KEY]: Editable.findKey(editor, element).id\n    };\n    return <_StyledImg {...atts} alt=\"\" draggable={false} src={rotatedUrl || src} $_css3={[{\n      \"display\": \"inline-block\",\n      \"height\": \"100%\",\n      \"width\": \"100%\",\n      \"borderRadius\": \"0.25rem\",\n      \"verticalAlign\": \"baseline\"\n    }, isUploading && {\n      \"opacity\": \"0.3\"\n    }]} />;\n  };\n\n  const handleResizeChange = (width, height) => {\n    Transforms.setNodes(editor, {\n      width,\n      height\n    }, {\n      at: Editable.findPath(editor, element)\n    });\n  };\n\n  const isFocusedMouseDownBefore = useRef(false);\n\n  const handleImageDown = () => {\n    isFocusedMouseDownBefore.current = focused;\n  };\n\n  const handleImageClick = event => {\n    if (isFocusedMouseDownBefore.current && !event.defaultPrevented && isDone && loaded) {\n      viewer.open(element);\n    }\n  };\n\n  const renderStyleStroke = () => {\n    if (element.style !== 'stroke') return null;\n    return <_StyledDiv5 />;\n  };\n\n  const changeStyle = style => {\n    editor.setStyleImage(style, element);\n  };\n\n  const changeRotate = rotate => {\n    if (Math.abs(rotate) === 360) {\n      rotate = 0;\n    }\n\n    editor.rotateImage(rotate, element);\n  };\n\n  const isDone = state === 'done';\n  const autoSize = useMemo(() => {\n    if (height === undefined || width === undefined) return undefined;\n    const ratio = height / width;\n\n    if (width > maxWidth && maxWidth > 0) {\n      return [maxWidth, maxWidth * ratio];\n    }\n\n    return [width, height];\n  }, [width, height, loaded, maxWidth]);\n  const size = autoSize || [width, height];\n  const [popoverOpen, setPopoverOpen] = useState(false);\n\n  const handlePopoverOpenChange = open => {\n    if (focused) {\n      setPopoverOpen(true);\n    } else {\n      setPopoverOpen(open);\n    }\n  };\n\n  useIsomorphicLayoutEffect(() => {\n    setPopoverOpen(focused);\n  }, [focused]);\n  const {\n    style: styleLocale,\n    viewer: viewerLocale\n  } = useLocale('image');\n  return <Popover open={isDone && !readOnly ? popoverOpen : false} onOpenChange={handlePopoverOpenChange} trigger=\"hover\">\n        <PopoverTrigger asChild>\n          <_StyledDiv6 {...props} ref={ref} $_css4={[{\n        \"position\": \"relative\",\n        \"display\": \"inline-block\",\n        \"maxWidth\": \"100%\",\n        \"cursor\": \"default\",\n        \"borderRadius\": \"0.25rem\",\n        \"borderWidth\": \"1px\",\n        \"borderColor\": \"transparent\",\n        \"lineHeight\": \"0\"\n      }, element.style === 'shadow' && {\n        \"--tw-shadow\": \"0 2px 6px 2px rgb(60 64 67 / 15%)\",\n        \"--tw-shadow-colored\": \"0 2px 6px 2px var(--tw-shadow-color)\",\n        \"boxShadow\": \"var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)\"\n      }, focused && isDone && {\n        \"cursor\": \"zoom-in\"\n      }, !loaded && {\n        \"--tw-bg-opacity\": \"1\",\n        \"backgroundColor\": \"rgb(243 244 246 / var(--tw-bg-opacity))\"\n      }, !focused && isDone && popoverOpen && {\n        \"--tw-border-opacity\": \"1\",\n        \"borderColor\": \"rgb(64 150 255 / var(--tw-border-opacity))\"\n      }, (loading || isUploading || isError) && {\n        \"lineHeight\": \"inherit\"\n      }]}>\n            <_StyledDiv7 style={{\n          width: isError ? undefined : size[0] || 'auto',\n          height: loaded || isError ? undefined : size[1] || 'auto'\n        }}>\n              <_StyledDiv8 onMouseDown={handleImageDown} onClick={handleImageClick}>\n                {renderImage()}\n                {renderStyleStroke()}\n                <_StyledDiv9>{children}</_StyledDiv9>\n                {renderUploading()}\n                {renderError()}\n                {renderLoading()}\n              </_StyledDiv8>\n              {focused && !readOnly && !isError && <_StyledResizer onChange={handleResizeChange} previewImage={isDone && loaded ? rotatedUrl || src : undefined} holders={isDone ? undefined : []} />}\n            </_StyledDiv7>\n          </_StyledDiv6>\n        </PopoverTrigger>\n        <PopoverContent autoUpdate={true} side=\"top\" sideOffset={5}>\n          <Toolbar mode=\"inline\">\n            {options.allowRotate !== false && <Tooltip content={viewerLocale.rotateLeft} side=\"top\" sideOffset={5} arrow={false}>\n                <ToolbarButton icon={<Icon name=\"rotateLeft\" />} onToggle={() => changeRotate((rotate ?? 0) - 90)} />\n              </Tooltip>}\n            <Tooltip content={styleLocale.tooltip} side=\"top\" sideOffset={5} arrow={false}>\n              <ToolbarDropdown onSelect={value => changeStyle(value)} value={element.style || 'none'} items={[{\n            value: 'none',\n            content: styleLocale.none\n          }, {\n            value: 'stroke',\n            content: styleLocale.stroke\n          }, {\n            value: 'shadow',\n            content: styleLocale.shadow\n          }]}>\n                {styleLocale.title}\n              </ToolbarDropdown>\n            </Tooltip>\n          </Toolbar>\n        </PopoverContent>\n      </Popover>;\n});\nImageComponent.displayName = 'ImageComponent';\n\nvar _StyledDiv = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-0\"\n})({\n  \"position\": \"absolute\",\n  \"left\": \"0px\",\n  \"top\": \"0px\",\n  \"display\": \"flex\",\n  \"height\": \"100%\",\n  \"width\": \"100%\",\n  \"alignItems\": \"center\",\n  \"justifyContent\": \"center\",\n  \"--tw-text-opacity\": \"1\",\n  \"color\": \"rgb(64 150 255 / var(--tw-text-opacity))\"\n});\n\nvar _StyledDiv2 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-1\"\n})([\"\", \"\"], p => p.$_css2);\n\nvar _StyledDiv3 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-2\"\n})({\n  \"position\": \"absolute\",\n  \"left\": \"0px\",\n  \"top\": \"0px\",\n  \"height\": \"100%\",\n  \"@keyframes pulse\": {\n    \"50%\": {\n      \"opacity\": \".5\"\n    }\n  },\n  \"animation\": \"pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite\",\n  \"--tw-bg-opacity\": \"1\",\n  \"backgroundColor\": \"rgb(64 150 255 / var(--tw-bg-opacity))\"\n});\n\nvar _StyledDiv4 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-3\"\n})({\n  \"position\": \"absolute\",\n  \"left\": \"0px\",\n  \"top\": \"0px\",\n  \"display\": \"flex\",\n  \"height\": \"100%\",\n  \"width\": \"100%\",\n  \"alignItems\": \"center\",\n  \"justifyContent\": \"center\",\n  \"--tw-text-opacity\": \"1\",\n  \"color\": \"rgb(64 150 255 / var(--tw-text-opacity))\"\n});\n\nvar _StyledSpan = _styled(\"span\").withConfig({\n  componentId: \"sc-1385wrh-4\"\n})({\n  \"borderRadius\": \"0.25rem\",\n  \"borderWidth\": \"1px\",\n  \"--tw-border-opacity\": \"1\",\n  \"borderColor\": \"rgb(209 213 219 / var(--tw-border-opacity))\",\n  \"paddingLeft\": \"0.5rem\",\n  \"paddingRight\": \"0.5rem\",\n  \"paddingTop\": \"0.125rem\",\n  \"paddingBottom\": \"0.125rem\",\n  \"verticalAlign\": \"baseline\",\n  \"fontSize\": \"12px\",\n  \"--tw-text-opacity\": \"1\",\n  \"color\": \"rgb(239 68 68 / var(--tw-text-opacity))\"\n});\n\nvar _StyledImg = _styled(\"img\").withConfig({\n  componentId: \"sc-1385wrh-5\"\n})([\"\", \"\"], p => p.$_css3);\n\nvar _StyledDiv5 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-6\"\n})({\n  \"pointerEvents\": \"none\",\n  \"position\": \"absolute\",\n  \"top\": \"0px\",\n  \"right\": \"0px\",\n  \"bottom\": \"0px\",\n  \"left\": \"0px\",\n  \"height\": \"100%\",\n  \"width\": \"100%\",\n  \"borderRadius\": \"0.25rem\",\n  \"borderWidth\": \"1px\",\n  \"--tw-border-opacity\": \"1\",\n  \"borderColor\": \"rgb(209 213 219 / var(--tw-border-opacity))\"\n});\n\nvar _StyledDiv6 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-7\"\n})([\"\", \"\"], p => p.$_css4);\n\nvar _StyledDiv7 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-8\"\n})({\n  \"display\": \"inline-block\",\n  \"height\": \"auto\",\n  \"minHeight\": \"24px\",\n  \"minWidth\": \"24px\",\n  \"maxWidth\": \"100%\"\n});\n\nvar _StyledDiv8 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-9\"\n})({\n  \"display\": \"inline-block\"\n});\n\nvar _StyledDiv9 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-10\"\n})({\n  \"position\": \"absolute\",\n  \"display\": \"none\"\n});\n\nvar _StyledResizer = _styled(Resizer).withConfig({\n  componentId: \"sc-1385wrh-11\"\n})({\n  \"borderRadius\": \"0.25rem\"\n});","import { useEditableStatic } from '@editablejs/editor'\nimport { useMemo } from 'react'\nimport { getViewer } from '../create-viewer'\n\nexport const useViewer = () => {\n  const editor = useEditableStatic()\n\n  return useMemo(() => getViewer(editor), [editor])\n}\n","import { Editable } from '@editablejs/editor'\nimport { Editor } from '@editablejs/models'\nimport { DataType } from 'react-image-previewer'\nimport { DATA_IMAGE_KEY } from './constants'\nimport { Image } from './interfaces/image'\nimport { getViewerStore } from './store'\n\nconst IMAGES_CACHE_WEAKMAP = new WeakMap<Editor, DataType[]>()\n\nconst findImages = (editor: Editable, force = false) => {\n  const caches = IMAGES_CACHE_WEAKMAP.get(editor)\n  if (caches && !force) return caches\n  const images: DataType[] = []\n  const nodes = Editor.nodes(editor, {\n    at: [],\n    match: node => Image.isImage(node) && !!node.url,\n  })\n\n  for (const [node] of nodes) {\n    const key = Editable.findKey(editor, node).id\n    const el = Editable.toDOMNode(editor, node)\n    const image = el.querySelector(`img[${DATA_IMAGE_KEY}=\"${key}\"]`)\n    if (!image) continue\n    const src = image.getAttribute('src')\n    if (!src) continue\n    images.push({\n      key,\n      src,\n    })\n  }\n  IMAGES_CACHE_WEAKMAP.set(editor, images)\n  return images\n}\n\nexport const VIEWER_CACHE_WEAKMAP = new WeakMap<Editor, ReturnType<typeof createViewer>>()\n\nconst createViewer = (editor: Editable) => {\n  const viewer = {\n    images: (force = false) => findImages(editor, force),\n\n    count: () => {\n      return viewer.images().length\n    },\n\n    open: (image: Image) => {\n      const store = getViewerStore(editor)\n      const images = viewer.images(true)\n      const key = Editable.findKey(editor, image).id\n      return store.setState({\n        visible: true,\n        index: images.findIndex(image => image.key === key),\n      })\n    },\n\n    close: () => {\n      const store = getViewerStore(editor)\n      store.setState({\n        visible: false,\n        index: -1,\n      })\n    },\n\n    prev: () => {\n      const store = getViewerStore(editor)\n      const count = viewer.count()\n      const index = store.getState().index\n      let val = index - 1\n      if (val < 0) val = count - 1\n      store.setState({\n        index: val,\n      })\n    },\n\n    next: () => {\n      const store = getViewerStore(editor)\n      const count = viewer.count()\n      const index = store.getState().index\n      let val = index + 1\n      if (val === count) val = 0\n      store.setState({\n        index: val,\n      })\n    },\n  }\n  return viewer\n}\n\nexport const getViewer = (editor: Editable) => {\n  let viewer = VIEWER_CACHE_WEAKMAP.get(editor)\n  if (viewer) {\n    return viewer\n  }\n  viewer = createViewer(editor)\n  VIEWER_CACHE_WEAKMAP.set(editor, viewer)\n  return viewer\n}\n","import { Editor } from '@editablejs/models'\nimport create, { StoreApi, UseBoundStore } from 'zustand'\nexport interface ImageViewerStore {\n  visible: boolean\n  index: number\n}\n\nconst EDITOR_TO_IMAGE_STORE = new WeakMap<Editor, UseBoundStore<StoreApi<ImageViewerStore>>>()\n\nexport const getViewerStore = (editor: Editor) => {\n  let store = EDITOR_TO_IMAGE_STORE.get(editor)\n  if (!store) {\n    store = create<ImageViewerStore>(() => ({\n      visible: false,\n      index: 0,\n    }))\n    EDITOR_TO_IMAGE_STORE.set(editor, store)\n  }\n  return store\n}\n","import { Editor, Path, Transforms } from '@editablejs/models'\nimport { IMAGE_KEY } from './constants'\nimport { Image } from './interfaces/image'\nimport { getOptions } from './options'\n\nconst readBase64WithFileReader = (file: File) => {\n  return new Promise<string>((resolve, reject) => {\n    const reader = new FileReader()\n    reader.readAsDataURL(file)\n    reader.onload = () => {\n      resolve(reader.result as string)\n    }\n    reader.onerror = error => {\n      reject(error)\n    }\n  })\n}\n\nconst readBase64WithFetch = (url: string) => {\n  return new Promise<string>((resolve, reject) => {\n    const xhr = new XMLHttpRequest()\n    xhr.onload = () => {\n      const reader = new FileReader()\n      reader.onloadend = () => {\n        resolve(reader.result as string)\n      }\n      reader.onerror = error => {\n        reject(error)\n      }\n      reader.readAsDataURL(xhr.response)\n    }\n    xhr.open('GET', url)\n    xhr.responseType = 'blob'\n    xhr.send()\n  })\n}\n\nexport const readBase64 = (file: File | string) => {\n  return typeof file === 'string' ? readBase64WithFetch(file) : readBase64WithFileReader(file)\n}\n\nexport const readImageElement = (url: string, base64 = false) => {\n  return new Promise<HTMLImageElement>(async (resolve, reject) => {\n    if (base64) url = await readBase64(url)\n    const image = new window.Image()\n    image.onload = () => {\n      resolve(image)\n    }\n    image.onerror = () => {\n      reject('image load error')\n    }\n    image.src = url\n  })\n}\n\ninterface ReadImageFileInfo {\n  url: string\n  file: File\n  width: number\n  height: number\n}\n\nexport const readImageFileInfo = (file: File) => {\n  return new Promise<ReadImageFileInfo | null>(resolve => {\n    const url = URL.createObjectURL(file)\n    readImageElement(url)\n      .then(image => {\n        resolve({\n          width: image.naturalWidth,\n          height: image.naturalHeight,\n          url,\n          file,\n        })\n      })\n      .catch(() => {\n        resolve(null)\n      })\n  })\n}\n\nexport const defaultUpload = (file: File | string) => {\n  return new Promise<string>((resolve, reject) => {\n    if (file instanceof File) {\n      readBase64(file).then(resolve).catch(reject)\n    } else {\n      resolve(file)\n    }\n  })\n}\n\nexport const setPercentage = (editor: Editor, path: Path, percentage: number) => {\n  Transforms.setNodes<Image>(editor, { percentage }, { at: path })\n}\n\nexport const insertImage = (editor: Editor, options: Partial<Image>) => {\n  const image: Image = {\n    type: IMAGE_KEY,\n    ...options,\n    children: [{ text: '' }],\n  }\n\n  Transforms.insertNodes(editor, image)\n  const entry = Editor.above(editor, {\n    match: n => Image.isImage(n),\n  })\n  if (!entry) throw new Error('image not found')\n  return entry[1]\n}\n\nexport const uploadImage = (editor: Editor, path: Path, file: File | string) => {\n  const options = getOptions(editor)\n  const promise = new Promise<void>(resolve => {\n    const pathRef = Editor.pathRef(editor, path)\n\n    const { onUpload = defaultUpload } = options\n    onUpload(file, ({ percentage }) => {\n      const path = pathRef.current\n      if (path) setPercentage(editor, path, percentage)\n    })\n      .then(url => {\n        const path = pathRef.current\n        if (path) Transforms.setNodes<Image>(editor, { url, state: 'done' }, { at: path })\n      })\n      .catch(err => {\n        const path = pathRef.current\n        if (path)\n          Transforms.setNodes<Image>(\n            editor,\n            { state: 'error', errorMessage: typeof err === 'string' ? err : err.message },\n            { at: path },\n          )\n      })\n      .finally(() => {\n        const path = pathRef.unref()\n\n        if (path) setPercentage(editor, path, 100)\n\n        resolve()\n      })\n  })\n  return promise\n}\n\nexport function rotateImgWithCanvas(image: HTMLImageElement, degrees: number): Promise<Blob> {\n  return new Promise((resolve, reject) => {\n    const canvas = document.createElement('canvas')\n    const ctx = canvas.getContext('2d')\n\n    if (!ctx || !image.height || !image.width) return\n    const horizontal = [-270, -90, 90, 270]\n    if (horizontal.includes(degrees)) {\n      canvas.width = image.naturalHeight || 0\n      canvas.height = image.naturalWidth || 0\n    } else {\n      canvas.width = image.naturalWidth || 0\n      canvas.height = image.naturalHeight || 0\n    }\n    ctx.translate(canvas.width / 2, canvas.height / 2)\n    ctx.rotate((degrees * Math.PI) / 180)\n    ctx.drawImage(image, -image.naturalWidth / 2, -image.naturalHeight / 2)\n    canvas.toBlob(blob => {\n      blob ? resolve(blob) : reject('blob is null')\n    }, 'image/jpeg')\n  })\n}\n","import { ImageLocale } from './types'\n\nconst locale: ImageLocale = {\n  locale: 'zh-CN',\n  image: {\n    viewer: {\n      arrowLeft: '',\n      arrowRight: '',\n      arrowLeftDisabled: '',\n      arrowRightDisabled: '',\n      close: '',\n      zoomIn: '',\n      zoomOut: '',\n      oneToOne: '',\n      rotateLeft: '',\n      rotateRight: '',\n      download: '',\n    },\n    style: {\n      title: '',\n      tooltip: '',\n      none: '',\n      stroke: '',\n      shadow: '',\n    },\n  },\n}\n\nexport default locale\n","import { ImageLocale } from './types'\n\nconst locale: ImageLocale = {\n  locale: 'en-US',\n  image: {\n    viewer: {\n      arrowLeft: 'Previous',\n      arrowRight: 'Next',\n      arrowLeftDisabled: 'Already the first one',\n      arrowRightDisabled: 'Already the last one',\n      close: 'Close',\n      zoomIn: 'Zoom in',\n      zoomOut: 'Zoom out',\n      oneToOne: 'Original size',\n      rotateLeft: 'Rotate left',\n      rotateRight: 'Rotate right',\n      download: 'Download',\n    },\n    style: {\n      title: 'Style',\n      tooltip: 'Image style',\n      none: 'None',\n      stroke: 'Stroke',\n      shadow: 'Shadow',\n    },\n  },\n}\n\nexport default locale\n","import zhCN from './zh_CN'\nimport enUS from './en_US'\nimport { ImageLocale } from './types'\n\nconst locales: Record<string, ImageLocale> = {\n  'en-US': enUS,\n  'zh-CN': zhCN,\n}\n\nexport type { ImageLocale }\n\nexport default locales\n","import _styledstyled_components from 'styled-components';\n            const _styled = typeof _styledstyled_components.default === 'undefined' ? _styledstyled_components : _styledstyled_components.default;;\nimport { isTouchDevice } from '@editablejs/editor';\nimport { Icon } from '@editablejs/ui';\nimport React, { useMemo } from 'react';\nimport { PhotoSlider } from 'react-image-previewer';\nimport { useViewer } from '../hooks/use-viewer';\nimport { useViewerIndex } from '../hooks/use-viewer-index';\nimport { useViewerVisible } from '../hooks/use-viewer-visible';\nimport { ViewerToolbar } from './viewer-toolbar';\nexport const ImageViewer = React.memo(() => {\n  const viewer = useViewer();\n  const [visible, setVisible] = useViewerVisible();\n  const [index, setIndex] = useViewerIndex();\n  const images = useMemo(() => {\n    return visible ? viewer.images() : [];\n  }, [visible, viewer]);\n  return <PhotoSlider mode=\"drag\" images={images} visible={visible} index={index} onIndexChange={setIndex} onClose={() => setVisible(false)} loop={true} pullClosable={false} maskOpacity={isTouchDevice ? 1 : 0.9} loadingElement={<_StyledIcon name=\"loading\" />} overlayRender={props => {\n    return <ViewerToolbar {...props} />;\n  }} />;\n});\nImageViewer.displayName = 'ImageViewer';\n\nvar _StyledIcon = _styled(Icon).withConfig({\n  componentId: \"sc-yrs7ly-0\"\n})({\n  \"fontSize\": \"24px\",\n  \"--tw-text-opacity\": \"1\",\n  \"color\": \"rgb(255 255 255 / var(--tw-text-opacity))\"\n});","import { useMemo } from 'react'\nimport { useStore } from 'zustand'\nimport { useViewerStore } from './use-viewer-store'\n\nexport const useViewerIndex = (): [number, (index: number) => void] => {\n  const store = useViewerStore()\n  const index = useStore(store, state => state.index)\n  return useMemo(() => [index, (index: number) => store.setState({ index })], [store, index])\n}\n","import { useEditableStatic } from '@editablejs/editor'\nimport { useMemo } from 'react'\nimport { getViewerStore } from '../store'\n\nexport const useViewerStore = () => {\n  const editor = useEditableStatic()\n  const store = useMemo(() => getViewerStore(editor), [editor])\n  return store\n}\n","import { useMemo } from 'react'\nimport { useStore } from 'zustand'\nimport { useViewerStore } from './use-viewer-store'\n\nexport const useViewerVisible = (): [boolean, (visible: boolean) => void] => {\n  const store = useViewerStore()\n  const visible = useStore(store, state => state.visible)\n  return useMemo(() => {\n    return [visible, (visible: boolean) => store.setState({ visible })]\n  }, [store, visible])\n}\n","import { useLocale } from '@editablejs/editor'\nimport { CloseIcon, Tooltip } from '@editablejs/ui'\nimport { FC } from 'react'\nimport { OverlayRenderProps } from 'react-image-previewer'\nimport {\n  CloseButton,\n  SlideToolbar,\n  DragToolbar,\n  DragArrowLeft,\n  DragArrowRight,\n  DragZoomOut,\n  DragZoomIn,\n  DragOneToOne,\n  DragDownload,\n  DragRotateLeft,\n  DragRotateRight,\n} from 'react-image-previewer/ui'\nimport { IMAGE_KEY } from '../constants'\nimport { ImageLocale } from '../locale'\n\nexport const ViewerToolbar: FC<OverlayRenderProps> = props => {\n  const { mode, index, images, onClose } = props\n  const count = images.length\n  const isFirst = index === 0\n  const isLast = index === count - 1\n\n  const { viewer: viewerLocale } = useLocale<ImageLocale>(IMAGE_KEY)\n\n  if (mode === 'slide') {\n    return (\n      <>\n        <SlideToolbar {...props} />\n        <CloseButton onClick={onClose} />\n      </>\n    )\n  }\n\n  return (\n    <>\n      <DragToolbar\n        {...props}\n        items={[\n          {\n            key: 'arrowLeft',\n            component: props => (\n              <Tooltip content={isFirst ? viewerLocale.arrowLeftDisabled : viewerLocale.arrowLeft}>\n                <a>\n                  <DragArrowLeft {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          'countText',\n          {\n            key: 'arrowRight',\n            component: props => (\n              <Tooltip content={isLast ? viewerLocale.arrowRightDisabled : viewerLocale.arrowRight}>\n                <a>\n                  <DragArrowRight {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          'split',\n          {\n            key: 'zoomOut',\n            component: props => (\n              <Tooltip content={viewerLocale.zoomOut}>\n                <a>\n                  <DragZoomOut {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          'scaleCount',\n          {\n            key: 'zoomIn',\n            component: props => (\n              <Tooltip content={viewerLocale.zoomIn}>\n                <a>\n                  <DragZoomIn {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          {\n            key: 'oneToOne',\n            component: props => (\n              <Tooltip content={viewerLocale.oneToOne}>\n                <a>\n                  <DragOneToOne {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          'split',\n          {\n            key: 'download',\n            component: props => (\n              <Tooltip content={viewerLocale.download}>\n                <a>\n                  <DragDownload {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          'split',\n          {\n            key: 'rotateLeft',\n            component: props => (\n              <Tooltip content={viewerLocale.rotateLeft}>\n                <a>\n                  <DragRotateLeft {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          {\n            key: 'rotateRight',\n            component: props => (\n              <Tooltip content={viewerLocale.rotateRight}>\n                <a>\n                  <DragRotateRight {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n        ]}\n      />\n      <CloseButton onClick={onClose}>\n        <Tooltip content={viewerLocale.close}>\n          <a>\n            <CloseIcon />\n          </a>\n        </Tooltip>\n      </CloseButton>\n    </>\n  )\n}\n","import { Editable, Hotkey } from '@editablejs/editor'\nimport { Editor, Element, Range, Point, Transforms, Text, Path } from '@editablejs/models'\nimport { ImageEditor } from './image-editor'\n\nconst findMatchedRange = (editor: Editor, at: Point) => {\n  const [startText] = Editor.nodes<Text>(editor, {\n    at,\n    match: n => Text.isText(n),\n  })\n  if (!startText) return\n\n  const block = Editor.above(editor, {\n    at,\n    match: n => Element.isElement(n) && Editor.isBlock(editor, n),\n  })\n\n  const path = block ? block[1] : []\n\n  const start = Editor.start(editor, path)\n  const range = { anchor: at, focus: start }\n  const beforeText = Editor.string(editor, range)\n  const reg = /!\\[(.*)\\]\\((.*)\\)$/\n  let match = beforeText.match(reg)\n  if (match && match.length > 1) {\n    const title = match[1]\n    const url = match[2]\n    const matchedTexts = Editor.nodes<Text>(editor, {\n      at: range,\n      match: (n, p) => Text.isText(n) && (n === startText[0] || Path.isBefore(p, startText[1])),\n      reverse: true,\n    })\n    let content = ''\n    for (const [text, path] of matchedTexts) {\n      if (text === startText[0]) {\n        content = text.text.slice(0, at.offset)\n      } else {\n        content = text.text + content\n      }\n      match = content.match(reg)\n      if (match && match.length > 1) {\n        const offset = match.index ?? 0\n        return {\n          title,\n          url,\n          range: { anchor: { path, offset }, focus: at },\n        }\n      }\n    }\n  }\n}\nexport const withShortcuts = (editor: Editable) => {\n  const { onKeydown } = editor\n\n  editor.onKeydown = event => {\n    const { selection } = editor\n    if (\n      selection &&\n      Range.isCollapsed(selection) &&\n      !Editable.isComposing(editor) &&\n      Hotkey.match('space', event)\n    ) {\n      const anchor = Range.start(selection)\n      const match = findMatchedRange(editor, anchor)\n      if (match) {\n        event.preventDefault()\n        const { range, url } = match\n        Transforms.delete(editor, {\n          at: range,\n        })\n        Transforms.collapse(editor)\n        ImageEditor.insert(editor, {\n          file: url,\n        })\n        return\n      }\n    }\n    onKeydown(event)\n  }\n}\n"],"mappings":"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","names":["Editable","Hotkey","Editor","Transforms","Editable","Editor","Transforms","useMemo","Editor","Editor","image","Editor","Editor","path","useMemo","url","Editable","Editor","width","height","Transforms","rotate","locale","_styledstyled_components","Icon","React","useMemo","useMemo","useEditableStatic","useMemo","useEditableStatic","useMemo","useMemo","index","useMemo","useStore","useStore","useMemo","visible","useLocale","Tooltip","jsx","jsxs","useLocale","props","Tooltip","jsx","_styled","_styledstyled_components","React","useMemo","jsx","_styled","Icon","Editable","Editor","Transforms","Path","Editor","Path","path","Editable","Transforms","jsx","Editor","Transforms","Editable","Hotkey"]}
\ No newline at end of file
+{"version":3,"sources":["../src/plugin/image-editor.ts","../src/plugin/with-image.tsx","../src/components/image.tsx","../src/hooks/use-viewer.ts","../src/create-viewer.tsx","../src/store/viewer.ts","../src/utils.ts","../src/locale/zh_CN.ts","../src/locale/en_US.ts","../src/locale/index.ts","../src/components/viewer.tsx","../src/hooks/use-viewer-index.ts","../src/hooks/use-viewer-store.ts","../src/hooks/use-viewer-visible.ts","../src/components/viewer-toolbar.tsx","../src/plugin/with-shortcuts.ts"],"sourcesContent":["import { Editor } from '@editablejs/models'\nimport { IMAGE_KEY } from '../constants'\nimport { Image, ImageStyle } from '../interfaces/image'\nimport { getOptions } from '../options'\n\nexport interface InsertImageOptions {\n  file: File | string\n}\nexport interface OpenImageOptions extends Omit<InsertImageOptions, 'file'> {\n  accept?: string\n  multiple?: boolean\n}\n\nexport interface ImageEditor extends Editor {\n  openImage: (options?: OpenImageOptions) => void\n\n  insertImage: (options: InsertImageOptions) => Promise<void>\n\n  rotateImage: (rotate: number, image: Image) => void\n\n  setStyleImage: (style: ImageStyle, image: Image) => void\n}\n\nexport const ImageEditor = {\n  isImageEditor: (editor: Editor): editor is ImageEditor => {\n    return !!(editor as ImageEditor).openImage\n  },\n\n  isImage: (editor: Editor, n: any): n is Image => {\n    return Image.isImage(n)\n  },\n\n  isActive: (editor: Editor) => {\n    const elements = Editor.elements(editor)\n    return !!elements[IMAGE_KEY]\n  },\n\n  getOptions,\n\n  open: (editor: Editor, options?: OpenImageOptions) => {\n    if (ImageEditor.isImageEditor(editor)) editor.openImage(options)\n  },\n\n  insert: (editor: Editor, options: InsertImageOptions) => {\n    if (ImageEditor.isImageEditor(editor)) editor.insertImage(options)\n  },\n\n  rotate: (editor: Editor, rotate: number, image: Image) => {\n    if (ImageEditor.isImageEditor(editor)) editor.rotateImage(rotate, image)\n  },\n\n  setStyle: (editor: Editor, style: ImageStyle, image: Image) => {\n    if (ImageEditor.isImageEditor(editor)) editor.setStyleImage(style, image)\n  },\n}\n","import { Editable, Hotkey, Locale, Slot } from '@editablejs/editor'\nimport { Editor, Operation, Transforms } from '@editablejs/models'\nimport { withHistoryProtocol } from '@editablejs/protocols/history'\nimport { openFileDialog } from '@editablejs/ui'\nimport { setOptions, ImageHotkey, ImageOptions } from '../options'\nimport { Image } from '../interfaces/image'\nimport { ImageComponent } from '../components/image'\nimport { ImageEditor } from './image-editor'\nimport locale from '../locale'\nimport {\n  insertImage,\n  readImageFileInfo,\n  uploadImage,\n  rotateImgWithCanvas,\n  readImageElement,\n} from '../utils'\nimport { ImageViewer } from '../components/viewer'\nimport { withShortcuts } from './with-shortcuts'\n\nconst defaultHotkey: ImageHotkey = ''\n\nconst defaultBeforeUpload = (files: File[]) => {\n  return files.filter(file => file.type.startsWith('image/'))\n}\n\nexport const withImage = <T extends Editable>(editor: T, options: ImageOptions = {}) => {\n  const newEditor = editor as T & ImageEditor\n\n  setOptions(newEditor, options)\n\n  const { isInline, isVoid } = newEditor\n  const historyProtocol = withHistoryProtocol(newEditor)\n  const { capture } = historyProtocol\n\n  historyProtocol.capture = (op: Operation) => {\n    if (op.type === 'set_node') {\n      const { path, newProperties } = op\n      if (Editor.hasPath(editor, path)) {\n        const image = Editor.node(editor, path)\n        if (Image.isImage(image[0])) {\n          const prop = newProperties as Partial<Image>\n          if (prop.url || prop.state || prop.percentage) {\n            return false\n          }\n        }\n      }\n    }\n    return capture(op)\n  }\n\n  const { locale: localeOptions = {} } = options\n  Locale.setLocale(newEditor, locale, localeOptions)\n\n  Slot.mount(newEditor, ImageViewer)\n\n  newEditor.isInline = element => {\n    return ImageEditor.isImage(newEditor, element) || isInline(element)\n  }\n\n  newEditor.isVoid = element => {\n    return ImageEditor.isImage(newEditor, element) || isVoid(element)\n  }\n\n  const insertImages = (files: (File | string)[]) => {\n    Promise.all(\n      files.map(file =>\n        typeof file === 'string' ? Promise.resolve(file) : readImageFileInfo(file),\n      ),\n    ).then(items => {\n      items.forEach(item => {\n        if (!item) return\n        if (typeof item === 'string') return newEditor.insertImage({ file: item })\n        const { url, file, width, height } = item\n        const path = insertImage(newEditor, {\n          url,\n          width,\n          height,\n          name: file.name,\n          state: 'uploading',\n        })\n        uploadImage(editor, path, file).then(() => {\n          URL.revokeObjectURL(url)\n        })\n      })\n    })\n  }\n  const { onUploadBefore = defaultBeforeUpload } = options\n\n  newEditor.openImage = ({ accept = 'image/*', multiple = false } = {}) => {\n    if (!newEditor.selection) {\n      newEditor.focus(false)\n    }\n\n    openFileDialog({\n      accept,\n      multiple,\n      onChange: files => {\n        const customFiles = onUploadBefore(files)\n        if (customFiles.length > 0) insertImages(files)\n      },\n    })\n  }\n\n  newEditor.insertImage = async ({ file }) => {\n    if (!newEditor.selection) {\n      newEditor.focus(false)\n    }\n\n    const url = file instanceof File ? URL.createObjectURL(file) : file\n    editor.normalizeSelection(selection => {\n      if (editor.selection !== selection) editor.selection = selection\n      const path = insertImage(editor, {\n        url,\n        state: 'uploading',\n      })\n\n      return uploadImage(editor, path, file)\n    })\n  }\n\n  newEditor.rotateImage = (rotate, image) => {\n    const { onRotate, allowRotate } = options\n    const { url, state } = image\n    if (state !== 'done') return\n    const degrees = rotate % -360\n    if (onRotate && url && allowRotate !== false) {\n      readImageElement(url, true).then(img => {\n        rotateImgWithCanvas(img, degrees).then(blob => {\n          const file = new File([blob], image.name ?? 'rotate.png', { type: 'image/png' })\n          onRotate(file).then(res => {\n            if (res) {\n              const info = typeof res === 'string' ? { url: res, rotate: 0 } : res\n              Transforms.setNodes<Image>(\n                editor,\n                {\n                  rotate: info.rotate,\n                  url: info.url,\n                },\n                {\n                  at: Editable.findPath(editor, image),\n                },\n              )\n            }\n          })\n        })\n      })\n    }\n    Transforms.setNodes<Image>(\n      editor,\n      {\n        rotate,\n      },\n      {\n        at: Editable.findPath(editor, image),\n      },\n    )\n  }\n\n  newEditor.setStyleImage = (style, image) => {\n    Transforms.setNodes<Image>(\n      editor,\n      {\n        style,\n      },\n      {\n        at: Editable.findPath(editor, image),\n      },\n    )\n  }\n\n  const { renderElement } = newEditor\n  newEditor.renderElement = ({ element, attributes, children }) => {\n    if (ImageEditor.isImage(editor, element)) {\n      return (\n        <ImageComponent {...attributes} element={element} editor={newEditor}>\n          {children}\n        </ImageComponent>\n      )\n    }\n    return renderElement({ attributes, children, element })\n  }\n\n  const hotkey = options.hotkey ?? defaultHotkey\n  const { onKeydown, insertFile } = newEditor\n  newEditor.onKeydown = (e: KeyboardEvent) => {\n    if (Hotkey.match(hotkey, e)) {\n      e.preventDefault()\n      newEditor.openImage()\n      return\n    }\n\n    onKeydown(e)\n  }\n\n  newEditor.insertFile = (file, at) => {\n    const customFiles = onUploadBefore([file])\n    if (customFiles.length > 0) {\n      if (at) {\n        Transforms.select(newEditor, at)\n      }\n      insertImages(customFiles)\n      return\n    }\n    insertFile(file, at)\n  }\n\n  const { shortcuts } = options\n  if (shortcuts !== false) {\n    withShortcuts(newEditor)\n  }\n  return newEditor\n}\n","import _styled12styled_components from 'styled-components';\n            const _styled12 = typeof _styled12styled_components.default === 'undefined' ? _styled12styled_components : _styled12styled_components.default;;\nimport _styled11styled_components from 'styled-components';\n            const _styled11 = typeof _styled11styled_components.default === 'undefined' ? _styled11styled_components : _styled11styled_components.default;;\nimport _styled10styled_components from 'styled-components';\n            const _styled10 = typeof _styled10styled_components.default === 'undefined' ? _styled10styled_components : _styled10styled_components.default;;\nimport _styled9styled_components from 'styled-components';\n            const _styled9 = typeof _styled9styled_components.default === 'undefined' ? _styled9styled_components : _styled9styled_components.default;;\nimport _styled8styled_components from 'styled-components';\n            const _styled8 = typeof _styled8styled_components.default === 'undefined' ? _styled8styled_components : _styled8styled_components.default;;\nimport _styled7styled_components from 'styled-components';\n            const _styled7 = typeof _styled7styled_components.default === 'undefined' ? _styled7styled_components : _styled7styled_components.default;;\nimport _styled6styled_components from 'styled-components';\n            const _styled6 = typeof _styled6styled_components.default === 'undefined' ? _styled6styled_components : _styled6styled_components.default;;\nimport _styled5styled_components from 'styled-components';\n            const _styled5 = typeof _styled5styled_components.default === 'undefined' ? _styled5styled_components : _styled5styled_components.default;;\nimport _styled4styled_components from 'styled-components';\n            const _styled4 = typeof _styled4styled_components.default === 'undefined' ? _styled4styled_components : _styled4styled_components.default;;\nimport _styled3styled_components from 'styled-components';\n            const _styled3 = typeof _styled3styled_components.default === 'undefined' ? _styled3styled_components : _styled3styled_components.default;;\nimport _styled2styled_components from 'styled-components';\n            const _styled2 = typeof _styled2styled_components.default === 'undefined' ? _styled2styled_components : _styled2styled_components.default;;\nimport _styledstyled_components from 'styled-components';\n            const _styled = typeof _styledstyled_components.default === 'undefined' ? _styledstyled_components : _styledstyled_components.default;;\nimport { css as _css } from \"styled-components\";\nimport { Editable, useLocale, useNodeFocused, useReadOnly } from '@editablejs/editor';\nimport { Editor, Transforms } from '@editablejs/models';\nimport { Icon, Popover, PopoverContent, PopoverTrigger, Resizer, Toolbar, ToolbarButton, ToolbarDropdown, Tooltip, useIsomorphicLayoutEffect } from '@editablejs/ui';\nimport React, { forwardRef, useEffect, useMemo, useRef, useState } from 'react';\nimport { DATA_IMAGE_KEY } from '../constants';\nimport { useViewer } from '../hooks/use-viewer';\nimport { getOptions } from '../options';\nimport { readImageElement, rotateImgWithCanvas, uploadImage } from '../utils';\nexport const ImageComponent = forwardRef(({\n  children,\n  element,\n  editor,\n  ...props\n}, ref) => {\n  const {\n    url,\n    state,\n    rotate,\n    errorMessage,\n    percentage,\n    width,\n    height\n  } = element;\n  const [errorMsg, setErrorMsg] = useState(errorMessage);\n  const [loading, setLoading] = useState(true);\n  const [loaded, setLoaded] = useState(false);\n  const [src, setSrc] = useState('');\n  const [rotatedUrl, setRotatedUrl] = useState('');\n  const [imageDOMElement, setImageDOMElement] = useState(null);\n  const [readOnly] = useReadOnly();\n  const options = useMemo(() => {\n    return getOptions(editor);\n  }, [editor]);\n  const viewer = useViewer();\n  useIsomorphicLayoutEffect(() => {\n    if (options.onBeforeRender && url && state === 'done') {\n      options.onBeforeRender(url).then(url => {\n        setSrc(url);\n      }).catch(err => {\n        setErrorMsg(err.message);\n      }).finally(() => {\n        setLoading(false);\n      });\n    } else if (url && state === 'waitingUpload') {\n      uploadImage(editor, Editable.findPath(editor, element), url);\n    } else if (url) {\n      setSrc(url);\n      setLoading(false);\n    }\n  }, [url, state]);\n  useIsomorphicLayoutEffect(() => {\n    if (src) {\n      readImageElement(src).then(image => {\n        setLoaded(true);\n        setImageDOMElement(image);\n      }).catch(err => {\n        if (state === 'done') setErrorMsg(typeof err === 'object' ? err.message : err);\n      });\n    }\n  }, [src, state]);\n  useEffect(() => {\n    if (!imageDOMElement) {\n      return setRotatedUrl('');\n    }\n\n    if (rotate !== undefined && loaded && state === 'done' && options.allowRotate !== false) {\n      readImageElement(imageDOMElement.src, true).then(img => {\n        rotateImgWithCanvas(img, rotate).then(blob => {\n          setRotatedUrl(URL.createObjectURL(blob));\n        });\n      });\n    }\n  }, [imageDOMElement, rotate, state, loaded, options.allowRotate]);\n  useEffect(() => {\n    return () => {\n      if (rotatedUrl) {\n        URL.revokeObjectURL(rotatedUrl);\n      }\n    };\n  }, [rotatedUrl]);\n  const [maxWidth, setMaxWidth] = useState(0);\n  useEffect(() => {\n    const path = Editable.findPath(editor, element);\n    const parentEntry = Editor.above(editor, {\n      at: path,\n      match: n => Editor.isBlock(editor, n),\n      mode: 'lowest'\n    });\n\n    if (parentEntry) {\n      const parentEl = Editable.toDOMNode(editor, parentEntry[0]);\n      setMaxWidth(parentEl.clientWidth);\n    }\n  }, [editor, element]);\n  const focused = useNodeFocused();\n  const isUploading = state === 'uploading' || state === 'waitingUpload';\n\n  const renderUploading = () => {\n    if (!isUploading) return null;\n    return <_StyledDiv>\n          {percentage !== undefined && <_StyledDiv2 $_css2={[{\n        \"position\": \"relative\",\n        \"height\": \"0.5rem\",\n        \"width\": \"33.333333%\",\n        \"overflow\": \"hidden\",\n        \"borderRadius\": \"0.25rem\",\n        \"backgroundColor\": \"rgb(156 163 175 / 0.3)\"\n      }, _css([\"min-width:8px;\"])]}>\n              <_StyledDiv3 style={{\n          width: `${percentage}%`\n        }}></_StyledDiv3>\n            </_StyledDiv2>}\n          {percentage === undefined && <Icon name=\"loading\" />}\n        </_StyledDiv>;\n  };\n\n  const renderLoading = () => {\n    if (!loading || loaded) return null;\n    return <_StyledDiv4>\n          <Icon name=\"loading\" />\n        </_StyledDiv4>;\n  };\n\n  const isError = state === 'error' || !!errorMsg;\n\n  const renderError = () => {\n    if (!isError) return null;\n    return <_StyledSpan>\n          <span>{errorMsg || 'Image error.'}</span>\n        </_StyledSpan>;\n  };\n\n  const renderImage = () => {\n    if (isError || !src || !loaded) return null;\n    const atts = {\n      [DATA_IMAGE_KEY]: Editable.findKey(editor, element).id\n    };\n    return <_StyledImg {...atts} alt=\"\" draggable={false} src={rotatedUrl || src} $_css3={[{\n      \"display\": \"inline-block\",\n      \"height\": \"100%\",\n      \"width\": \"100%\",\n      \"borderRadius\": \"0.25rem\",\n      \"verticalAlign\": \"baseline\"\n    }, isUploading && {\n      \"opacity\": \"0.3\"\n    }]} />;\n  };\n\n  const handleResizeChange = (width, height) => {\n    Transforms.setNodes(editor, {\n      width,\n      height\n    }, {\n      at: Editable.findPath(editor, element)\n    });\n  };\n\n  const isFocusedMouseDownBefore = useRef(false);\n\n  const handleImageDown = () => {\n    isFocusedMouseDownBefore.current = focused;\n  };\n\n  const handleImageClick = event => {\n    if (isFocusedMouseDownBefore.current && !event.defaultPrevented && isDone && loaded) {\n      viewer.open(element);\n    }\n  };\n\n  const renderStyleStroke = () => {\n    if (element.style !== 'stroke') return null;\n    return <_StyledDiv5 />;\n  };\n\n  const changeStyle = style => {\n    editor.setStyleImage(style, element);\n  };\n\n  const changeRotate = rotate => {\n    if (Math.abs(rotate) === 360) {\n      rotate = 0;\n    }\n\n    editor.rotateImage(rotate, element);\n  };\n\n  const isDone = state === 'done';\n  const autoSize = useMemo(() => {\n    if (height === undefined || width === undefined) return undefined;\n    const ratio = height / width;\n\n    if (width > maxWidth && maxWidth > 0) {\n      return [maxWidth, maxWidth * ratio];\n    }\n\n    return [width, height];\n  }, [width, height, loaded, maxWidth]);\n  const size = autoSize || [width, height];\n  const [popoverOpen, setPopoverOpen] = useState(false);\n\n  const handlePopoverOpenChange = open => {\n    if (focused) {\n      setPopoverOpen(true);\n    } else {\n      setPopoverOpen(open);\n    }\n  };\n\n  useIsomorphicLayoutEffect(() => {\n    setPopoverOpen(focused);\n  }, [focused]);\n  const {\n    style: styleLocale,\n    viewer: viewerLocale\n  } = useLocale('image');\n  return <Popover open={isDone && !readOnly ? popoverOpen : false} onOpenChange={handlePopoverOpenChange} trigger=\"hover\">\n        <PopoverTrigger asChild>\n          <_StyledDiv6 {...props} ref={ref} $_css4={[{\n        \"position\": \"relative\",\n        \"display\": \"inline-block\",\n        \"maxWidth\": \"100%\",\n        \"cursor\": \"default\",\n        \"borderRadius\": \"0.25rem\",\n        \"borderWidth\": \"1px\",\n        \"borderColor\": \"transparent\",\n        \"lineHeight\": \"0\"\n      }, element.style === 'shadow' && {\n        \"--tw-shadow\": \"0 2px 6px 2px rgb(60 64 67 / 15%)\",\n        \"--tw-shadow-colored\": \"0 2px 6px 2px var(--tw-shadow-color)\",\n        \"boxShadow\": \"var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)\"\n      }, focused && isDone && {\n        \"cursor\": \"zoom-in\"\n      }, !loaded && {\n        \"--tw-bg-opacity\": \"1\",\n        \"backgroundColor\": \"rgb(243 244 246 / var(--tw-bg-opacity))\"\n      }, !focused && isDone && popoverOpen && {\n        \"--tw-border-opacity\": \"1\",\n        \"borderColor\": \"rgb(64 150 255 / var(--tw-border-opacity))\"\n      }, (loading || isUploading || isError) && {\n        \"lineHeight\": \"inherit\"\n      }]}>\n            <_StyledDiv7 style={{\n          width: isError ? undefined : size[0] || 'auto',\n          height: loaded || isError ? undefined : size[1] || 'auto'\n        }}>\n              <_StyledDiv8 style={{\n            width: '100%'\n          }} onMouseDown={handleImageDown} onClick={handleImageClick}>\n                {renderImage()}\n                {renderStyleStroke()}\n                <_StyledDiv9>{children}</_StyledDiv9>\n                {renderUploading()}\n                {renderError()}\n                {renderLoading()}\n              </_StyledDiv8>\n              {focused && !readOnly && !isError && <_StyledResizer onChange={handleResizeChange} previewImage={isDone && loaded ? rotatedUrl || src : undefined} holders={isDone ? undefined : []} />}\n            </_StyledDiv7>\n          </_StyledDiv6>\n        </PopoverTrigger>\n        <PopoverContent autoUpdate={true} side=\"top\" sideOffset={5}>\n          <Toolbar mode=\"inline\">\n            {options.allowRotate !== false && <Tooltip content={viewerLocale.rotateLeft} side=\"top\" sideOffset={5} arrow={false}>\n                <ToolbarButton icon={<Icon name=\"rotateLeft\" />} onToggle={() => changeRotate((rotate ?? 0) - 90)} />\n              </Tooltip>}\n            <Tooltip content={styleLocale.tooltip} side=\"top\" sideOffset={5} arrow={false}>\n              <ToolbarDropdown onSelect={value => changeStyle(value)} value={element.style || 'none'} items={[{\n            value: 'none',\n            content: styleLocale.none\n          }, {\n            value: 'stroke',\n            content: styleLocale.stroke\n          }, {\n            value: 'shadow',\n            content: styleLocale.shadow\n          }]}>\n                {styleLocale.title}\n              </ToolbarDropdown>\n            </Tooltip>\n          </Toolbar>\n        </PopoverContent>\n      </Popover>;\n});\nImageComponent.displayName = 'ImageComponent';\n\nvar _StyledDiv = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-0\"\n})({\n  \"position\": \"absolute\",\n  \"left\": \"0px\",\n  \"top\": \"0px\",\n  \"display\": \"flex\",\n  \"height\": \"100%\",\n  \"width\": \"100%\",\n  \"alignItems\": \"center\",\n  \"justifyContent\": \"center\",\n  \"--tw-text-opacity\": \"1\",\n  \"color\": \"rgb(64 150 255 / var(--tw-text-opacity))\"\n});\n\nvar _StyledDiv2 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-1\"\n})([\"\", \"\"], p => p.$_css2);\n\nvar _StyledDiv3 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-2\"\n})({\n  \"position\": \"absolute\",\n  \"left\": \"0px\",\n  \"top\": \"0px\",\n  \"height\": \"100%\",\n  \"@keyframes pulse\": {\n    \"50%\": {\n      \"opacity\": \".5\"\n    }\n  },\n  \"animation\": \"pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite\",\n  \"--tw-bg-opacity\": \"1\",\n  \"backgroundColor\": \"rgb(64 150 255 / var(--tw-bg-opacity))\"\n});\n\nvar _StyledDiv4 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-3\"\n})({\n  \"position\": \"absolute\",\n  \"left\": \"0px\",\n  \"top\": \"0px\",\n  \"display\": \"flex\",\n  \"height\": \"100%\",\n  \"width\": \"100%\",\n  \"alignItems\": \"center\",\n  \"justifyContent\": \"center\",\n  \"--tw-text-opacity\": \"1\",\n  \"color\": \"rgb(64 150 255 / var(--tw-text-opacity))\"\n});\n\nvar _StyledSpan = _styled(\"span\").withConfig({\n  componentId: \"sc-1385wrh-4\"\n})({\n  \"borderRadius\": \"0.25rem\",\n  \"borderWidth\": \"1px\",\n  \"--tw-border-opacity\": \"1\",\n  \"borderColor\": \"rgb(209 213 219 / var(--tw-border-opacity))\",\n  \"paddingLeft\": \"0.5rem\",\n  \"paddingRight\": \"0.5rem\",\n  \"paddingTop\": \"0.125rem\",\n  \"paddingBottom\": \"0.125rem\",\n  \"verticalAlign\": \"baseline\",\n  \"fontSize\": \"12px\",\n  \"--tw-text-opacity\": \"1\",\n  \"color\": \"rgb(239 68 68 / var(--tw-text-opacity))\"\n});\n\nvar _StyledImg = _styled(\"img\").withConfig({\n  componentId: \"sc-1385wrh-5\"\n})([\"\", \"\"], p => p.$_css3);\n\nvar _StyledDiv5 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-6\"\n})({\n  \"pointerEvents\": \"none\",\n  \"position\": \"absolute\",\n  \"top\": \"0px\",\n  \"right\": \"0px\",\n  \"bottom\": \"0px\",\n  \"left\": \"0px\",\n  \"height\": \"100%\",\n  \"width\": \"100%\",\n  \"borderRadius\": \"0.25rem\",\n  \"borderWidth\": \"1px\",\n  \"--tw-border-opacity\": \"1\",\n  \"borderColor\": \"rgb(209 213 219 / var(--tw-border-opacity))\"\n});\n\nvar _StyledDiv6 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-7\"\n})([\"\", \"\"], p => p.$_css4);\n\nvar _StyledDiv7 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-8\"\n})({\n  \"display\": \"inline-block\",\n  \"height\": \"auto\",\n  \"minHeight\": \"24px\",\n  \"minWidth\": \"24px\",\n  \"maxWidth\": \"100%\"\n});\n\nvar _StyledDiv8 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-9\"\n})({\n  \"display\": \"inline-block\",\n  \"maxWidth\": \"100%\"\n});\n\nvar _StyledDiv9 = _styled(\"div\").withConfig({\n  componentId: \"sc-1385wrh-10\"\n})({\n  \"position\": \"absolute\",\n  \"display\": \"none\"\n});\n\nvar _StyledResizer = _styled(Resizer).withConfig({\n  componentId: \"sc-1385wrh-11\"\n})({\n  \"borderRadius\": \"0.25rem\"\n});","import { useEditableStatic } from '@editablejs/editor'\nimport { useMemo } from 'react'\nimport { getViewer } from '../create-viewer'\n\nexport const useViewer = () => {\n  const editor = useEditableStatic()\n\n  return useMemo(() => getViewer(editor), [editor])\n}\n","import { Editable } from '@editablejs/editor'\nimport { Editor } from '@editablejs/models'\nimport { DataType } from 'react-image-previewer'\nimport { DATA_IMAGE_KEY } from './constants'\nimport { Image } from './interfaces/image'\nimport { getViewerStore } from './store'\n\nconst IMAGES_CACHE_WEAKMAP = new WeakMap<Editor, DataType[]>()\n\nconst findImages = (editor: Editable, force = false) => {\n  const caches = IMAGES_CACHE_WEAKMAP.get(editor)\n  if (caches && !force) return caches\n  const images: DataType[] = []\n  const nodes = Editor.nodes(editor, {\n    at: [],\n    match: node => Image.isImage(node) && !!node.url,\n  })\n\n  for (const [node] of nodes) {\n    const key = Editable.findKey(editor, node).id\n    const el = Editable.toDOMNode(editor, node)\n    const image = el.querySelector(`img[${DATA_IMAGE_KEY}=\"${key}\"]`)\n    if (!image) continue\n    const src = image.getAttribute('src')\n    if (!src) continue\n    images.push({\n      key,\n      src,\n    })\n  }\n  IMAGES_CACHE_WEAKMAP.set(editor, images)\n  return images\n}\n\nexport const VIEWER_CACHE_WEAKMAP = new WeakMap<Editor, ReturnType<typeof createViewer>>()\n\nconst createViewer = (editor: Editable) => {\n  const viewer = {\n    images: (force = false) => findImages(editor, force),\n\n    count: () => {\n      return viewer.images().length\n    },\n\n    open: (image: Image) => {\n      const store = getViewerStore(editor)\n      const images = viewer.images(true)\n      const key = Editable.findKey(editor, image).id\n      return store.setState({\n        visible: true,\n        index: images.findIndex(image => image.key === key),\n      })\n    },\n\n    close: () => {\n      const store = getViewerStore(editor)\n      store.setState({\n        visible: false,\n        index: -1,\n      })\n    },\n\n    prev: () => {\n      const store = getViewerStore(editor)\n      const count = viewer.count()\n      const index = store.getState().index\n      let val = index - 1\n      if (val < 0) val = count - 1\n      store.setState({\n        index: val,\n      })\n    },\n\n    next: () => {\n      const store = getViewerStore(editor)\n      const count = viewer.count()\n      const index = store.getState().index\n      let val = index + 1\n      if (val === count) val = 0\n      store.setState({\n        index: val,\n      })\n    },\n  }\n  return viewer\n}\n\nexport const getViewer = (editor: Editable) => {\n  let viewer = VIEWER_CACHE_WEAKMAP.get(editor)\n  if (viewer) {\n    return viewer\n  }\n  viewer = createViewer(editor)\n  VIEWER_CACHE_WEAKMAP.set(editor, viewer)\n  return viewer\n}\n","import { Editor } from '@editablejs/models'\nimport create, { StoreApi, UseBoundStore } from 'zustand'\nexport interface ImageViewerStore {\n  visible: boolean\n  index: number\n}\n\nconst EDITOR_TO_IMAGE_STORE = new WeakMap<Editor, UseBoundStore<StoreApi<ImageViewerStore>>>()\n\nexport const getViewerStore = (editor: Editor) => {\n  let store = EDITOR_TO_IMAGE_STORE.get(editor)\n  if (!store) {\n    store = create<ImageViewerStore>(() => ({\n      visible: false,\n      index: 0,\n    }))\n    EDITOR_TO_IMAGE_STORE.set(editor, store)\n  }\n  return store\n}\n","import { Editor, Path, Transforms } from '@editablejs/models'\nimport { IMAGE_KEY } from './constants'\nimport { Image } from './interfaces/image'\nimport { getOptions } from './options'\n\nconst readBase64WithFileReader = (file: File) => {\n  return new Promise<string>((resolve, reject) => {\n    const reader = new FileReader()\n    reader.readAsDataURL(file)\n    reader.onload = () => {\n      resolve(reader.result as string)\n    }\n    reader.onerror = error => {\n      reject(error)\n    }\n  })\n}\n\nconst readBase64WithFetch = (url: string) => {\n  return new Promise<string>((resolve, reject) => {\n    const xhr = new XMLHttpRequest()\n    xhr.onload = () => {\n      const reader = new FileReader()\n      reader.onloadend = () => {\n        resolve(reader.result as string)\n      }\n      reader.onerror = error => {\n        reject(error)\n      }\n      reader.readAsDataURL(xhr.response)\n    }\n    xhr.open('GET', url)\n    xhr.responseType = 'blob'\n    xhr.send()\n  })\n}\n\nexport const readBase64 = (file: File | string) => {\n  return typeof file === 'string' ? readBase64WithFetch(file) : readBase64WithFileReader(file)\n}\n\nexport const readImageElement = (url: string, base64 = false) => {\n  return new Promise<HTMLImageElement>(async (resolve, reject) => {\n    if (base64) url = await readBase64(url)\n    const image = new window.Image()\n    image.onload = () => {\n      resolve(image)\n    }\n    image.onerror = () => {\n      reject('image load error')\n    }\n    image.src = url\n  })\n}\n\ninterface ReadImageFileInfo {\n  url: string\n  file: File\n  width: number\n  height: number\n}\n\nexport const readImageFileInfo = (file: File) => {\n  return new Promise<ReadImageFileInfo | null>(resolve => {\n    const url = URL.createObjectURL(file)\n    readImageElement(url)\n      .then(image => {\n        resolve({\n          width: image.naturalWidth,\n          height: image.naturalHeight,\n          url,\n          file,\n        })\n      })\n      .catch(() => {\n        resolve(null)\n      })\n  })\n}\n\nexport const defaultUpload = (file: File | string) => {\n  return new Promise<string>((resolve, reject) => {\n    if (file instanceof File) {\n      readBase64(file).then(resolve).catch(reject)\n    } else {\n      resolve(file)\n    }\n  })\n}\n\nexport const setPercentage = (editor: Editor, path: Path, percentage: number) => {\n  Transforms.setNodes<Image>(editor, { percentage }, { at: path })\n}\n\nexport const insertImage = (editor: Editor, options: Partial<Image>) => {\n  const image: Image = {\n    type: IMAGE_KEY,\n    ...options,\n    children: [{ text: '' }],\n  }\n\n  Transforms.insertNodes(editor, image)\n  const entry = Editor.above(editor, {\n    match: n => Image.isImage(n),\n  })\n  if (!entry) throw new Error('image not found')\n  return entry[1]\n}\n\nexport const uploadImage = (editor: Editor, path: Path, file: File | string) => {\n  const options = getOptions(editor)\n  const promise = new Promise<void>(resolve => {\n    const pathRef = Editor.pathRef(editor, path)\n\n    const { onUpload = defaultUpload } = options\n    onUpload(file, ({ percentage }) => {\n      const path = pathRef.current\n      if (path) setPercentage(editor, path, percentage)\n    })\n      .then(url => {\n        const path = pathRef.current\n        if (path) Transforms.setNodes<Image>(editor, { url, state: 'done' }, { at: path })\n      })\n      .catch(err => {\n        const path = pathRef.current\n        if (path)\n          Transforms.setNodes<Image>(\n            editor,\n            { state: 'error', errorMessage: typeof err === 'string' ? err : err.message },\n            { at: path },\n          )\n      })\n      .finally(() => {\n        const path = pathRef.unref()\n\n        if (path) setPercentage(editor, path, 100)\n\n        resolve()\n      })\n  })\n  return promise\n}\n\nexport function rotateImgWithCanvas(image: HTMLImageElement, degrees: number): Promise<Blob> {\n  return new Promise((resolve, reject) => {\n    const canvas = document.createElement('canvas')\n    const ctx = canvas.getContext('2d')\n\n    if (!ctx || !image.height || !image.width) return\n    const horizontal = [-270, -90, 90, 270]\n    if (horizontal.includes(degrees)) {\n      canvas.width = image.naturalHeight || 0\n      canvas.height = image.naturalWidth || 0\n    } else {\n      canvas.width = image.naturalWidth || 0\n      canvas.height = image.naturalHeight || 0\n    }\n    ctx.translate(canvas.width / 2, canvas.height / 2)\n    ctx.rotate((degrees * Math.PI) / 180)\n    ctx.drawImage(image, -image.naturalWidth / 2, -image.naturalHeight / 2)\n    canvas.toBlob(blob => {\n      blob ? resolve(blob) : reject('blob is null')\n    }, 'image/jpeg')\n  })\n}\n","import { ImageLocale } from './types'\n\nconst locale: ImageLocale = {\n  locale: 'zh-CN',\n  image: {\n    viewer: {\n      arrowLeft: '',\n      arrowRight: '',\n      arrowLeftDisabled: '',\n      arrowRightDisabled: '',\n      close: '',\n      zoomIn: '',\n      zoomOut: '',\n      oneToOne: '',\n      rotateLeft: '',\n      rotateRight: '',\n      download: '',\n    },\n    style: {\n      title: '',\n      tooltip: '',\n      none: '',\n      stroke: '',\n      shadow: '',\n    },\n  },\n}\n\nexport default locale\n","import { ImageLocale } from './types'\n\nconst locale: ImageLocale = {\n  locale: 'en-US',\n  image: {\n    viewer: {\n      arrowLeft: 'Previous',\n      arrowRight: 'Next',\n      arrowLeftDisabled: 'Already the first one',\n      arrowRightDisabled: 'Already the last one',\n      close: 'Close',\n      zoomIn: 'Zoom in',\n      zoomOut: 'Zoom out',\n      oneToOne: 'Original size',\n      rotateLeft: 'Rotate left',\n      rotateRight: 'Rotate right',\n      download: 'Download',\n    },\n    style: {\n      title: 'Style',\n      tooltip: 'Image style',\n      none: 'None',\n      stroke: 'Stroke',\n      shadow: 'Shadow',\n    },\n  },\n}\n\nexport default locale\n","import zhCN from './zh_CN'\nimport enUS from './en_US'\nimport { ImageLocale } from './types'\n\nconst locales: Record<string, ImageLocale> = {\n  'en-US': enUS,\n  'zh-CN': zhCN,\n}\n\nexport type { ImageLocale }\n\nexport default locales\n","import _styledstyled_components from 'styled-components';\n            const _styled = typeof _styledstyled_components.default === 'undefined' ? _styledstyled_components : _styledstyled_components.default;;\nimport { isTouchDevice } from '@editablejs/editor';\nimport { Icon } from '@editablejs/ui';\nimport React, { useMemo } from 'react';\nimport { PhotoSlider } from 'react-image-previewer';\nimport { useViewer } from '../hooks/use-viewer';\nimport { useViewerIndex } from '../hooks/use-viewer-index';\nimport { useViewerVisible } from '../hooks/use-viewer-visible';\nimport { ViewerToolbar } from './viewer-toolbar';\nexport const ImageViewer = React.memo(() => {\n  const viewer = useViewer();\n  const [visible, setVisible] = useViewerVisible();\n  const [index, setIndex] = useViewerIndex();\n  const images = useMemo(() => {\n    return visible ? viewer.images() : [];\n  }, [visible, viewer]);\n  return <PhotoSlider mode=\"drag\" className='image-dialog' images={images} visible={visible} index={index} onIndexChange={setIndex} onClose={() => setVisible(false)} loop={true} pullClosable={false} maskOpacity={isTouchDevice ? 1 : 0.9} loadingElement={<_StyledIcon name=\"loading\" />} overlayRender={props => {\n    return <ViewerToolbar {...props} />;\n  }} />;\n});\nImageViewer.displayName = 'ImageViewer';\n\nvar _StyledIcon = _styled(Icon).withConfig({\n  componentId: \"sc-yrs7ly-0\"\n})({\n  \"fontSize\": \"24px\",\n  \"--tw-text-opacity\": \"1\",\n  \"color\": \"rgb(255 255 255 / var(--tw-text-opacity))\"\n});","import { useMemo } from 'react'\nimport { useStore } from 'zustand'\nimport { useViewerStore } from './use-viewer-store'\n\nexport const useViewerIndex = (): [number, (index: number) => void] => {\n  const store = useViewerStore()\n  const index = useStore(store, state => state.index)\n  return useMemo(() => [index, (index: number) => store.setState({ index })], [store, index])\n}\n","import { useEditableStatic } from '@editablejs/editor'\nimport { useMemo } from 'react'\nimport { getViewerStore } from '../store'\n\nexport const useViewerStore = () => {\n  const editor = useEditableStatic()\n  const store = useMemo(() => getViewerStore(editor), [editor])\n  return store\n}\n","import { useMemo } from 'react'\nimport { useStore } from 'zustand'\nimport { useViewerStore } from './use-viewer-store'\n\nexport const useViewerVisible = (): [boolean, (visible: boolean) => void] => {\n  const store = useViewerStore()\n  const visible = useStore(store, state => state.visible)\n  return useMemo(() => {\n    return [visible, (visible: boolean) => store.setState({ visible })]\n  }, [store, visible])\n}\n","import { useLocale } from '@editablejs/editor'\nimport { CloseIcon, Tooltip } from '@editablejs/ui'\nimport { FC } from 'react'\nimport { OverlayRenderProps } from 'react-image-previewer'\nimport {\n  CloseButton,\n  SlideToolbar,\n  DragToolbar,\n  DragArrowLeft,\n  DragArrowRight,\n  DragZoomOut,\n  DragZoomIn,\n  DragOneToOne,\n  DragDownload,\n  DragRotateLeft,\n  DragRotateRight,\n} from 'react-image-previewer/ui'\nimport { IMAGE_KEY } from '../constants'\nimport { ImageLocale } from '../locale'\n\nexport const ViewerToolbar: FC<OverlayRenderProps> = props => {\n  const { mode, index, images, onClose } = props\n  const count = images.length\n  const isFirst = index === 0\n  const isLast = index === count - 1\n\n  const { viewer: viewerLocale } = useLocale<ImageLocale>(IMAGE_KEY)\n\n  if (mode === 'slide') {\n    return (\n      <>\n        <SlideToolbar {...props} />\n        <CloseButton onClick={onClose} />\n      </>\n    )\n  }\n\n  return (\n    <>\n      <DragToolbar\n        className='drag-toolbar'\n        {...props}\n        items={[\n          {\n            key: 'arrowLeft',\n            component: props => (\n              <Tooltip content={isFirst ? viewerLocale.arrowLeftDisabled : viewerLocale.arrowLeft}>\n                <a>\n                  <DragArrowLeft {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          'countText',\n          {\n            key: 'arrowRight',\n            component: props => (\n              <Tooltip content={isLast ? viewerLocale.arrowRightDisabled : viewerLocale.arrowRight}>\n                <a>\n                  <DragArrowRight {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          'split',\n          {\n            key: 'zoomOut',\n            component: props => (\n              <Tooltip content={viewerLocale.zoomOut}>\n                <a>\n                  <DragZoomOut {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          'scaleCount',\n          {\n            key: 'zoomIn',\n            component: props => (\n              <Tooltip content={viewerLocale.zoomIn}>\n                <a>\n                  <DragZoomIn {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          {\n            key: 'oneToOne',\n            component: props => (\n              <Tooltip content={viewerLocale.oneToOne}>\n                <a>\n                  <DragOneToOne {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          'split',\n          {\n            key: 'download',\n            component: props => (\n              <Tooltip content={viewerLocale.download}>\n                <a>\n                  <DragDownload {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          'split',\n          {\n            key: 'rotateLeft',\n            component: props => (\n              <Tooltip content={viewerLocale.rotateLeft}>\n                <a>\n                  <DragRotateLeft {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n          {\n            key: 'rotateRight',\n            component: props => (\n              <Tooltip content={viewerLocale.rotateRight}>\n                <a>\n                  <DragRotateRight {...props} />\n                </a>\n              </Tooltip>\n            ),\n          },\n        ]}\n      />\n      <CloseButton onClick={onClose}>\n        <Tooltip content={viewerLocale.close}>\n          <a>\n            <CloseIcon />\n          </a>\n        </Tooltip>\n      </CloseButton>\n    </>\n  )\n}\n","import { Editable, Hotkey } from '@editablejs/editor'\nimport { Editor, Element, Range, Point, Transforms, Text, Path } from '@editablejs/models'\nimport { ImageEditor } from './image-editor'\n\nconst findMatchedRange = (editor: Editor, at: Point) => {\n  const [startText] = Editor.nodes<Text>(editor, {\n    at,\n    match: n => Text.isText(n),\n  })\n  if (!startText) return\n\n  const block = Editor.above(editor, {\n    at,\n    match: n => Element.isElement(n) && Editor.isBlock(editor, n),\n  })\n\n  const path = block ? block[1] : []\n\n  const start = Editor.start(editor, path)\n  const range = { anchor: at, focus: start }\n  const beforeText = Editor.string(editor, range)\n  const reg = /!\\[(.*)\\]\\((.*)\\)$/\n  let match = beforeText.match(reg)\n  if (match && match.length > 1) {\n    const title = match[1]\n    const url = match[2]\n    const matchedTexts = Editor.nodes<Text>(editor, {\n      at: range,\n      match: (n, p) => Text.isText(n) && (n === startText[0] || Path.isBefore(p, startText[1])),\n      reverse: true,\n    })\n    let content = ''\n    for (const [text, path] of matchedTexts) {\n      if (text === startText[0]) {\n        content = text.text.slice(0, at.offset)\n      } else {\n        content = text.text + content\n      }\n      match = content.match(reg)\n      if (match && match.length > 1) {\n        const offset = match.index ?? 0\n        return {\n          title,\n          url,\n          range: { anchor: { path, offset }, focus: at },\n        }\n      }\n    }\n  }\n}\nexport const withShortcuts = (editor: Editable) => {\n  const { onKeydown } = editor\n\n  editor.onKeydown = event => {\n    const { selection } = editor\n    if (\n      selection &&\n      Range.isCollapsed(selection) &&\n      !Editable.isComposing(editor) &&\n      Hotkey.match('space', event)\n    ) {\n      const anchor = Range.start(selection)\n      const match = findMatchedRange(editor, anchor)\n      if (match) {\n        event.preventDefault()\n        const { range, url } = match\n        Transforms.delete(editor, {\n          at: range,\n        })\n        Transforms.collapse(editor)\n        ImageEditor.insert(editor, {\n          file: url,\n        })\n        return\n      }\n    }\n    onKeydown(event)\n  }\n}\n"],"mappings":"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","names":["Editable","Hotkey","Editor","Transforms","Editable","Editor","Transforms","useMemo","Editor","Editor","image","Editor","Editor","path","useMemo","url","Editable","Editor","width","height","Transforms","rotate","locale","_styledstyled_components","Icon","React","useMemo","useMemo","useEditableStatic","useMemo","useEditableStatic","useMemo","useMemo","index","useMemo","useStore","useStore","useMemo","visible","useLocale","Tooltip","jsx","jsxs","useLocale","props","Tooltip","jsx","_styled","_styledstyled_components","React","useMemo","jsx","_styled","Icon","Editable","Editor","Transforms","Path","Editor","Path","path","Editable","Transforms","jsx","Editor","Transforms","Editable","Hotkey"]}
\ No newline at end of file
